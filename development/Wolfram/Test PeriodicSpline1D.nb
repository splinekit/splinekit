(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    444519,      10187]
NotebookOptionsPosition[    430399,      10023]
NotebookOutlinePosition[    430794,      10039]
CellTagsIndexPosition[    430751,      10036]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Definitions", "Title",
 CellChangeTimes->{{3.958728202759392*^9, 
  3.958728208823059*^9}},ExpressionUUID->"0d5e53ae-9eb9-4dae-8952-\
21f70f221fea"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Q", "::", "usage"}], 
   "=", "\"\<P\[Beta]Q [\\n  s_Association (* association to validate \
*)\\n]\\ngives True if s is an association that represents a valid periodic \
spline, and False otherwise. A valid periodic spline must contain the three \
keys {\\\"c\\\", \\\"n\\\", \\\"\[CapitalDelta]x\\\"}. Letting the array of \
spline coefficients be c = s[\\\"c\\\"] with integer period P \[Equal] \
Length[c], letting the spline degree be n = s[\\\"n\\\"], and letting the \
delay be \[CapitalDelta]x = s[\\\"\[CapitalDelta]x\\\"], it must hold that \
True \[Equal] VectorQ[c] \[And] 1 \[LessEqual] P \[And] IntegerQ[n] \[And] \
NonNegative[n] \[And] \[CapitalDelta]x \[Element] \\!\\(\\*TemplateBox[{},\\n\
\\\"Reals\\\"]\\). This periodic spline represents the function Sum[c[[Mod[k, \
P] + (1)]] \[Beta][# - \[CapitalDelta]x - k, n], {k, -\[Infinity], \
\[Infinity]}]&.\>\""}], ";"}]], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"3cd3675f-8605-46f5-a76e-9678158a2590"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]FromCoeff\[Beta]", "::", "usage"}], 
   "=", "\"\<\[Bullet] P\[Beta]FromCoeff\[Beta] [\\n  c_List /; (VectorQ[c] \
\[And] 1 \[LessEqual] Length[c]), (* spline coefficients *)\\n  n_Integer ? \
NonNegative, (* spline degree *)\\n  \[CapitalDelta]x_ : 0 (* delay \
*)\\n]\\ncreates the association \[LeftAssociation]\\\"c\\\" \[Rule] c, \\\"n\
\\\" \[Rule] n, \\\"\[CapitalDelta]x\\\" \[Rule] \[CapitalDelta]x\
\[RightAssociation] that represents a periodic spline with coefficients c, \
degree n, and delay \[CapitalDelta]x.\\n\\n\[Bullet] The delay must satisfy \
\[CapitalDelta]x \[Element] \\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\). Its \
default value is \[CapitalDelta]x \[Equal] 0.\\n\\n\[Bullet] The created \
periodic spline represents the function Sum[c[[Mod[k, P] + (1)]] \[Beta][# - \
\[CapitalDelta]x - k, n], {k, -\[Infinity], \[Infinity]}]&, with integer \
period P \[Equal] Length[c].\>\""}], ";"}]], "Input",
 CellLabel->"In[63]:=",ExpressionUUID->"08d3f14d-8f63-4afa-bcec-6bc8dee7130a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]FromSamples", "::", "usage"}], 
   "=", "\"\<\[Bullet] P\[Beta]FromSamples [\\n  f_List /; (VectorQ[f] \[And] \
1 \[LessEqual] Length[f]), (* samples *)\\n  n_Integer ? NonNegative, (* \
spline degree *)\\n  OptionsPattern[{Delay \[Rule] 0, Regularized \[Rule] \
False}] (* delay and regularization *)\\n]\\ncreates the association \
\[LeftAssociation]\\\"c\\\" \[Rule] c, \\\"n\\\" \[Rule] n, \\\"\
\[CapitalDelta]x\\\" \[Rule] Delay\[RightAssociation] that represents a \
periodic spline with coefficients c, degree n, and delay Delay. The created \
periodic spline represents the function Sum[c[[Mod[k, P] + (1)]] \[Beta][# - \
Delay - k, n], {k, -\[Infinity], \[Infinity]}]&, with integer period P \
\[Equal] Length[f].\\n\\n\[Bullet] The delay option must satisfy Delay \
\[Element] \\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\). Its default value is \
Delay \[Rule] 0.\\n\\n\[Bullet] The regularization option must satisfy \
Regularized \[Element] {False, True}. Its default value is Regularized \
\[Rule] False.\\n\\n\[Bullet] An odd P leads to stable interpolation. In this \
case, the created function always satisfies the property f[[Mod[k, P] + (1)]] \
\[Equal] fP\[Beta][P\[Beta]FromSamples[f, n, Delay], k], \[ForAll]k \
\[Element] \\!\\(\\*TemplateBox[{},\\n\\\"Integers\\\"]\\), and the \
Regularized option is ignored.\\n\\n\[Bullet] An integer Delay leads to \
stable interpolation. In this case, the created function satisfies the \
property f[[Mod[k, P] + (1)]] \[Equal] fP\[Beta][P\[Beta]FromSamples[f, n, \
Delay], k], \[ForAll]k \[Element] \
\\!\\(\\*TemplateBox[{},\\n\\\"Integers\\\"]\\), and the Regularized option \
is ignored.\\n\\n\[Bullet] If P is odd, or if it is even but Regularized \
\[Rule] False and Delay is not a half integer, then P\[Beta]FromSamples \
satisfies the property f[[Mod[k, P] + (1)]] \[Equal] \
fP\[Beta][P\[Beta]FromSamples[f, n, Delay], k], \[ForAll]k \[Element] \
\\!\\(\\*TemplateBox[{},\\n\\\"Integers\\\"]\\).\\n\\n\[Bullet] For EvenQ[P] \
\[And] \[Not](\[CapitalDelta]x \[Element] \
\\!\\(\\*TemplateBox[{},\\n\\\"Integers\\\"]\\)), let e = Downsample[f, 2, 0 \
+ (1)] and o = Downsample[f, 2, 1 + (1)]. Moreover, let g = Upsample[e - \
(Mean[e] - Mean[o]) / 2, 2, 0 + (1)] + Upsample[o - (Mean[o] - Mean[e]) / 2, \
2, 1 + (1)]. The effect of Regularized \[Rule] True is such that \
P\[Beta]FromSamples[f, n, Delay \[Rule] \[CapitalDelta]x, Regularized \[Rule] \
True] \[Equal] P\[Beta]FromSamples[g, n, Delay \[Rule] \[CapitalDelta]x]. The \
interpolation of g is always stable, also for \[CapitalDelta]x + 1 / 2 \
\[Element] \\!\\(\\*TemplateBox[{},\\n\\\"Integers\\\"]\\).\\n\\n\[Bullet] \
The spline is not well-defined when P is even, Delay is a half integer, and \
Regularized \[Rule] False.\>\""}], ";"}]], "Input",
 CellLabel->"In[64]:=",ExpressionUUID->"e285cb89-51b4-4e78-b914-5e4bc189375b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ShowP\[Beta]", "::", "usage"}], 
   "=", "\"\<ShowP\[Beta] [\\n  s_ /; P\[Beta]Q[s], (* periodic spline to \
display *)\\n  {min_ /; min \[Element] \\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\
\"]\\), max_ /; max \[Element] \\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\)}, \
(* domain *)\\n  opts : OptionsPattern[] (* plot options *)\\n]\\nshows a \
plot of the periodic spline.\\n\\n\[Bullet] The solid dots indicate the knots \
of the periodic spline.\\n\\n\[Bullet] The hollow dots indicate the samples \
of the periodic spline.\\n\\n\[Bullet] The distance between red samples \
corresponds to the length of one period.\\n\\n\[Bullet] ShowP\[Beta] has the \
same options as Plot.\>\""}], ";"}]], "Input",
 CellLabel->"In[65]:=",ExpressionUUID->"3a4f456f-2de4-49bb-a705-2259a58552ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fP\[Beta]", "::", "usage"}], 
   "=", "\"\<fP\[Beta] [\\n  s_ /; P\[Beta]Q[s], (* periodic spline to \
evaluate *)\\n  x_ (* argument *)\\n]\\nreturns the value of the periodic \
spline s evaluated at x. Letting the array of spline coefficients be c = s[\\\
\"c\\\"] with integer period P \[Equal] PeriodP\[Beta][s], letting the spline \
degree be n = DegreeP\[Beta][s], and letting the delay be \[CapitalDelta]x = \
DelayP\[Beta][s], the returned value is Sum[c[[Mod[k, P] + (1)]] \[Beta][x - \
\[CapitalDelta]x - k, n], {k, -\[Infinity], \[Infinity]}].\>\""}], 
  ";"}]], "Input",
 CellLabel->"In[66]:=",ExpressionUUID->"3f861ab9-8de5-4e8c-a9df-acaa807d6b1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SamplesFromP\[Beta]", "::", "usage"}], 
   "=", "\"\<\[Bullet] SamplesFromP\[Beta] [\\n  s_ /; P\[Beta]Q[s], (* \
periodic spline to evaluate *)\\n  K_Integer ? NonNegative, (* number of \
samples to take *)\\n  x_ (* argument of the first sample *)\\n]\\nreturns an \
array of K samples spaced by a unit step. The returned array corresponds to \
Array[fP\[Beta][s, #]&, K, x].\\n\\nSamplesFromP\[Beta] [\\n  s_ /; \
P\[Beta]Q[s], (* periodic spline to evaluate *)\\n  K_Integer ? NonNegative, \
(* number of blocks of samples to take *)\\n  M_Integer ? Positive, (* length \
of a block *)\\n  x_ (* argument of the first sample *)\\n]\\nreturns an \
array of (M K) samples spaced by the fractional step (1 / M). The returned \
array corresponds to Array[fP\[Beta][s, x + # / M]&, K M, 0].\>\""}], 
  ";"}]], "Input",
 CellLabel->"In[67]:=",ExpressionUUID->"9e177869-eac2-4c40-808f-2240bb34649b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PeriodP\[Beta]", "::", "usage"}], 
   "=", "\"\<PeriodP\[Beta] [\\n  s_ /; P\[Beta]Q[s] (* periodic spline \
*)\\n]\\nreturns the period Length[s[\\\"c\\\"]] of the periodic spline \
s.\>\""}], ";"}]], "Input",
 CellLabel->"In[68]:=",ExpressionUUID->"c78419c5-fc6f-480c-b04d-c4d2727bc30f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DegreeP\[Beta]", "::", "usage"}], 
   "=", "\"\<DegreeP\[Beta] [\\n  s_ /; P\[Beta]Q[s] (* periodic spline \
*)\\n]\\nreturns the degree s[\\\"n\\\"] of the periodic spline s.\>\""}], 
  ";"}]], "Input",
 CellLabel->"In[69]:=",ExpressionUUID->"57aac272-798b-4135-87c7-96c6c50784e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DelayP\[Beta]", "::", "usage"}], 
   "=", "\"\<DelayP\[Beta] [\\n  s_ /; P\[Beta]Q[s] (* periodic spline *)\\n]\
\\nreturns the delay s[\\\"\[CapitalDelta]x\\\"] of the periodic spline \
s.\>\""}], ";"}]], "Input",
 CellLabel->"In[70]:=",ExpressionUUID->"d67e6d8d-99e5-4992-889b-48bcb54984d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MeanP\[Beta]", "::", "usage"}], 
   "=", "\"\<MeanP\[Beta] [\\n  s_ /; P\[Beta]Q[s] (* periodic spline \
*)\\n]\\nreturns the average value of the continuously defined periodic \
spline, with MeanP\[Beta][s] \[Equal] Limit[Integrate[fP\[Beta][s, x], {x, a, \
b}] / (b - a), {a, b} \[Rule] {-\[Infinity], \[Infinity]}].\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9614701797866573`*^9, 3.961470182030548*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"dc729c5c-85bb-492a-ba75-9f8a4322c49c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VarianceP\[Beta]", "::", "usage"}], 
   "=", "\"\<VarianceP\[Beta] [\\n  s_ /; P\[Beta]Q[s] (* periodic spline \
*)\\n]\\nreturns the variance over one period of the continuously defined \
periodic spline, with VarianceP\[Beta][s] \[Equal] Integrate[(fP\[Beta][s, x] \
- MeanP\[Beta][s])^2, {x, 0, P}] / P, where P \[Equal] \
PeriodP\[Beta][s].\>\""}], ";"}]], "Input",
 CellLabel->"In[72]:=",ExpressionUUID->"5c8f7939-2c15-4061-8733-36f386b35034"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AreaUnderP\[Beta]", "::", "usage"}], 
   "=", "\"\<AreaUnderP\[Beta] [\\n  s_ /; P\[Beta]Q[s], (* periodic spline \
*)\\n  {a_, b_} (* integration limits *)\\n]\\nreturns Integrate[fP\[Beta][s, \
x], {x, a, b}] for a \[Element] \\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\) \
and b \[Element] \\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\).\>\""}], 
  ";"}]], "Input",
 CellLabel->"In[73]:=",ExpressionUUID->"46d23319-4e00-403d-b445-6c29348abf89"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SgnP\[Beta]", "::", "usage"}], 
   "=", "\"\<SgnP\[Beta] [\\n  s_ /; P\[Beta]Q[ss] (* periodic spline \
*)\\n]\\nreturns a list of pairs. The first element of each pair is either a \
number in [0, P) or a nonempty open interval (a, b) given by its bounds 0 \
\[LessEqual] a < b \[LessEqual] P, where P is the period of the spline. The \
collection of numbers and open intervals partitions the half-open interval \
[0, P). The second element of each pair gives the signum of the periodic \
spline at each point or over each interval.\>\""}], ";"}]], "Input",
 CellLabel->"In[74]:=",ExpressionUUID->"b2f9398c-c3a6-4206-90e7-a0262fc0b2e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ZeroesP\[Beta]", "::", "usage"}], 
   "=", "\"\<ZeroesP\[Beta] [\\n  s_ /; P\[Beta]Q[ss] (* periodic spline \
*)\\n]\\nreturns a mixed list of numbers in [0, P) and nonempty open \
intervals (a, b) given by their bounds 0 \[LessEqual] a < b \[LessEqual] P, \
where P is the period of the spline. The periodic spline vanishes over each \
item of the list.\>\""}], ";"}]], "Input",
 CellLabel->"In[75]:=",ExpressionUUID->"dd6f163b-4ee8-40d2-b490-806f92c88280"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ZeroCrossP\[Beta]", "::", "usage"}], 
   "=", "\"\<ZeroCrossP\[Beta] [\\n  s_ /; P\[Beta]Q[ss] (* periodic spline \
*)\\n  OptionsPattern[{Descending \[Rule] True, Ascending \[Rule] True}] (* \
transition directions *)\\n]\\nreturns a list of Interval objects that give \
the zero crossings over one period [x0, x0 + P] of a periodic spline of \
period P, for some x0 \[Element] [0, P).\\n\\n\[Bullet] A zero crossing of \
the P-periodic function \[Florin]: \
\\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\) \[Rule] \\!\\(\\*TemplateBox[{},\
\\n\\\"Reals\\\"]\\) is a closed interval [a, b], x0 \[LessEqual] a \
\[LessEqual] b \[LessEqual] x0 + P such that \[Exists]\[Delta] > 0: \
(\[Florin](a - \[Epsilon]) \[Florin](b + \[Epsilon])) < 0, \
\[ForAll]\[Epsilon] \[Element] (0, \[Delta]). When a \[NotEqual] b, it must \
also hold that 0 = \[Florin](x), \[ForAll]x \[Element] (a, b).\\n\\n\[Bullet] \
 A descending zero crossing is such that \[Florin](a - \[Epsilon]) > 0 > \
\[Florin](b + \[Epsilon]).\\n\\n\[Bullet]  An ascending zero crossing is such \
that \[Florin](a - \[Epsilon]) < 0 < \[Florin](b + \[Epsilon]).\>\""}], 
  ";"}]], "Input",
 CellLabel->"In[76]:=",ExpressionUUID->"77b9ad1e-fd02-4fd5-a811-0bce7da074ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtremaP\[Beta]", "::", "usage"}], 
   "=", "\"\<ExtremaP\[Beta] [\\n  s_ /; P\[Beta]Q[ss] (* periodic spline \
*)\\n  OptionsPattern[{Minima \[Rule] True, Maxima \[Rule] True}] (* type of \
extremum *)\\n]\\nreturns a list of pairs that give the extrema over one \
period [x0, x0 + P] of a periodic spline of degreen n and period P, for some \
x0 \[Element] [0, P).\\n\\n\[Bullet] When 0 \[Equal] n, the first member of \
each pair is a nonempty open interval (a, b) given by its bounds x0 \
\[LessEqual] a < b \[LessEqual] x0 + P. Letting \[Florin] = fP\[Beta][s, (a + \
b) / 2], it holds that fP\[Beta][s, x] \[Equal] \[Florin], \[ForAll]x \
\[Element] (a, b). Moreover, the maxima are such that fP\[Beta][s, a - 1 / 2] \
< \[Florin] > fP\[Beta][s, b + 1 / 2], while the minima are such such that fP\
\[Beta][s, a - 1 / 2] > \[Florin] < fP\[Beta][s, b + 1 / 2].\\n\\n\[Bullet] \
When 0 < n, the first member of each pair is an Interval object that \
represents the closed interval [a, b], x0 \[LessEqual] a \[LessEqual] b \
\[LessEqual] x0 + P. Letting \[Florin] = fP\[Beta][s, (a + b) / 2], it holds \
that fP\[Beta][s, x] \[Equal] \[Florin], \[ForAll]x \[Element] [a, b]. \
Moreover, the maxima are such that \[Exists]\[Delta] > 0: fP\[Beta][s, a - \
\[Epsilon]] < \[Florin] > fP\[Beta][s, b + \[Epsilon]], \[ForAll]\[Epsilon] \
\[Element] (0, \[Delta]), while the minima are such such that \[Exists]\
\[Delta] > 0: fP\[Beta][s, a - \[Epsilon]] > \[Florin] < fP\[Beta][s, b + \
\[Epsilon]], \[ForAll]\[Epsilon] \[Element] (0, \[Delta]).\\n\\n\[Bullet] The \
second member of each pair gives the extremum value \[Florin].\>\""}], 
  ";"}]], "Input",
 CellLabel->"In[77]:=",ExpressionUUID->"3229c2d5-9322-4040-a46d-0be2ade46d66"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FourierCoeffP\[Beta]", "::", "usage"}], 
   "=", "\"\<FourierCoeffP\[Beta] [\\n  s_ /; P\[Beta]Q[s], (* periodic \
spline *)\\n  \[Nu]_Integer (* coefficient index *)\\n]\\nreturns the \[Nu]th \
Fourier coefficient of the periodic spline s. These coefficients satisfy fP\
\[Beta][s, x] \[Equal] Sum[FourierCoeffP\[Beta][s, \[Nu]] Exp[\[ImaginaryJ] \
\[Nu] (2 \[Pi] / P) x], {\[Nu], -\[Infinity], \[Infinity]}] for x \[Element] \
\\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\), where P \[Equal] \
PeriodP\[Beta][s].\>\""}], ";"}]], "Input",
 CellLabel->"In[78]:=",ExpressionUUID->"81dc43e9-2540-4cdd-97e3-8e64a267df72"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]UpperBoundP\[Beta]", "::", "usage"}], 
   "=", "\"\<P\[Beta]UpperBoundP\[Beta] [\\n  s_ /; P\[Beta]Q[ss], (* \
periodic spline *)\\n  n_Integer ? NonNegative (* degree of the \
upper-bounding spline *)\\n]\\nreturns a periodic spline of degree n that \
provides an upper bound to s.\>\""}], ";"}]], "Input",
 CellLabel->"In[79]:=",ExpressionUUID->"5b6d2905-8d1e-4d51-b5b0-0421542d1ab7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]LowerBoundP\[Beta]", "::", "usage"}], 
   "=", "\"\<P\[Beta]LowerBoundP\[Beta] [\\n  s_ /; P\[Beta]Q[ss], (* \
periodic spline *)\\n  n_Integer ? NonNegative (* degree of the \
lower-bounding spline *)\\n]\\nreturns a periodic spline of degree n that \
provides an lower bound to s.\>\""}], ";"}]], "Input",
 CellLabel->"In[80]:=",ExpressionUUID->"7d689e10-2289-4f5b-b821-9b9cdf5ea62f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]WithFractionalDelay", "::", "usage"}], 
   "=", "\"\<P\[Beta]WithFractionalDelay [\\n  s_ /; P\[Beta]Q[s] (* periodic \
spline *)\\n]\\nreturns a periodic spline such that 0 \[LessEqual] DelayP\
\[Beta][P\[Beta]WithFractionalDelay[s]] < 1, along with \
fP\[Beta][P\[Beta]WithFractionalDelay[s], x] \[Equal] fP\[Beta][s, x] for x \
\[Element] \\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\).\>\""}], 
  ";"}]], "Input",
 CellLabel->"In[81]:=",ExpressionUUID->"fdedd518-21fc-4107-87f8-7da658cecb75"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Delayed", "::", "usage"}], 
   "=", "\"\<P\[Beta]Delayed [\\n  s_ /; P\[Beta]Q[s], (* periodic spline \
*)\\n  \[Tau]_ (* delay *)\\n]\\nreturns a delayed periodic spline such that \
fP\[Beta][P\[Beta]Delayed[s, \[Tau]], x] \[Equal] fP\[Beta][s, x - \[Tau]] \
for x \[Element] \\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\).\>\""}], 
  ";"}]], "Input",
 CellLabel->"In[82]:=",ExpressionUUID->"f7a427cb-dcc8-48ff-92e7-381c3c9cbdec"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Reversed", "::", "usage"}], 
   "=", "\"\<P\[Beta]Reversed [\\n  s_ /; P\[Beta]Q[s], (* periodic spline *)\
\\n]\\nreturns a periodic spline reversed around the origin, such that fP\
\[Beta][P\[Beta]Reversed[s], x] \[Equal] fP\[Beta][s, -x] for x \[Element] \
\\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\).\>\""}], ";"}]], "Input",
 CellLabel->"In[83]:=",ExpressionUUID->"9a710d0d-d47e-4002-b3e3-704a9697bc47"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]PlusScalar", "::", "usage"}], 
   "=", "\"\<P\[Beta]PlusScalar [\\n  s_ /; P\[Beta]Q[s], (* periodic spline \
*)\\n  c0_ (* additive constant *)\\n]\\nreturns a periodic spline with an \
added constant, such that fP\[Beta][P\[Beta]PlusScalar[s, c0], x] \[Equal] c0 \
+ fP\[Beta][s, x] for x \[Element] \
\\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\).\>\""}], ";"}]], "Input",
 CellLabel->"In[84]:=",ExpressionUUID->"014ec614-9005-4850-81b1-4b34e24ea628"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Negated", "::", "usage"}], 
   "=", "\"\<P\[Beta]Negated [\\n  s_ /; P\[Beta]Q[s] (* periodic spline \
*)\\n]\\nreturns a periodic spline such that fP\[Beta][P\[Beta]Negated[s], x] \
\[Equal] -fP\[Beta][s, x] for x \[Element] \
\\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\).\>\""}], ";"}]], "Input",
 CellLabel->"In[85]:=",ExpressionUUID->"0b2c88ad-a716-48e1-8876-99fc03e4233b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]TimesScalar", "::", "usage"}], 
   "=", "\"\<P\[Beta]TimesScalar [\\n  s_ /; P\[Beta]Q[s], (* periodic spline \
*)\\n  \[Lambda]_ (* multiplicative constant *)\\n]\\nreturns a periodic \
spline multiplied by a constant, such that fP\[Beta][P\[Beta]TimesScalar[s, \
\[Lambda]], x] \[Equal] \[Lambda] fP\[Beta][s, x] for x \[Element] \
\\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\).\>\""}], ";"}]], "Input",
 CellLabel->"In[86]:=",ExpressionUUID->"5c698e86-f2e8-49ad-8d60-968b63577e2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Grad", "::", "usage"}], 
   "=", "\"\<P\[Beta]Grad [\\n  s_ /; (P\[Beta]Q[s] \[And] 1 \[LessEqual] \
DegreeP\[Beta][s]) (* periodic spline of degree at least 1 *)\\n]\\nreturns a \
differentiated periodic spline such that fP\[Beta][P\[Beta]Grad[s], x] \
\[Equal] fP\[Beta][P\[Beta]Diff[s, 1], x] for x \[Element] \
\\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\).\>\""}], ";"}]], "Input",
 CellLabel->"In[87]:=",ExpressionUUID->"4b82d0a8-2848-4b75-9b4a-49ce0c6e8b97"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]AntiGrad", "::", "usage"}], 
   "=", "\"\<P\[Beta]AntiGrad [\\n  s_ /; P\[Beta]Q[s] (* periodic spline \
*)\\n]\\nreturns a periodic spline such that fP\[Beta][s, x] - \
MeanP\[Beta][s] \[Equal] Derivative[1][fP\[Beta][P\[Beta]AntiGrad[s], #]&][x] \
for x \[Element] \\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\).\>\""}], 
  ";"}]], "Input",
 CellLabel->"In[88]:=",ExpressionUUID->"88392b61-24ec-411a-9fa7-445a032866a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Diff", "::", "usage"}], 
   "=", "\"\<P\[Beta]Diff [\\n  s_ /; P\[Beta]Q[s], (* periodic spline *)\\n  \
m_Integer ? NonNegative (* differentiation order *)\\n]\\nreturns a \
differentiated periodic spline such that fP\[Beta][P\[Beta]Diff[s, m], x] \
\[Equal] Derivative[m][fP\[Beta][s, #]&][x] for x \[Element] \
\\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\). The order m of differentiation \
must not exceed the degree of the periodic spline.\>\""}], ";"}]], "Input",
 CellLabel->"In[89]:=",ExpressionUUID->"5ad8969d-cb8d-49ac-88c4-1afd4b9cb088"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Projected", "::", "usage"}], 
   "=", "\"\<P\[Beta]Projected [\\n  s_ /; P\[Beta]Q[s], (* periodic spline \
*)\\n  {n_Integer ? NonNegative, \[CapitalDelta]x_} (* degree and delay of \
the projected spline *)\\n]\\nreturns a periodic spline of degree n, delay \
\[CapitalDelta]x, and same period as s, that best approximates s in a \
least-squares sense over one period.\\n\\n\[Bullet] The error of projection \
is perpendicular to the projected spline p = P\[Beta]Projected[s, {n, \
\[CapitalDelta]x}], so that 0 \[Equal] Integrate[(fP\[Beta][p, x] - \
fP\[Beta][s, x]) fP\[Beta][p, x], {x, -\[Infinity], \[Infinity]}].\>\""}], 
  ";"}]], "Input",
 CellLabel->"In[90]:=",ExpressionUUID->"7b6e9c6c-db7b-4968-a7a8-b72420fc80cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Upscaled", "::", "usage"}], 
   "=", "\"\<P\[Beta]Upscaled [\\n  s_ /; P\[Beta]Q[s], (* periodic spline *)\
\\n  M_Integer ? Positive (* magnification factor *)\\n]\\nreturns a periodic \
spline of period PeriodP\[Beta][P\[Beta]Upscaled[s, M]] \[Equal] M PeriodP\
\[Beta][s] such that fP\[Beta][P\[Beta]Upscaled[s, M], M x] \[Equal] \
fP\[Beta][s, x] for x \[Element] \
\\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\).\>\""}], ";"}]], "Input",
 CellLabel->"In[91]:=",ExpressionUUID->"064d1096-161e-416b-bc56-099108627489"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]UpscaledProjected", "::", "usage"}], 
   "=", "\"\<P\[Beta]UpscaledProjected [\\n  s_ /; P\[Beta]Q[s], (* periodic \
spline *)\\n  M_Integer ? Positive (* magnification factor *)\\n  {n_Integer \
? NonNegative, \[CapitalDelta]x_} (* degree and delay of the projected spline \
*)\\n]\\nreturns a periodic spline p = P\[Beta]UpscaledProjected[s, M, {n, \
\[CapitalDelta]x}] of degree n, delay \[CapitalDelta]x, and period PeriodP\
\[Beta][p] \[Equal] M PeriodP\[Beta][s].\\n\\n\[Bullet] The error of \
projection is perpendicular to p, so that 0 \[Equal] Integrate[(fP\[Beta][p, \
x] - fP\[Beta][s, x / M]) fP\[Beta][p, x], {x, -\[Infinity], \[Infinity]}].\>\
\""}], ";"}]], "Input",
 CellLabel->"In[92]:=",ExpressionUUID->"c405e2aa-b4dc-4349-a5c1-dbb54ed91e3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]DownscaledProjected", "::", "usage"}], 
   "=", "\"\<P\[Beta]DownscaledProjected [\\n  s_ /; P\[Beta]Q[s], (* \
periodic spline *)\\n  M_Integer ? Positive (* minification factor *)\\n  \
{n_Integer ? NonNegative, \[CapitalDelta]x_} (* degree and delay of the \
projected spline *)\\n]\\nreturns a periodic spline p = \
P\[Beta]DownscaledProjected[s, M, {n, \[CapitalDelta]x}] of degree n, delay \
\[CapitalDelta]x, and period PeriodP\[Beta][p] \[Equal] M PeriodP\[Beta][s] / \
GCD[M, PeriodP\[Beta][s]].\\n\\n\[Bullet] The error of projection is \
perpendicular to p, so that 0 \[Equal] Integrate[(fP\[Beta][p, x] - \
fP\[Beta][s, M x]) fP\[Beta][p, x], {x, -\[Infinity], \[Infinity]}].\>\""}], 
  ";"}]], "Input",
 CellLabel->"In[93]:=",ExpressionUUID->"b55f3d49-9483-4e7a-b341-d9e1c82257d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]RescaledProjected", "::", "usage"}], 
   "=", "\"\<P\[Beta]RescaledProjected [\\n  s_ /; P\[Beta]Q[s], (* periodic \
spline *)\\n  P_Integer ? Positive (* period of the projected spline *)\\n  \
{n_Integer ? NonNegative, \[CapitalDelta]x_} (* degree and delay of the \
projected spline *)\\n]\\nreturns a periodic spline p = \
P\[Beta]RescaledProjected[s, P, {n, \[CapitalDelta]x}] of degree n, delay \
\[CapitalDelta]x, and period PeriodP\[Beta][p] \[Equal] P.\\n\\n\[Bullet] The \
error of projection is perpendicular to p, so that 0 \[Equal] Integrate[(fP\
\[Beta][p, x] - fP\[Beta][s, x PeriodP\[Beta][s] / P]) fP\[Beta][p, x], {x, -\
\[Infinity], \[Infinity]}].\>\""}], ";"}]], "Input",
 CellLabel->"In[94]:=",ExpressionUUID->"7952cc2c-d9cf-4ef3-b4ce-96822e123cbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]PlusP\[Beta]", "::", "usage"}], 
   "=", "\"\<P\[Beta]PlusP\[Beta] [\\n  s1_ /; P\[Beta]Q[s1], (* augend *)\\n \
 s2_ /; P\[Beta]Q[s2] (* addend *)\\n]\\nreturns a periodic spline of same \
degree, delay, and period as s1 and s2, that is equal to (s1 + s2).\\n\\n\
\[Bullet] The period of s1 must match the period of s2, so that \
PeriodP\[Beta][s1] \[Equal] PeriodP\[Beta][s2].\\n\\n\[Bullet] The degree of \
s1 must match the degree of s2, so that DegreeP\[Beta][s1] \[Equal] DegreeP\
\[Beta][s2].\\n\\n\[Bullet] The delay of s1 must match the delay of s2, so \
that DelayP\[Beta][s1] \[Equal] DelayP\[Beta][s2].\>\""}], ";"}]], "Input",
 CellLabel->"In[95]:=",ExpressionUUID->"f56b507e-1bc0-4afb-851d-ae88ac1332cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]PlusP\[Beta]Projected", "::", "usage"}], 
   "=", "\"\<P\[Beta]PlusP\[Beta]Projected [\\n  s1_ /; P\[Beta]Q[s1], (* \
augend *)\\n  s2_ /; P\[Beta]Q[s2], (* addend *)\\n  {n_Integer ? \
NonNegative, \[CapitalDelta]x_} (* degree and delay of the projected spline \
*)\\n]\\nreturns a periodic spline of degree n, delay \[CapitalDelta]x, and \
same period as s1 and s2, that best approximates (s1 + s2) in a least-squares \
sense over one period.\\n\\n\[Bullet] The period of s1 must match the period \
of s2, so that PeriodP\[Beta][s1] \[Equal] PeriodP\[Beta][s2].\\n\\n\[Bullet] \
The error of projection is perpendicular to the projected spline p = \
P\[Beta]PlusP\[Beta]Projected[s1, s2, {n, \[CapitalDelta]x}], so that 0 \
\[Equal] Integrate[(fP\[Beta][p, x] - (fP\[Beta][s1, x] + fP\[Beta][s2, x])) \
fP\[Beta][p, x], {x, -\[Infinity], \[Infinity]}].\>\""}], ";"}]], "Input",
 CellLabel->"In[96]:=",ExpressionUUID->"905185b9-0f15-4909-b1c8-d506a597e691"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]ConvolveP\[Beta]", "::", "usage"}], 
   "=", "\"\<P\[Beta]ConvolveP\[Beta] [\\n  s1_ /; P\[Beta]Q[s1], (* spline 1 \
*)\\n  s2_ /; P\[Beta]Q[s2] (* spline 2 *)\\n]\\nreturns a periodic spline of \
degree DegreeP\[Beta][s1] + DegreeP\[Beta][s2] + 1, delay DelayP\[Beta][s1] + \
DelayP\[Beta][s2], and same period as s1 and s2. It is set to the \
continuously defined convolution of s1 and s2 over one period. For x \
\[Element] \\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\), it is given by \
Integrate[fP\[Beta][s1, y] fP\[Beta][s2, x - y], {y, 0, PeriodP\[Beta][s1]}].\
\\n\\n\[Bullet] The period of s1 must match the period of s2, so that PeriodP\
\[Beta][s1] \[Equal] PeriodP\[Beta][s2].\>\""}], ";"}]], "Input",
 CellLabel->"In[97]:=",ExpressionUUID->"cd63cf11-4fca-4c13-bece-114ea95e747e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]NormedCrossCorrP\[Beta]", "::", "usage"}], 
   "=", "\"\<P\[Beta]NormedCrossCorrP\[Beta] [\\n  s1_ /; P\[Beta]Q[s1], (* \
spline 1 *)\\n  s2_ /; P\[Beta]Q[s2] (* spline 2 *)\\n]\\nreturns a periodic \
spline of degree DegreeP\[Beta][s1] + DegreeP\[Beta][s2] + 1, delay (DelayP\
\[Beta][s2] - DelayP\[Beta][s1]), and same period as s1 and s2. It is set to \
the continuously defined zero-normalized crosscorrelation of s1 and s2 over \
one period. For x \[Element] \\!\\(\\*TemplateBox[{},\\n\\\"Reals\\\"]\\), it \
is given by Integrate[(fP\[Beta][s1, y] - MeanP\[Beta][s1]) fP\[Beta][s2, x + \
y] / (P Sqrt[VarianceP\[Beta][s1] VarianceP\[Beta][s2]]), {y, 0, P}], with P \
\[Equal] PeriodP\[Beta][s1].\\n\\n\[Bullet] The period of s1 must match the \
period of s2, so that PeriodP\[Beta][s1] \[Equal] PeriodP\[Beta][s2].\\n\\n\
\[Bullet] It is well-defined unless VarianceP\[Beta][s1] or \
VarianceP\[Beta][s2] vanishes.\>\""}], ";"}]], "Input",
 CellLabel->"In[98]:=",ExpressionUUID->"f66a45ea-f986-40fc-af9a-4d0739f5515e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Stigma]\[Beta]", "[", 
    RowBox[{"x_", ",", "n_Integer"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"n", "<", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "-", "n"}], "]"}], "[", "DiracDelta", "]"}], "[",
       "x", "]"}], ",", 
     RowBox[{"0", "==", "n"}], ",", 
     RowBox[{
      RowBox[{"Sign", "[", "x", "]"}], "/", "2"}], ",", "True", ",", 
     RowBox[{
      RowBox[{"Sign", "[", "x", "]"}], 
      RowBox[{
       RowBox[{"x", "^", "n"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{"n", "!"}]}], ")"}]}]}]}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{
  3.9587281807737303`*^9, {3.958731040076202*^9, 3.958731056849021*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"6a11ef37-e31a-4d8e-98db-4733bd807429"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d\[Beta]", "[", 
    RowBox[{"x_", ",", "n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "<", 
      RowBox[{"Abs", "[", "x", "]"}]}], ",", "0", ",", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", "k"}], " ", 
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ",", "k"}], "]"}], 
        RowBox[{"\[Stigma]\[Beta]", "[", 
         RowBox[{
          RowBox[{"x", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "-", "k"}], ",", 
          RowBox[{"n", "-", "m"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", 
         RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";"}]], "Input",\

 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{
  3.958728180773768*^9, {3.958731040076236*^9, 3.958731056849161*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"12cedf5e-8375-4f09-850b-15828dd60eb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Z\[Beta]", "[", 
    RowBox[{"n_Integer", "?", "NonNegative"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Z\[Beta]", "[", "n", "]"}], "=", 
    RowBox[{"N", "[", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"0", "==", "n"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"1", "==", "n"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"2", "==", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], "+", 
         RowBox[{"2", 
          RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", 
       RowBox[{"3", "==", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"Sqrt", "[", "3", "]"}]}], "}"}], ",", 
       RowBox[{"4", "==", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "19"}], "+", 
          RowBox[{"Sqrt", "[", "304", "]"}], "+", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"664", "-", 
            RowBox[{"Sqrt", "[", "438976", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "19"}], "-", 
          RowBox[{"Sqrt", "[", "304", "]"}], "+", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"664", "+", 
            RowBox[{"Sqrt", "[", "438976", "]"}]}], "]"}]}]}], "}"}], ",", 
       RowBox[{"5", "==", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "13"}], "/", "2"}], "+", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"105", "/", "4"}], "]"}], "+", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"135", "/", "2"}], "-", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"17745", "/", "4"}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "13"}], "/", "2"}], "-", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"105", "/", "4"}], "]"}], "+", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"135", "/", "2"}], "+", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"17745", "/", "4"}], "]"}]}], "]"}]}]}], "}"}], ",", 
       RowBox[{"6", "==", "n"}], ",", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Theta]", "=", 
            RowBox[{
             RowBox[{"ArcCos", "[", 
              RowBox[{
               RowBox[{"-", "668791"}], "/", 
               RowBox[{"Sqrt", "[", "447872715451", "]"}]}], "]"}], "/", 
             "3"}]}], ",", "c", ",", "s", ",", "\[Lambda]1", ",", 
           "\[Lambda]2", ",", "\[Lambda]3"}], "}"}], ",", 
         RowBox[{
          RowBox[{"c", "=", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{"122416", "/", "9"}], "]"}], 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ";", 
          RowBox[{"s", "=", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{"122416", "/", "3"}], "]"}], 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ";", 
          RowBox[{"\[Lambda]1", "=", 
           RowBox[{
            RowBox[{"361", "/", "3"}], "-", 
            RowBox[{"2", "c"}]}]}], ";", 
          RowBox[{"\[Lambda]2", "=", 
           RowBox[{
            RowBox[{"361", "/", "3"}], "+", "c", "-", "s"}]}], ";", 
          RowBox[{"\[Lambda]3", "=", 
           RowBox[{
            RowBox[{"361", "/", "3"}], "+", "c", "+", "s"}]}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"\[Lambda]1", "^", "2"}], "-", "1"}], "]"}], "-", 
             "\[Lambda]1"}], ",", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"\[Lambda]2", "^", "2"}], "-", "1"}], "]"}], "-", 
             "\[Lambda]2"}], ",", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"\[Lambda]3", "^", "2"}], "-", "1"}], "]"}], "-", 
             "\[Lambda]3"}]}], "}"}]}]}], "]"}], ",", 
       RowBox[{"7", "==", "n"}], ",", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Theta]", "=", 
            RowBox[{
             RowBox[{"ArcCos", "[", 
              RowBox[{
               RowBox[{"-", "738"}], "/", 
               RowBox[{"Sqrt", "[", "556549", "]"}]}], "]"}], "/", "3"}]}], ",",
            "c", ",", "s", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
           "\[Lambda]3"}], "}"}], ",", 
         RowBox[{
          RowBox[{"c", "=", 
           RowBox[{
            RowBox[{"Sqrt", "[", "301", "]"}], 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ";", 
          RowBox[{"s", "=", 
           RowBox[{
            RowBox[{"Sqrt", "[", "903", "]"}], 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ";", 
          RowBox[{"\[Lambda]1", "=", 
           RowBox[{"20", "-", 
            RowBox[{"2", "c"}]}]}], ";", 
          RowBox[{"\[Lambda]2", "=", 
           RowBox[{"20", "+", "c", "-", "s"}]}], ";", 
          RowBox[{"\[Lambda]3", "=", 
           RowBox[{"20", "+", "c", "+", "s"}]}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"\[Lambda]1", "^", "2"}], "-", "1"}], "]"}], "-", 
             "\[Lambda]1"}], ",", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"\[Lambda]2", "^", "2"}], "-", "1"}], "]"}], "-", 
             "\[Lambda]2"}], ",", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"\[Lambda]3", "^", "2"}], "-", "1"}], "]"}], "-", 
             "\[Lambda]3"}]}], "}"}]}]}], "]"}], ",", 
       RowBox[{"8", "==", "n"}], ",", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Theta]", "=", 
            RowBox[{
             RowBox[{"ArcCos", "[", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"3191438329707", "/", "3435302785852"}], "]"}], "]"}], 
             "/", "3"}]}], ",", "\[Lambda]0", ",", "\[Lambda]", ",", "\[Rho]",
            ",", "\[Nu]1", ",", "\[Nu]2", ",", "\[Mu]1", ",", "\[Mu]2", ",", 
           "\[Mu]3", ",", "\[Mu]4"}], "}"}], ",", 
         RowBox[{
          RowBox[{"\[Lambda]0", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"656944", "+", 
             RowBox[{
              RowBox[{"Sqrt", "[", "106853376", "]"}], 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "]"}]}], ";", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{
            RowBox[{"1300071", "/", "2"}], "-", 
            RowBox[{"\[Lambda]0", "^", "2"}]}]}], ";", 
          RowBox[{"\[Rho]", "=", 
           RowBox[{
            RowBox[{"1638", "\[Lambda]0"}], "-", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"4", 
               RowBox[{"\[Lambda]", "^", "2"}]}], "-", "250737"}], "]"}]}]}], 
          ";", 
          RowBox[{"\[Nu]1", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"2641593", "/", "2"}], "+", "\[Lambda]", "-", "\[Rho]"}],
             "]"}]}], ";", 
          RowBox[{"\[Nu]2", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"2641593", "/", "2"}], "+", "\[Lambda]", "+", "\[Rho]"}],
             "]"}]}], ";", 
          RowBox[{"\[Mu]1", "=", 
           RowBox[{
            RowBox[{"-", "819"}], "+", "\[Lambda]0", "+", "\[Nu]1"}]}], ";", 
          RowBox[{"\[Mu]2", "=", 
           RowBox[{
            RowBox[{"-", "819"}], "+", "\[Lambda]0", "-", "\[Nu]1"}]}], ";", 
          RowBox[{"\[Mu]3", "=", 
           RowBox[{
            RowBox[{"-", "819"}], "-", "\[Lambda]0", "+", "\[Nu]2"}]}], ";", 
          RowBox[{"\[Mu]4", "=", 
           RowBox[{
            RowBox[{"-", "819"}], "-", "\[Lambda]0", "-", "\[Nu]2"}]}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Mu]1", "+", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"\[Mu]1", "^", "2"}], "-", "1"}], "]"}]}], ",", 
            RowBox[{"\[Mu]2", "+", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"\[Mu]2", "^", "2"}], "-", "1"}], "]"}]}], ",", 
            RowBox[{"\[Mu]3", "+", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"\[Mu]3", "^", "2"}], "-", "1"}], "]"}]}], ",", 
            RowBox[{"\[Mu]4", "+", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"\[Mu]4", "^", "2"}], "-", "1"}], "]"}]}]}], "}"}]}]}],
         "]"}], ",", 
       RowBox[{"9", "==", "n"}], ",", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Theta]", "=", 
            RowBox[{
             RowBox[{"ArcCos", "[", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"607973645", "/", "699281408"}], "]"}], "]"}], "/", 
             "3"}]}], ",", "\[Lambda]0", ",", "\[Lambda]", ",", "\[Rho]", ",",
            "\[Nu]1", ",", "\[Nu]2", ",", "\[Mu]1", ",", "\[Mu]2", ",", 
           "\[Mu]3", ",", "\[Mu]4"}], "}"}], ",", 
         RowBox[{
          RowBox[{"\[Lambda]0", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"53265", "/", "16"}], "+", 
             RowBox[{
              RowBox[{"Sqrt", "[", "146160", "]"}], 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "]"}]}], ";", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{
            RowBox[{"48397", "/", "16"}], "-", 
            RowBox[{"\[Lambda]0", "^", "2"}]}]}], ";", 
          RowBox[{"\[Rho]", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"251", "/", "2"}], ")"}], "\[Lambda]0"}], "-", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"4", 
               RowBox[{"\[Lambda]", "^", "2"}]}], "-", "7936"}], "]"}]}]}], ";", 
          RowBox[{"\[Nu]1", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"55699", "/", "8"}], "+", "\[Lambda]", "-", "\[Rho]"}], 
            "]"}]}], ";", 
          RowBox[{"\[Nu]2", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"55699", "/", "8"}], "+", "\[Lambda]", "+", "\[Rho]"}], 
            "]"}]}], ";", 
          RowBox[{"\[Mu]1", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "251"}], "/", "4"}], "+", "\[Lambda]0", "+", 
            "\[Nu]1"}]}], ";", 
          RowBox[{"\[Mu]2", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "251"}], "/", "4"}], "+", "\[Lambda]0", "-", 
            "\[Nu]1"}]}], ";", 
          RowBox[{"\[Mu]3", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "251"}], "/", "4"}], "-", "\[Lambda]0", "+", 
            "\[Nu]2"}]}], ";", 
          RowBox[{"\[Mu]4", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "251"}], "/", "4"}], "-", "\[Lambda]0", "-", 
            "\[Nu]2"}]}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Mu]1", "+", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"\[Mu]1", "^", "2"}], "-", "1"}], "]"}]}], ",", 
            RowBox[{"\[Mu]2", "+", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"\[Mu]2", "^", "2"}], "-", "1"}], "]"}]}], ",", 
            RowBox[{"\[Mu]3", "+", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"\[Mu]3", "^", "2"}], "-", "1"}], "]"}]}], ",", 
            RowBox[{"\[Mu]4", "+", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"\[Mu]4", "^", "2"}], "-", "1"}], "]"}]}]}], "}"}]}]}],
         "]"}], ",", "True", ",", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "z", "}"}], ",", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"2", "/", 
               RowBox[{"(", 
                RowBox[{"#", "-", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"#", "^", "2"}], "-", "4"}], "]"}]}], ")"}]}], 
              "&"}], ",", 
             RowBox[{"SolveValues", "[", 
              RowBox[{
               RowBox[{"0", "==", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d\[Beta]", "[", 
                    RowBox[{"0", ",", "n", ",", "0"}], "]"}], "+", 
                   RowBox[{"2", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"d\[Beta]", "[", 
                    RowBox[{
                    RowBox[{"2", "q"}], ",", "n", ",", "0"}], "]"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "q"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "1", ",", 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], "/", "2"}], "]"}]}], 
                    "}"}]}], "]"}]}]}], ")"}], "+", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "p"}], " ", 
                    RowBox[{"z", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "p"}], "+", "1"}], ")"}]}], 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "q"}], " ", 
                    RowBox[{"d\[Beta]", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", "q"}], "+", "1"}], ",", "n", ",", "0"}], 
                    "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "q"}], "+", "1"}], ")"}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q", "+", "p"}], ")"}], "!"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q", "-", "p"}], ")"}], "!"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "p", ",", 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], "-", "1"}], ")"}], "/", 
                    "2"}], "]"}]}], "}"}]}], "]"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "p"}], "+", "1"}], ")"}], "!"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"p", ",", "0", ",", 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], "/", "2"}], "]"}]}], 
                    "}"}]}], "]"}], "+", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "p"}], " ", 
                    RowBox[{"z", "^", 
                    RowBox[{"(", 
                    RowBox[{"2", "p"}], ")"}]}], 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "q"}], " ", 
                    RowBox[{"d\[Beta]", "[", 
                    RowBox[{
                    RowBox[{"2", "q"}], ",", "n", ",", "0"}], "]"}], "2", "q",
                     " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q", "+", "p"}], ")"}], "!"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q", "+", "p"}], ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q", "-", "p"}], ")"}], "!"}]}], ")"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "p", ",", 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], "/", "2"}], "]"}]}], 
                    "}"}]}], "]"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "p"}], ")"}], "!"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"p", ",", "1", ",", 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], "/", "2"}], "]"}]}], 
                    "}"}]}], "]"}]}]}], ",", "z"}], "]"}]}], "]"}], ",", 
           "Less"}], "]"}]}], "]"}]}], "]"}], "]"}]}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{
  3.9587281807738047`*^9, {3.958731040076419*^9, 3.9587310568497877`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"5ce0c78f-9c98-435e-b7db-83b0615fa099"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PeriodicSamplesToCoeff\[Beta]", "[", 
    RowBox[{
     RowBox[{"f_List", "/;", 
      RowBox[{"VectorQ", "[", "f", "]"}]}], ",", 
     RowBox[{"n_Integer", "?", "NonNegative"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", "=", 
        RowBox[{"Z\[Beta]", "[", "n", "]"}]}], ",", 
       RowBox[{"P", "=", 
        RowBox[{"Length", "[", "f", "]"}]}], ",", 
       RowBox[{"c", "=", "f"}], ",", "q", ",", "z", ",", "z12", ",", 
       "\[Sigma]", ",", "\[Zeta]", ",", "k"}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", "}"}], "==", "p"}], "\[Or]", 
         RowBox[{"0", "==", "P"}], "\[Or]", 
         RowBox[{"1", "==", "P"}]}], ",", 
        RowBox[{"Return", "[", "f", "]"}]}], "]"}], ";", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"q", "=", "0"}], ",", 
        RowBox[{"q", "<", 
         RowBox[{"Length", "[", "p", "]"}]}], ",", 
        RowBox[{"q", "++"}], ",", 
        RowBox[{
         RowBox[{"z", "=", 
          RowBox[{"p", "[", 
           RowBox[{"[", 
            RowBox[{"q", "+", 
             RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ";", 
         RowBox[{"\[Sigma]", "=", 
          RowBox[{"c", "[", 
           RowBox[{"[", 
            RowBox[{"0", "+", 
             RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ";", 
         RowBox[{"\[Zeta]", "=", "z"}], ";", 
         RowBox[{"Quiet", "[", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{
             RowBox[{"k", "<", "P"}], "\[And]", 
             RowBox[{"0", "!=", "\[Zeta]"}]}], ",", 
            RowBox[{"k", "++"}], ",", 
            RowBox[{
             RowBox[{"\[Sigma]", "+=", 
              RowBox[{"\[Zeta]", " ", 
               RowBox[{"c", "[", 
                RowBox[{"[", 
                 RowBox[{"P", "-", "k", "+", 
                  RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}]}], ";", 
             RowBox[{"\[Zeta]", "*=", "z"}]}]}], "]"}], "]"}], ";", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"[", 
            RowBox[{"0", "+", 
             RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "=", 
          RowBox[{"\[Sigma]", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Zeta]"}], ")"}]}]}], ";", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "<", "P"}], ",", 
           RowBox[{"k", "++"}], ",", 
           RowBox[{
            RowBox[{"c", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", 
               RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "+=", 
            RowBox[{"z", " ", 
             RowBox[{"c", "[", 
              RowBox[{"[", 
               RowBox[{"k", "-", "1", "+", 
                RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}]}]}], "]"}], ";", 
         RowBox[{"\[Sigma]", "=", 
          RowBox[{"c", "[", 
           RowBox[{"[", 
            RowBox[{"P", "-", "1", "+", 
             RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ";", 
         RowBox[{"\[Zeta]", "=", "z"}], ";", 
         RowBox[{"Quiet", "[", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "0"}], ",", 
            RowBox[{
             RowBox[{"k", "<", 
              RowBox[{"P", "-", "1"}]}], "\[And]", 
             RowBox[{"0", "!=", "\[Zeta]"}]}], ",", 
            RowBox[{"k", "++"}], ",", 
            RowBox[{
             RowBox[{"\[Sigma]", "+=", 
              RowBox[{"\[Zeta]", " ", 
               RowBox[{"c", "[", 
                RowBox[{"[", 
                 RowBox[{"k", "+", 
                  RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}]}], ";", 
             RowBox[{"\[Zeta]", "*=", "z"}]}]}], "]"}], "]"}], ";", 
         RowBox[{"z12", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "z"}], ")"}], "^", "2"}]}], ";", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"[", 
            RowBox[{"P", "-", "1", "+", 
             RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "=", 
          RowBox[{"z12", " ", 
           RowBox[{"\[Sigma]", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Zeta]"}], ")"}]}]}]}], ";", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "<", "P"}], ",", 
           RowBox[{"k", "++"}], ",", 
           RowBox[{
            RowBox[{"c", "[", 
             RowBox[{"[", 
              RowBox[{"P", "-", "1", "-", "k", "+", 
               RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"z", " ", 
              RowBox[{"c", "[", 
               RowBox[{"[", 
                RowBox[{"P", "-", "k", "+", 
                 RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "+", 
             RowBox[{"z12", " ", 
              RowBox[{"c", "[", 
               RowBox[{"[", 
                RowBox[{"P", "-", "1", "-", "k", "+", 
                 RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}]}]}]}], "]"}]}]}], 
       "]"}], ";", "c"}]}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{3.960015938499461*^9},
 CellLabel->
  "In[102]:=",ExpressionUUID->"b857e7a3-528c-44e4-9f29-dc9103bd2066"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"W\[Beta]", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"W\[Beta]", "[", "n", "]"}], "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d\[Beta]", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "/", "2"}], "-", "#1"}], ",", 
           "n", ",", "#2"}], "]"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"n", "-", "#1"}], ")"}]}], 
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"n", "-", "#2"}], "]"}], 
          RowBox[{
           RowBox[{"Binomial", "[", 
            RowBox[{
             RowBox[{"n", "+", "1"}], ",", 
             RowBox[{"#1", "+", "1"}]}], "]"}], "/", "2"}]}]}], ")"}], "/", 
       RowBox[{"#2", "!"}]}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "+", "1"}], ",", 
       RowBox[{"n", "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}]}]], "Input",
 CellLabel->
  "In[103]:=",ExpressionUUID->"17964c76-4ee4-42dc-bae4-6af92bb551e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]", "[", 
   RowBox[{"x_", ",", 
    RowBox[{"n_Integer", "?", "NonNegative"}]}], "]"}], ":=", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{"0", "==", "n"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sign", "[", 
        RowBox[{"x", "+", 
         RowBox[{"1", "/", "2"}]}], "]"}], "-", 
       RowBox[{"Sign", "[", 
        RowBox[{"x", "-", 
         RowBox[{"1", "/", "2"}]}], "]"}]}], ")"}], "/", "2"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "<=", 
     RowBox[{"Abs", "[", "x", "]"}]}], ",", "0", ",", "True", ",", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Xi]", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "1"}], ")"}], "/", "2"}], "-", "x"}]}], ",", 
        "\[CapitalXi]"}], "}"}], ",", 
      RowBox[{
       RowBox[{"\[CapitalXi]", "=", 
        RowBox[{"\[LeftCeiling]", "\[Xi]", "\[RightCeiling]"}]}], ";", 
       RowBox[{
        RowBox[{
         RowBox[{"W\[Beta]", "[", "n", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"\[CapitalXi]", "+", 
           RowBox[{"(", "1", ")"}]}], "]"}], "]"}], " ", ".", " ", 
        RowBox[{"First", "[", 
         RowBox[{"VandermondeMatrix", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[CapitalXi]", "-", "\[Xi]"}], "}"}], ",", 
           RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{3.961050486039012*^9},
 CellLabel->
  "In[104]:=",ExpressionUUID->"271eafda-36b6-4c37-89a6-3db145d07a97"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Q", "[", "s_Association", "]"}], ":=", 
   RowBox[{
    RowBox[{"ContainsAll", "[", 
     RowBox[{
      RowBox[{"Keys", "[", "s", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<c\>\"", ",", "\"\<n\>\"", 
        ",", "\"\<\[CapitalDelta]x\>\""}], "}"}]}], "]"}], "\[And]", 
    RowBox[{"VectorQ", "[", 
     RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}], "\[And]", 
    RowBox[{"1", "<=", 
     RowBox[{"Length", "[", 
      RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}], "\[And]", 
    RowBox[{"IntegerQ", "[", 
     RowBox[{"s", "[", "\"\<n\>\"", "]"}], "]"}], "\[And]", 
    RowBox[{"NonNegative", "[", 
     RowBox[{"s", "[", "\"\<n\>\"", "]"}], "]"}], "\[And]", 
    RowBox[{
     RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "\[Element]", 
     "Reals"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[105]:=",ExpressionUUID->"88da4a65-215d-4ef3-9eef-2b1c0b395e17"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
    RowBox[{
     RowBox[{"c_List", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VectorQ", "[", "c", "]"}], "\[And]", 
        RowBox[{"1", "<=", 
         RowBox[{"Length", "[", "c", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"n_Integer", "?", "NonNegative"}], ",", 
     RowBox[{"\[CapitalDelta]x_", ":", "0"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"\[CapitalDelta]x", "\[Element]", "Reals"}], ",", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<c\>\"", "->", "c"}], ",", 
       RowBox[{"\"\<n\>\"", "->", "n"}], ",", 
       RowBox[{"\"\<\[CapitalDelta]x\>\"", "->", "\[CapitalDelta]x"}]}], 
      "|>"}], ",", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
       RowBox[{"c", ",", "n", ",", "\[CapitalDelta]x"}], "]"}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[106]:=",ExpressionUUID->"fa79e1b0-87ab-4312-ae94-420a9f945c07"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]FromSamples", "[", 
    RowBox[{
     RowBox[{"f_List", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VectorQ", "[", "f", "]"}], "\[And]", 
        RowBox[{"1", "<=", 
         RowBox[{"Length", "[", "f", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"n_Integer", "?", "NonNegative"}], ",", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Delay", "->", "0"}], ",", 
        RowBox[{"Regularized", "->", "False"}]}], "}"}], "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", "=", 
        RowBox[{"Length", "[", "f", "]"}]}], ",", 
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{"OptionValue", "[", "Delay", "]"}]}], ",", 
       RowBox[{"\[CapitalDelta]X", "=", 
        RowBox[{"Round", "[", 
         RowBox[{"OptionValue", "[", "Delay", "]"}], "]"}]}], ",", 
       RowBox[{"\[Delta]x", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "Delay", "]"}], "-", 
         RowBox[{"Round", "[", 
          RowBox[{"OptionValue", "[", "Delay", "]"}], "]"}]}]}], ",", 
       RowBox[{"r", "=", 
        RowBox[{"OptionValue", "[", "Regularized", "]"}]}]}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"data", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OddQ", "[", "P", "]"}], "\[Or]", 
            RowBox[{"\[Not]", "r"}]}], ",", "f", ",", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"e", "=", 
                RowBox[{"Downsample", "[", 
                 RowBox[{"f", ",", "2", ",", 
                  RowBox[{"0", "+", 
                   RowBox[{"(", "1", ")"}]}]}], "]"}]}], ",", 
               RowBox[{"o", "=", 
                RowBox[{"Downsample", "[", 
                 RowBox[{"f", ",", "2", ",", 
                  RowBox[{"1", "+", 
                   RowBox[{"(", "1", ")"}]}]}], "]"}]}], ",", "e0", ",", 
               "o0"}], "}"}], ",", 
             RowBox[{
              RowBox[{"e0", "=", 
               RowBox[{"Mean", "[", "e", "]"}]}], ";", 
              RowBox[{"o0", "=", 
               RowBox[{"Mean", "[", "o", "]"}]}], ";", 
              RowBox[{"e", "+=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"o0", "-", "e0"}], ")"}], "/", "2"}]}], ";", 
              RowBox[{"o", "+=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"e0", "-", "o0"}], ")"}], "/", "2"}]}], ";", 
              RowBox[{
               RowBox[{"Upsample", "[", 
                RowBox[{"e", ",", "2", ",", 
                 RowBox[{"0", "+", 
                  RowBox[{"(", "1", ")"}]}]}], "]"}], "+", 
               RowBox[{"Upsample", "[", 
                RowBox[{"o", ",", "2", ",", 
                 RowBox[{"1", "+", 
                  RowBox[{"(", "1", ")"}]}]}], "]"}]}]}]}], "]"}]}], "]"}]}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"0", "==", 
           RowBox[{"Chop", "[", "\[Delta]x", "]"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
            RowBox[{
             RowBox[{"PeriodicSamplesToCoeff\[Beta]", "[", 
              RowBox[{
               RowBox[{"RotateLeft", "[", 
                RowBox[{"data", ",", "\[CapitalDelta]X"}], "]"}], ",", "n"}], 
              "]"}], ",", "n", ",", "\[CapitalDelta]x"}], "]"}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", 
                RowBox[{
                 RowBox[{"Abs", "[", "\[Delta]x", "]"}], "-", 
                 RowBox[{"1", "/", "2"}]}], "]"}]}], ",", "LeastSquares", ",",
               "LinearSolve"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ToeplitzMatrix", "[", 
               RowBox[{
                RowBox[{"SparseArray", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", "r_", "}"}], ":>", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r", "-", 
                    RowBox[{"(", "1", ")"}]}], ")"}], "-", "\[CapitalDelta]x",
                     "-", 
                    RowBox[{"p", " ", "P"}]}], ",", "n"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"\[LeftCeiling]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r", "-", 
                    RowBox[{"(", "1", ")"}]}], ")"}], "-", "\[CapitalDelta]x",
                     "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}]}], ")"}], "/", 
                    "P"}], "\[RightCeiling]"}], ",", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r", "-", 
                    RowBox[{"(", "1", ")"}]}], ")"}], "-", "\[CapitalDelta]x",
                     "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}]}], ")"}], "/", 
                    "P"}], "\[RightFloor]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
                  
                  RowBox[{"{", "P", "}"}]}], "]"}], ",", 
                RowBox[{"SparseArray", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", "c_", "}"}], ":>", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"c", "-", 
                    RowBox[{"(", "1", ")"}]}], ")"}]}], "-", 
                    "\[CapitalDelta]x", "-", 
                    RowBox[{"p", " ", "P"}]}], ",", "n"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"\[LeftCeiling]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"c", "-", 
                    RowBox[{"(", "1", ")"}]}], ")"}]}], "-", 
                    "\[CapitalDelta]x", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}]}], ")"}], "/", 
                    "P"}], "\[RightCeiling]"}], ",", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"c", "-", 
                    RowBox[{"(", "1", ")"}]}], ")"}]}], "-", 
                    "\[CapitalDelta]x", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}]}], ")"}], "/", 
                    "P"}], "\[RightFloor]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
                  
                  RowBox[{"{", "P", "}"}]}], "]"}]}], "]"}], ",", "data"}], 
             "}"}]}], "]"}], ",", "n", ",", "\[CapitalDelta]x"}], "]"}]}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.963473906011168*^9, 3.963474199623782*^9, {3.96347445352713*^9, 
   3.9634744612058163`*^9}, {3.963474660927619*^9, 3.963474663072192*^9}, {
   3.963474695117228*^9, 3.9634746958386803`*^9}, 3.963474821989047*^9, {
   3.963474872054123*^9, 3.96347491598952*^9}, {3.963475099401265*^9, 
   3.963475115901906*^9}, {3.9634752703133163`*^9, 3.9634752732506523`*^9}, {
   3.963475424431266*^9, 3.963475426231237*^9}, {3.9634758734616337`*^9, 
   3.963475916093462*^9}, {3.9634760674996233`*^9, 3.963476075823773*^9}, 
   3.9634761347160807`*^9, {3.963481425844779*^9, 3.963481428991654*^9}, {
   3.963485250647307*^9, 3.9634852549507027`*^9}, 3.9634858531719637`*^9},
 CellLabel->
  "In[107]:=",ExpressionUUID->"609bff01-436d-4637-9863-fac3b700e790"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ShowP\[Beta]", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"min_", "/;", 
        RowBox[{"min", "\[Element]", "Reals"}]}], ",", 
       RowBox[{"max_", "/;", 
        RowBox[{"max", "\[Element]", "Reals"}]}]}], "}"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}], ",", 
       RowBox[{"\[Delta]k", "=", 
        RowBox[{
         RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s", "[", "\"\<n\>\"", "]"}], "+", "1"}], ")"}], "/", 
          "2"}], "-", 
         RowBox[{"\[LeftFloor]", 
          RowBox[{
           RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"s", "[", "\"\<n\>\"", "]"}], "+", "1"}], ")"}], "/", 
            "2"}]}], "\[RightFloor]"}]}]}]}], "}"}], ",", 
     RowBox[{"Show", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"fP\[Beta]", "[", 
           RowBox[{"s", ",", "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "min", ",", "max"}], "}"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "opts", "}"}], ",", " ", 
             RowBox[{"Options", "[", "Plot", "]"}]}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"fP\[Beta]", "[", 
               RowBox[{"s", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"\[LeftCeiling]", "min", "\[RightCeiling]"}], ",", 
              RowBox[{"\[LeftFloor]", "max", "\[RightFloor]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"PlotMarkers", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<OpenMarkers\>\"", ",", "4"}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "->", "Blue"}], ",", 
          RowBox[{"Filling", "->", "Axis"}]}], "]"}], ",", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"k", " ", "P"}], ",", 
              RowBox[{"fP\[Beta]", "[", 
               RowBox[{"s", ",", 
                RowBox[{"k", " ", "P"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"\[LeftCeiling]", 
               RowBox[{
                RowBox[{"\[LeftCeiling]", "min", "\[RightCeiling]"}], "/", 
                "P"}], "\[RightCeiling]"}], ",", 
              RowBox[{"\[LeftFloor]", 
               RowBox[{
                RowBox[{"\[LeftFloor]", "max", "\[RightFloor]"}], "/", "P"}], 
               "\[RightFloor]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotMarkers", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<OpenMarkers\>\"", ",", "4"}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "->", "Red"}], ",", 
          RowBox[{"Filling", "->", "Axis"}]}], "]"}], ",", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"k", "+", "\[Delta]k"}], ",", 
              RowBox[{"fP\[Beta]", "[", 
               RowBox[{"s", ",", 
                RowBox[{"k", "+", "\[Delta]k"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"\[LeftCeiling]", "min", "\[RightCeiling]"}], ",", 
              RowBox[{"\[LeftFloor]", "max", "\[RightFloor]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"PlotStyle", "->", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"AbsolutePointSize", "[", "3", "]"}]}], "}"}]}]}], 
         "]"}]}], "}"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[108]:=",ExpressionUUID->"2557dd2b-4724-4aa3-86af-c9acd771cb70"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fP\[Beta]", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", "x_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], ",", 
       RowBox[{"P", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Xi]", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "1"}], ")"}], "/", "2"}], "-", "x", "+", 
          "\[CapitalDelta]x"}]}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"0", "==", "n"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"0", "==", 
            RowBox[{"Chop", "[", 
             RowBox[{"\[Xi]", "-", 
              RowBox[{"Round", "[", "\[Xi]", "]"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"\[LeftFloor]", 
                    RowBox[{"x", "-", "\[CapitalDelta]x"}], "\[RightFloor]"}],
                    ",", "P"}], "]"}], "+", 
                 RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "+", 
              RowBox[{"c", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"\[LeftCeiling]", 
                    RowBox[{"x", "-", "\[CapitalDelta]x"}], 
                    "\[RightCeiling]"}], ",", "P"}], "]"}], "+", 
                 RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ")"}], "/", "2"}],
            ",", 
           RowBox[{"c", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"x", "-", "\[CapitalDelta]x"}], "]"}], ",", "P"}], 
               "]"}], "+", 
              RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"#", ",", "P"}], "]"}], "+", 
                RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
            RowBox[{"n", "+", "1"}], ",", 
            RowBox[{"\[LeftFloor]", 
             RowBox[{"-", "\[Xi]"}], "\[RightFloor]"}]}], "]"}], " ", ".", 
          " ", 
          RowBox[{"W\[Beta]", "[", "n", "]"}], " ", ".", " ", 
          RowBox[{"First", "[", 
           RowBox[{"VandermondeMatrix", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[LeftCeiling]", "\[Xi]", "\[RightCeiling]"}], "-", 
               "\[Xi]"}], "}"}], ",", 
             RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.961477870852182*^9},
 CellLabel->
  "In[109]:=",ExpressionUUID->"a186ef1b-24d4-4018-a85f-37bfa5bc1478"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SamplesFromP\[Beta]", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", 
     RowBox[{"K0_Integer", "?", "NonNegative"}], ",", "x_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], ",", 
       RowBox[{"P", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"0", "==", "K0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Xi]", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "/", "2"}], "-", "x", "+", 
            "\[CapitalDelta]x"}]}], ",", "w"}], "}"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"0", "==", "n"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"0", "==", 
             RowBox[{"Chop", "[", 
              RowBox[{"\[Xi]", "-", 
               RowBox[{"Round", "[", "\[Xi]", "]"}]}], "]"}]}], ",", 
            RowBox[{"Array", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"c", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[LeftFloor]", "#", "\[RightFloor]"}], ",", 
                    "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "+", 
                  RowBox[{"c", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[LeftCeiling]", "#", "\[RightCeiling]"}], ",", 
                    "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ")"}], "/", 
                "2"}], "&"}], ",", "K0", ",", 
              RowBox[{"x", "-", "\[CapitalDelta]x"}]}], "]"}], ",", 
            RowBox[{"Array", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"c", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"Round", "[", "#", "]"}], ",", "P"}], "]"}], "+", 
                  
                  RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", "K0", ",", 
              RowBox[{"x", "-", "\[CapitalDelta]x"}]}], "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"w", "=", 
            RowBox[{
             RowBox[{"W\[Beta]", "[", "n", "]"}], " ", ".", " ", 
             RowBox[{"First", "[", 
              RowBox[{"VandermondeMatrix", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[LeftCeiling]", "\[Xi]", "\[RightCeiling]"}], "-",
                   "\[Xi]"}], "}"}], ",", 
                RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}]}], ";", 
           RowBox[{"Array", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Array", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"c", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
                 RowBox[{"n", "+", "1"}], ",", "#"}], "]"}], " ", ".", " ", 
               "w"}], "&"}], ",", "K0", ",", 
             RowBox[{"\[LeftFloor]", 
              RowBox[{"-", "\[Xi]"}], "\[RightFloor]"}]}], "]"}]}]}], "]"}]}],
        "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.962270440651971*^9},
 CellLabel->
  "In[110]:=",ExpressionUUID->"169deea1-7a30-4a55-be4c-8e59fd404b04"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SamplesFromP\[Beta]", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", 
     RowBox[{"K0_Integer", "?", "NonNegative"}], ",", 
     RowBox[{"M_Integer", "?", "Positive"}], ",", "x_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], ",", 
       RowBox[{"P", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"0", "==", "K0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Xi]", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "/", "2"}], "-", "x", "+", 
            "\[CapitalDelta]x"}]}], ",", "\[CapitalXi]", ",", "W"}], "}"}], ",", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"1", "==", "M"}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"SamplesFromP\[Beta]", "[", 
             RowBox[{"s", ",", "K0", ",", "x"}], "]"}], "]"}]}], "]"}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"0", "==", "n"}], ",", 
           RowBox[{"Array", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "=", 
                   RowBox[{"\[Xi]", "-", 
                    RowBox[{"#", "/", "M"}]}]}], ",", 
                  RowBox[{"y", "=", 
                   RowBox[{"x", "+", 
                    RowBox[{"#", "/", "M"}], "-", "\[CapitalDelta]x"}]}]}], 
                 "}"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"0", "==", 
                   RowBox[{"Chop", "[", 
                    RowBox[{"\[Sigma]", "-", 
                    RowBox[{"Round", "[", "\[Sigma]", "]"}]}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[LeftFloor]", "y", "\[RightFloor]"}], ",", 
                    "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "+", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[LeftCeiling]", "y", "\[RightCeiling]"}], ",", 
                    "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ")"}], "/", 
                   "2"}], ",", 
                  RowBox[{"c", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Round", "[", "y", "]"}], ",", "P"}], "]"}], "+", 
                    
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "]"}]}], "]"}],
               "&"}], ",", 
             RowBox[{"K0", " ", "M"}], ",", "0"}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[CapitalXi]", "=", 
             RowBox[{"Array", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"\[LeftCeiling]", "\[Xi]", "\[RightCeiling]"}], "-", 
                 
                 RowBox[{"(", 
                  RowBox[{"\[Xi]", "-", 
                   RowBox[{"#", "/", "M"}]}], ")"}]}], "&"}], ",", "M", ",", 
               "0"}], "]"}]}], ";", 
            RowBox[{"W", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"1", "<=", "#"}], ",", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{
                    RowBox[{"W\[Beta]", "[", "n", "]"}], " ", ".", " ", 
                    RowBox[{"First", "[", 
                    RowBox[{"VandermondeMatrix", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", "-", "1"}], "}"}], ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}]}], "]"}], ",", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"W\[Beta]", "[", "n", "]"}], " ", ".", " ", 
                    RowBox[{"First", "[", 
                    RowBox[{"VandermondeMatrix", "[", 
                    RowBox[{
                    RowBox[{"{", "#", "}"}], ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", "0", "}"}]}], "]"}]}], "]"}], "&"}], ",", 
               "\[CapitalXi]"}], "]"}]}], ";", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Array", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"W", " ", ".", " ", 
                 RowBox[{"Array", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
                   RowBox[{"n", "+", "2"}], ",", "#"}], "]"}]}], "&"}], ",", 
               "K0", ",", 
               RowBox[{"\[LeftFloor]", 
                RowBox[{"-", "\[Xi]"}], "\[RightFloor]"}]}], "]"}], "]"}]}]}],
           "]"}]}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.962270446727213*^9, 3.962270449550507*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"66e5211b-1a91-4b87-8203-e6de35bf4c8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PeriodP\[Beta]", "[", 
    RowBox[{"s_", "/;", 
     RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], "]"}], ":=", 
   RowBox[{"Length", "[", 
    RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[112]:=",ExpressionUUID->"b0eb6fd1-034a-406e-b230-db836d6351b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DegreeP\[Beta]", "[", 
    RowBox[{"s_", "/;", 
     RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], "]"}], ":=", 
   RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[113]:=",ExpressionUUID->"f9dd1f17-b304-4ce8-8372-648e1fb4328c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DelayP\[Beta]", "[", 
    RowBox[{"s_", "/;", 
     RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], "]"}], ":=", 
   RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[114]:=",ExpressionUUID->"48ced9b1-0536-4ed6-ae4c-0f15775ada11"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MeanP\[Beta]", "[", 
    RowBox[{"s_", "/;", 
     RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], "]"}], ":=", 
   RowBox[{"Mean", "[", 
    RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[115]:=",ExpressionUUID->"4f52b231-ec04-42be-8e38-c2807ce653d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"b\[Beta]", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"b\[Beta]", "[", "n", "]"}], "=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"d\[Beta]", "[", 
        RowBox[{"#", ",", "n", ",", "0"}], "]"}], "&"}], ",", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"Ceiling", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "/", "2"}], "]"}]}], "+", "1"}], ",", 
      RowBox[{"-", 
       RowBox[{"Floor", "[", 
        RowBox[{"n", "/", "2"}], "]"}]}]}], "]"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[116]:=",ExpressionUUID->"616777cd-ed73-45aa-b7ef-2d3630f7213e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VarianceP\[Beta]", "[", 
    RowBox[{"s_", "/;", 
     RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
       RowBox[{"P", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"c", " ", ".", " ", 
        RowBox[{"ListConvolve", "[", 
         RowBox[{
          RowBox[{"b\[Beta]", "[", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "1"}], "]"}], ",", 
          RowBox[{"RotateLeft", "[", 
           RowBox[{"c", ",", "n"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "/", "P"}], "-", 
      RowBox[{
       RowBox[{"Mean", "[", "c", "]"}], "^", "2"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[117]:=",ExpressionUUID->"fcf6369a-82b2-49df-a6cd-4a99ead63535"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Wint\[Beta]", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Wint\[Beta]", "[", "n", "]"}], "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"0", "==", "#2"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"W\[Beta]", "[", "n", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"p", "+", 
                 RowBox[{"(", "1", ")"}]}], ",", 
                RowBox[{"q", "+", 
                 RowBox[{"(", "1", ")"}]}]}], "]"}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"q", "+", "1"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"q", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", 
            RowBox[{"#1", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"W\[Beta]", "[", "n", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"#1", "+", 
             RowBox[{"(", "1", ")"}]}], ",", 
            RowBox[{"#2", "-", "1", "+", 
             RowBox[{"(", "1", ")"}]}]}], "]"}], "]"}], "/", "#2"}]}], "]"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "+", "1"}], ",", 
       RowBox[{"n", "+", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}]}]], "Input",
 CellLabel->
  "In[118]:=",ExpressionUUID->"afdfdab3-f5b9-4253-9090-ef5824a2f414"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Int\[Beta]", "[", 
   RowBox[{"x_", ",", 
    RowBox[{"n_Integer", "?", "NonNegative"}]}], "]"}], ":=", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{"x", "<=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"n", "+", "1"}], ")"}]}], "/", "2"}]}], ",", "0", ",", 
    RowBox[{"x", "<", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}], "/", "2"}]}], ",", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Xi]", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "1"}], ")"}], "/", "2"}], "-", "x"}]}], ",", 
        "\[CapitalXi]"}], "}"}], ",", 
      RowBox[{
       RowBox[{"\[CapitalXi]", "=", 
        RowBox[{"\[LeftCeiling]", "\[Xi]", "\[RightCeiling]"}]}], ";", 
       RowBox[{
        RowBox[{
         RowBox[{"Wint\[Beta]", "[", "n", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"\[CapitalXi]", "+", 
           RowBox[{"(", "1", ")"}]}], "]"}], "]"}], " ", ".", " ", 
        RowBox[{"First", "[", 
         RowBox[{"VandermondeMatrix", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[CapitalXi]", "-", "\[Xi]"}], "}"}], ",", 
           RowBox[{"n", "+", "2"}]}], "]"}], "]"}]}]}]}], "]"}], ",", "True", 
    ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{3.9626924184709997`*^9},
 CellLabel->
  "In[119]:=",ExpressionUUID->"5bebfd03-591c-44dc-a17e-7ca31b0f498d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AreaUnderP\[Beta]", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], ",", 
       RowBox[{"K0", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}], ",", 
       RowBox[{"P", "=", 
        RowBox[{"\[LeftCeiling]", 
         RowBox[{"b", "-", 
          RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", "\"\<n\>\"", "]"}], "+", "1"}], ")"}], "/", 
           "2"}]}], "\[RightCeiling]"}]}], ",", 
       RowBox[{"Q", "=", 
        RowBox[{"\[LeftCeiling]", 
         RowBox[{"a", "-", 
          RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", "\"\<n\>\"", "]"}], "+", "1"}], ")"}], "/", 
           "2"}]}], "\[RightCeiling]"}]}]}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"P", "-", "1"}], ",", "K0"}], "]"}]}], ",", 
         RowBox[{"q", "=", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"Q", "-", "1"}], ",", "K0"}], "]"}]}], ",", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"Mean", "[", "c", "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"b", "-", "a"}], ")"}], "\[Mu]"}], "+", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"p", "<", "q"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"q", "-", "p"}], ")"}], "\[Mu]"}], "-", 
           RowBox[{"Total", "[", 
            RowBox[{"Take", "[", 
             RowBox[{"c", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"p", "+", "1"}], ",", "q"}], "}"}], "+", 
               RowBox[{"(", "1", ")"}]}]}], "]"}], "]"}]}], ",", 
          RowBox[{"q", "<", "p"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"q", "-", "p"}], ")"}], "\[Mu]"}], "+", 
           RowBox[{"Total", "[", 
            RowBox[{"Take", "[", 
             RowBox[{"c", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"q", "+", "1"}], ",", "p"}], "}"}], "+", 
               RowBox[{"(", "1", ")"}]}]}], "]"}], "]"}]}], ",", "True", ",", 
          "0"}], "]"}], "+", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"#", ",", "K0"}], "]"}], "+", 
                RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "-", "\[Mu]"}], 
            "&"}], ",", 
           RowBox[{"n", "+", "1"}], ",", "P"}], "]"}], " ", ".", " ", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"Int\[Beta]", "[", 
              RowBox[{"#", ",", "n"}], "]"}]}], "&"}], ",", 
           RowBox[{"n", "+", "1"}], ",", 
           RowBox[{"P", "+", "\[CapitalDelta]x", "-", "b"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"#", ",", "K0"}], "]"}], "+", 
                RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "-", "\[Mu]"}], 
            "&"}], ",", 
           RowBox[{"n", "+", "1"}], ",", "Q"}], "]"}], " ", ".", " ", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"Int\[Beta]", "[", 
              RowBox[{"#", ",", "n"}], "]"}]}], "&"}], ",", 
           RowBox[{"n", "+", "1"}], ",", 
           RowBox[{"Q", "+", "\[CapitalDelta]x", "-", "a"}]}], "]"}]}]}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[120]:=",ExpressionUUID->"96bfda75-53ff-442a-b482-753f18245efd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SgnP\[Beta]", "[", 
    RowBox[{"s_", "/;", 
     RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], ",", 
       RowBox[{"P", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sgn", ",", "x", ",", "k", ",", "s0", ",", "s1", ",", "s2"}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{"sgn", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"1", "==", "P"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Sign", "[", 
                RowBox[{"Chop", "[", 
                 RowBox[{"c", "[", 
                  RowBox[{"[", 
                   RowBox[{"0", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "]"}], "]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"Sign", "[", 
                RowBox[{"Chop", "[", 
                 RowBox[{"c", "[", 
                  RowBox[{"[", 
                   RowBox[{"0", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "]"}], "]"}]}], 
              "}"}]}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"0", "==", "n"}], ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalDelta]x", "-", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "c", "]"}], "+", 
                    RowBox[{"First", "[", "c", "]"}]}], "]"}], "]"}]}], "}"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalDelta]x", "-", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{"\[CapitalDelta]x", "+", 
                    RowBox[{"1", "/", "2"}]}]}], "}"}], ",", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"Chop", "[", 
                    RowBox[{"First", "[", "c", "]"}], "]"}], "]"}]}], "}"}]}],
                    "}"}], "}"}], ",", 
                 RowBox[{"Array", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "+", "\[CapitalDelta]x", "-", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "-", "1", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "+", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "]"}], "]"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "+", "\[CapitalDelta]x", "-", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{"#", "+", "\[CapitalDelta]x", "+", 
                    RowBox[{"1", "/", "2"}]}]}], "}"}], ",", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"Chop", "[", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "}"}], "&"}], ",", 
                   RowBox[{"P", "-", "1"}], ",", "1"}], "]"}]}], "]"}], ",", 
               "1"}], "]"}], ",", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"lb", "=", 
                  RowBox[{"P\[Beta]LowerBoundP\[Beta]", "[", 
                   RowBox[{"s", ",", "0"}], "]"}]}], ",", 
                 RowBox[{"ub", "=", 
                  RowBox[{"P\[Beta]UpperBoundP\[Beta]", "[", 
                   RowBox[{"s", ",", "0"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Chi]", "=", 
                    RowBox[{
                    RowBox[{"lb", "[", "\"\<c\>\"", "]"}], 
                    RowBox[{"ub", "[", "\"\<c\>\"", "]"}]}]}], ",", 
                   RowBox[{"\[Sigma]", "=", 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{"lb", "[", "\"\<c\>\"", "]"}], "+", 
                    RowBox[{"ub", "[", "\"\<c\>\"", "]"}]}], "]"}]}], ",", 
                   RowBox[{"px", "=", 
                    RowBox[{
                    RowBox[{"W\[Beta]", "[", "n", "]"}], " ", ".", " ", 
                    RowBox[{"First", "[", 
                    RowBox[{"VandermondeMatrix", "[", 
                    RowBox[{
                    RowBox[{"{", "x", "}"}], ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}]}]}], "}"}], ",", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{
                   RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"min", "=", 
                    RowBox[{"#", "+", "\[CapitalDelta]x", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}]}], ",", 
                    RowBox[{"max", "=", 
                    RowBox[{"#", "+", "\[CapitalDelta]x", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}]}]}]}], "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"0", "<", 
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"min", ",", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"min", ",", "max"}], "}"}], ",", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "}"}]}], "}"}],
                     ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"a", "=", 
                    RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"n", "+", "1"}], ",", "#"}], "]"}]}], "}"}], ",", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Apply", "[", 
                    RowBox[{"And", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"0", "==", 
                    RowBox[{"Chop", "[", "#", "]"}]}], "&"}], ",", "a"}], 
                    "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"min", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"min", ",", "max"}], "}"}], ",", "0"}], "}"}]}], 
                    "}"}], ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Z", "=", 
                    RowBox[{"min", "+", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"NSolveValues", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"a", " ", ".", " ", "px"}], "==", "0.0"}], ",", 
                    "x", ",", "Reals"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"0.0", "<=", 
                    RowBox[{"Chop", "[", "#", "]"}], "<", "1.0"}], "&"}]}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", "}"}], "==", "Z"}], ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[Sigma]0", "=", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{"min", "+", 
                    RowBox[{"1", "/", "2"}]}]}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"min", ",", "\[Sigma]0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"min", ",", "max"}], "}"}], ",", "\[Sigma]0"}], 
                    "}"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"0", "==", 
                    RowBox[{"Chop", "[", 
                    RowBox[{"min", "-", 
                    RowBox[{"First", "[", "Z", "]"}]}], "]"}]}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"min", ",", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"s", ",", "min"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"min", ",", 
                    RowBox[{"First", "[", "Z", "]"}]}], "}"}], ",", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"min", "+", 
                    RowBox[{"First", "[", "Z", "]"}]}], ")"}], "/", "2"}]}], 
                    "]"}], "]"}]}], "}"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Z", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Z", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", 
                    RowBox[{"Z", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", "1", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Z", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "+", 
                    RowBox[{"Z", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", "1", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ")"}], "/", 
                    "2"}]}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "Z", "]"}], "-", "2"}]}], "}"}]}], 
                    "]"}], ",", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Last", "[", "Z", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Last", "[", "Z", "]"}], ",", "max"}], "}"}], ",", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "Z", "]"}], "+", "max"}], ")"}], "/",
                     "2"}]}], "]"}], "]"}]}], "}"}]}], "}"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], "&"}],
                     ",", "P", ",", "0"}], "]"}], ",", "1"}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}]}], "]"}]}], ";", 
        RowBox[{"sgn", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", "w", "}"}], ",", 
             RowBox[{
              RowBox[{"w", " ", "=", " ", 
               RowBox[{"{", "}"}]}], ";", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"k", "=", "0"}], ",", 
                RowBox[{"k", "<", 
                 RowBox[{"Length", "[", "sgn", "]"}]}], ",", 
                RowBox[{"k", "+=", "1"}], ",", 
                RowBox[{"w", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"w", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"NumberQ", "[", 
                    RowBox[{"First", "[", 
                    RowBox[{"sgn", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"sgn", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "]"}], ",", 
                    "P"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"sgn", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "]"}]}], "}"}], 
                    "}"}], ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"min", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", 
                    RowBox[{"sgn", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "]"}], "]"}], ",",
                     "P"}], "]"}]}], ",", 
                    RowBox[{"max", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", 
                    RowBox[{"sgn", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "]"}], "]"}], ",",
                     "P"}], "]"}]}], ",", 
                    RowBox[{"\[Sigma]", "=", 
                    RowBox[{"Last", "[", 
                    RowBox[{"sgn", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "]"}]}]}], "}"}],
                     ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"min", "<", "max"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"min", ",", "max"}], "}"}], ",", "\[Sigma]"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"0", "==", 
                    RowBox[{"Chop", "[", "max", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"min", ",", "P"}], "}"}], ",", "\[Sigma]"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"min", ",", "P"}], "}"}], ",", "\[Sigma]"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "\[Sigma]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "max"}], "}"}], ",", "\[Sigma]"}], 
                    "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
                  "]"}]}]}], "]"}], ";", "w"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"VectorQ", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
               RowBox[{"First", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
               RowBox[{"First", "[", "#1", "]"}]}], "]"}], "<=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"VectorQ", "[", 
                RowBox[{"First", "[", "#2", "]"}], "]"}], ",", 
               RowBox[{"First", "[", 
                RowBox[{"First", "[", "#2", "]"}], "]"}], ",", 
               RowBox[{"First", "[", "#2", "]"}]}], "]"}]}], "&"}]}], "]"}]}],
         ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"4", "<=", 
           RowBox[{"Length", "[", "sgn", "]"}]}], ",", 
          RowBox[{
           RowBox[{"s2", "=", 
            RowBox[{"Last", "[", "sgn", "]"}]}], ";", 
           RowBox[{"s1", "=", 
            RowBox[{"sgn", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Length", "[", "sgn", "]"}], "-", "2", "+", 
               RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", 
              RowBox[{
               RowBox[{"Length", "[", "sgn", "]"}], "-", "3"}]}], ",", 
             RowBox[{"1", "<=", "k"}], ",", 
             RowBox[{"k", "-=", "2"}], ",", 
             RowBox[{
              RowBox[{"s0", "=", 
               RowBox[{"sgn", "[", 
                RowBox[{"[", 
                 RowBox[{"k", "+", 
                  RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", "s0", "]"}], "==", 
                 RowBox[{"Last", "[", "s1", "]"}], "==", 
                 RowBox[{"Last", "[", "s2", "]"}]}], ",", 
                RowBox[{
                 RowBox[{"s0", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "s0", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "s2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"Last", "[", "s1", "]"}]}], "}"}]}], ";", 
                 RowBox[{
                  RowBox[{"sgn", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "=", "s0"}], ";", 
                 RowBox[{"sgn", "=", 
                  RowBox[{"Drop", "[", 
                   RowBox[{"sgn", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1", "+", 
                    RowBox[{"(", "1", ")"}]}], ",", 
                    RowBox[{"k", "+", "2", "+", 
                    RowBox[{"(", "1", ")"}]}]}], "}"}]}], "]"}]}]}]}], "]"}], 
              ";", 
              RowBox[{"s2", "=", "s0"}], ";", 
              RowBox[{"s1", "=", 
               RowBox[{"sgn", "[", 
                RowBox[{"[", 
                 RowBox[{"k", "-", "1", "+", 
                  RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}]}]}], "]"}]}]}], 
         "]"}], ";", "sgn"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[121]:=",ExpressionUUID->"df97c363-5611-400f-a367-bc5b86d7b1c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ZeroesP\[Beta]", "[", 
    RowBox[{"s_", "/;", 
     RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{"First", ",", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"SgnP\[Beta]", "[", "s", "]"}], ",", 
       RowBox[{
        RowBox[{"0", "==", 
         RowBox[{"Last", "[", "#", "]"}]}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[122]:=",ExpressionUUID->"5997d863-0cd5-40a7-97b6-77f29380bc66"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ZeroCrossP\[Beta]", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Descending", "->", "True"}], ",", 
        RowBox[{"Ascending", "->", "True"}]}], "}"}], "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"P", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "sgn", ",", "s0", ",", "s1", ",", "k", ",", "asc", ",", "desc"}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"OptionValue", "[", "Descending", "]"}], "\[Or]", 
             RowBox[{"OptionValue", "[", "Ascending", "]"}]}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", 
        RowBox[{"sgn", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"SgnP\[Beta]", "[", "s", "]"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x_", ",", "y_"}], "}"}], "/;", 
            RowBox[{
             RowBox[{"NumberQ", "[", "x", "]"}], "\[Or]", 
             RowBox[{"0", "==", "y"}]}]}]}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "sgn", "]"}], "<", "2"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", 
        RowBox[{"s1", "=", 
         RowBox[{"Last", "[", "sgn", "]"}]}], ";", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", 
           RowBox[{
            RowBox[{"Length", "[", "sgn", "]"}], "-", "2"}]}], ",", 
          RowBox[{"0", "<=", "k"}], ",", 
          RowBox[{"k", "--"}], ",", 
          RowBox[{
           RowBox[{"s0", "=", 
            RowBox[{"sgn", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", 
               RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "s0", "]"}], "==", 
              RowBox[{"Last", "[", "s1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"s0", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"First", "[", 
                    RowBox[{"First", "[", "s0", "]"}], "]"}], ",", 
                   RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "s1", "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"Last", "[", "s1", "]"}]}], "}"}]}], ";", 
              RowBox[{
               RowBox[{"sgn", "[", 
                RowBox[{"[", 
                 RowBox[{"k", "+", 
                  RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "=", "s0"}], ";", 
              RowBox[{"sgn", "=", 
               RowBox[{"Drop", "[", 
                RowBox[{"sgn", ",", 
                 RowBox[{"{", 
                  RowBox[{"k", "+", "1", "+", 
                   RowBox[{"(", "1", ")"}]}], "}"}]}], "]"}]}]}]}], "]"}], ";", 
           RowBox[{"s1", "=", "s0"}]}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "sgn", "]"}], "<", "2"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", 
        RowBox[{"s0", "=", 
         RowBox[{"Last", "[", "sgn", "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "s0", "]"}], "==", 
           RowBox[{"Last", "[", "s1", "]"}]}], ",", 
          RowBox[{
           RowBox[{"s0", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", 
                 RowBox[{"First", "[", "s0", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"First", "[", "s1", "]"}], "]"}], "+", "P"}]}], 
               "}"}], ",", 
              RowBox[{"Last", "[", "s1", "]"}]}], "}"}]}], ";", 
           RowBox[{
            RowBox[{"sgn", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Length", "[", "sgn", "]"}], "-", "1", "+", 
               RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "=", "s0"}], ";", 
           RowBox[{"sgn", "=", 
            RowBox[{"Drop", "[", 
             RowBox[{"sgn", ",", "1"}], "]"}]}]}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "sgn", "]"}], "<", "2"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", 
        RowBox[{"asc", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"desc", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"s1", "=", 
         RowBox[{"First", "[", "sgn", "]"}]}], ";", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "<", 
           RowBox[{"Length", "[", "sgn", "]"}]}], ",", 
          RowBox[{"k", "++"}], ",", 
          RowBox[{
           RowBox[{"s0", "=", "s1"}], ";", 
           RowBox[{"s1", "=", 
            RowBox[{"sgn", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", 
               RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"OptionValue", "[", "Descending", "]"}], "\[And]", 
              RowBox[{"1", "==", 
               RowBox[{"Last", "[", "s0", "]"}]}]}], ",", 
             RowBox[{"desc", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"desc", ",", 
                RowBox[{"{", 
                 RowBox[{"Interval", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "s0", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "s1", "]"}], "]"}]}], "}"}], "]"}], 
                 "}"}]}], "]"}]}]}], "]"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"OptionValue", "[", "Ascending", "]"}], "\[And]", 
              RowBox[{
               RowBox[{"-", "1"}], "==", 
               RowBox[{"Last", "[", "s0", "]"}]}]}], ",", 
             RowBox[{"asc", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"asc", ",", 
                RowBox[{"{", 
                 RowBox[{"Interval", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "s0", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "s1", "]"}], "]"}]}], "}"}], "]"}], 
                 "}"}]}], "]"}]}]}], "]"}]}]}], "]"}], ";", 
        RowBox[{"s0", "=", "s1"}], ";", 
        RowBox[{"s1", "=", 
         RowBox[{"First", "[", "sgn", "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "Descending", "]"}], "\[And]", 
           RowBox[{"1", "==", 
            RowBox[{"Last", "[", "s0", "]"}]}]}], ",", 
          RowBox[{"desc", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"desc", ",", 
             RowBox[{"{", 
              RowBox[{"Interval", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"First", "[", "s0", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"First", "[", 
                   RowBox[{"First", "[", "s1", "]"}], "]"}], "+", "P"}]}], 
                "}"}], "]"}], "}"}]}], "]"}]}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "Ascending", "]"}], "\[And]", 
           RowBox[{
            RowBox[{"-", "1"}], "==", 
            RowBox[{"Last", "[", "s0", "]"}]}]}], ",", 
          RowBox[{"asc", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"asc", ",", 
             RowBox[{"{", 
              RowBox[{"Interval", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"First", "[", "s0", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"First", "[", 
                   RowBox[{"First", "[", "s1", "]"}], "]"}], "+", "P"}]}], 
                "}"}], "]"}], "}"}]}], "]"}]}]}], "]"}], ";", 
        RowBox[{"Sort", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"asc", ",", "desc"}], "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[123]:=",ExpressionUUID->"bac1387a-603a-49b8-b5a5-094d5671f6ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtremaP\[Beta]", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Minima", "->", "True"}], ",", 
        RowBox[{"Maxima", "->", "True"}]}], "}"}], "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], ",", 
       RowBox[{"P", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"min", ",", "max", ",", "k", ",", "m0", ",", "m1"}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "==", "P"}], "\[Or]", 
           RowBox[{"\[Not]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OptionValue", "[", "Minima", "]"}], "\[Or]", 
              RowBox[{"OptionValue", "[", "Maxima", "]"}]}], ")"}]}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"0", "<", "n"}], ",", 
          RowBox[{
           RowBox[{"min", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"\[Not]", 
               RowBox[{"OptionValue", "[", "Minima", "]"}]}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Min", "[", "#", "]"}], "+", 
                    RowBox[{"Max", "[", "#", "]"}]}], ")"}], "/", "2"}]}], 
                    "]"}]}], "}"}], "&"}], ",", 
                RowBox[{"ZeroCrossP\[Beta]", "[", 
                 RowBox[{
                  RowBox[{"P\[Beta]Grad", "[", "s", "]"}], ",", 
                  RowBox[{"Descending", "->", "False"}], ",", 
                  RowBox[{"Ascending", "->", "True"}]}], "]"}]}], "]"}]}], 
             "]"}]}], ";", 
           RowBox[{"max", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"\[Not]", 
               RowBox[{"OptionValue", "[", "Maxima", "]"}]}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Min", "[", "#", "]"}], "+", 
                    RowBox[{"Max", "[", "#", "]"}]}], ")"}], "/", "2"}]}], 
                    "]"}]}], "}"}], "&"}], ",", 
                RowBox[{"ZeroCrossP\[Beta]", "[", 
                 RowBox[{
                  RowBox[{"P\[Beta]Grad", "[", "s", "]"}], ",", 
                  RowBox[{"Descending", "->", "True"}], ",", 
                  RowBox[{"Ascending", "->", "False"}]}], "]"}]}], "]"}]}], 
             "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"min", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"\[Not]", 
               RowBox[{"OptionValue", "[", "Minima", "]"}]}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{
               RowBox[{"min", "=", 
                RowBox[{"Array", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"\[Not]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"#", "-", "1"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ">=", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "<=", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"#", "+", "1"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ")"}]}], ",", 
                    "Nothing", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#"}], "}"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "}"}]}], "]"}],
                    "&"}], ",", "P", ",", "0"}], "]"}]}], ";", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{"0", "==", 
                  RowBox[{"Length", "[", "min", "]"}]}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"1", "==", 
                  RowBox[{"Length", "[", "min", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"k", "=", 
                   RowBox[{"First", "[", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "min", "]"}], "]"}], "]"}]}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"\[Not]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"k", "-", "1"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ">", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "<", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "\[CapitalDelta]x", "-", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{"k", "+", "\[CapitalDelta]x", "+", 
                    RowBox[{"1", "/", "2"}]}]}], "}"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "}"}], "}"}]}],
                    "]"}]}], ",", "True", ",", 
                 RowBox[{
                  RowBox[{"m1", "=", 
                   RowBox[{"Last", "[", "min", "]"}]}], ";", 
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"k", "=", 
                    RowBox[{
                    RowBox[{"Length", "[", "min", "]"}], "-", "2"}]}], ",", 
                    RowBox[{"0", "<=", "k"}], ",", 
                    RowBox[{"k", "--"}], ",", 
                    RowBox[{
                    RowBox[{"m0", "=", 
                    RowBox[{"min", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "m0", "]"}], "!=", 
                    RowBox[{"Last", "[", "m1", "]"}]}], "\[Or]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "m0", "]"}], "]"}], "+", "1"}], "!=", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "m1", "]"}], "]"}]}]}], ",", 
                    RowBox[{"m1", "=", "m0"}], ",", 
                    RowBox[{
                    RowBox[{"m1", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "m0", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "m1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"Last", "[", "m1", "]"}]}], "}"}]}], ";", 
                    RowBox[{"min", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"min", ",", 
                    RowBox[{"{", 
                    RowBox[{"k", "+", "1", "+", 
                    RowBox[{"(", "1", ")"}]}], "}"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"min", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "=", "m1"}]}]}], 
                    "]"}]}]}], "]"}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"1", "<", 
                    RowBox[{"Length", "[", "min", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"m0", "=", 
                    RowBox[{"Last", "[", "min", "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "m0", "]"}], "==", 
                    RowBox[{"Last", "[", "m1", "]"}]}], "\[And]", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "m0", "]"}], "]"}], "+", "1"}], ",",
                     "P"}], "]"}], "==", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "m1", "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"m1", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "m0", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "m1", "]"}], "]"}], "+", "P"}]}], 
                    "}"}], ",", 
                    RowBox[{"Last", "[", "m1", "]"}]}], "}"}]}], ";", 
                    RowBox[{
                    RowBox[{"min", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "min", "]"}], "-", "1", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "=", "m1"}], ";", 
                    RowBox[{"min", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"min", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", "+", 
                    RowBox[{"(", "1", ")"}]}], "}"}]}], "]"}]}]}]}], 
                    "]"}]}]}], "]"}], ";", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "+", 
                    "\[CapitalDelta]x", "-", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "+", 
                    "\[CapitalDelta]x", "+", 
                    RowBox[{"1", "/", "2"}]}]}], "}"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"min", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"k0_", ",", "k1_"}], "}"}], ",", "y_"}], "}"}], "/;", 
                    RowBox[{"\[Not]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"k0", "-", "1"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ">", "y", "<", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"k1", "+", "1"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ")"}]}]}]}], 
                    "]"}]}], "]"}]}]}], "]"}]}]}], "]"}]}], ";", 
           RowBox[{"max", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"\[Not]", 
               RowBox[{"OptionValue", "[", "Maxima", "]"}]}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{
               RowBox[{"max", "=", 
                RowBox[{"Array", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"\[Not]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"#", "-", "1"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "<=", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ">=", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"#", "+", "1"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ")"}]}], ",", 
                    "Nothing", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#"}], "}"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "}"}]}], "]"}],
                    "&"}], ",", "P", ",", "0"}], "]"}]}], ";", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{"0", "==", 
                  RowBox[{"Length", "[", "max", "]"}]}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"1", "==", 
                  RowBox[{"Length", "[", "max", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"k", "=", 
                   RowBox[{"First", "[", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "max", "]"}], "]"}], "]"}]}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"\[Not]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"k", "-", "1"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "<", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ">", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "\[CapitalDelta]x", "-", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{"k", "+", "\[CapitalDelta]x", "+", 
                    RowBox[{"1", "/", "2"}]}]}], "}"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "}"}], "}"}]}],
                    "]"}]}], ",", "True", ",", 
                 RowBox[{
                  RowBox[{"m1", "=", 
                   RowBox[{"Last", "[", "max", "]"}]}], ";", 
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"k", "=", 
                    RowBox[{
                    RowBox[{"Length", "[", "max", "]"}], "-", "2"}]}], ",", 
                    RowBox[{"0", "<=", "k"}], ",", 
                    RowBox[{"k", "--"}], ",", 
                    RowBox[{
                    RowBox[{"m0", "=", 
                    RowBox[{"max", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "m0", "]"}], "!=", 
                    RowBox[{"Last", "[", "m1", "]"}]}], "\[Or]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "m0", "]"}], "]"}], "+", "1"}], "!=", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "m1", "]"}], "]"}]}]}], ",", 
                    RowBox[{"m1", "=", "m0"}], ",", 
                    RowBox[{
                    RowBox[{"m1", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "m0", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "m1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"Last", "[", "m1", "]"}]}], "}"}]}], ";", 
                    RowBox[{"max", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"max", ",", 
                    RowBox[{"{", 
                    RowBox[{"k", "+", "1", "+", 
                    RowBox[{"(", "1", ")"}]}], "}"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"max", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "=", "m1"}]}]}], 
                    "]"}]}]}], "]"}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"1", "<", 
                    RowBox[{"Length", "[", "max", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"m0", "=", 
                    RowBox[{"Last", "[", "max", "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "m0", "]"}], "==", 
                    RowBox[{"Last", "[", "m1", "]"}]}], "\[And]", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "m0", "]"}], "]"}], "+", "1"}], ",",
                     "P"}], "]"}], "==", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "m1", "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"m1", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "m0", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "m1", "]"}], "]"}], "+", "P"}]}], 
                    "}"}], ",", 
                    RowBox[{"Last", "[", "m1", "]"}]}], "}"}]}], ";", 
                    RowBox[{
                    RowBox[{"max", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "max", "]"}], "-", "1", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "=", "m1"}], ";", 
                    RowBox[{"max", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"max", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", "+", 
                    RowBox[{"(", "1", ")"}]}], "}"}]}], "]"}]}]}]}], 
                    "]"}]}]}], "]"}], ";", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "+", 
                    "\[CapitalDelta]x", "-", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "+", 
                    "\[CapitalDelta]x", "+", 
                    RowBox[{"1", "/", "2"}]}]}], "}"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"max", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"k0_", ",", "k1_"}], "}"}], ",", "y_"}], "}"}], "/;", 
                    RowBox[{"\[Not]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"k0", "-", "1"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "<", "y", ">", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"k1", "+", "1"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ")"}]}]}]}], 
                    "]"}]}], "]"}]}]}], "]"}]}]}], "]"}]}]}]}], "]"}], ";", 
        RowBox[{"Sort", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"min", ",", "max"}], "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[124]:=",ExpressionUUID->"0b32e802-feed-40c6-9d13-da6b78458d23"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FourierCoeffP\[Beta]", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", "\[Nu]_Integer"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], ",", 
       RowBox[{"P", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Sinc", "[", 
        RowBox[{"\[Pi]", " ", 
         RowBox[{"\[Nu]", "/", "P"}]}], "]"}], "^", 
       RowBox[{"(", 
        RowBox[{"n", "+", "1"}], ")"}]}], 
      RowBox[{
       RowBox[{"c", " ", ".", " ", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryJ]"}], " ", "\[Nu]", " ", "2", "\[Pi]", 
             " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[CapitalDelta]x", "+", "#"}], ")"}], "/", "P"}]}], 
            "]"}], "&"}], ",", "P", ",", "0"}], "]"}]}], "/", "P"}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[125]:=",ExpressionUUID->"a6561293-2117-4809-9929-f4cb06ec7db2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InvW\[Beta]", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"InvW\[Beta]", "[", "n", "]"}], "=", 
   RowBox[{"Inverse", "[", 
    RowBox[{"W\[Beta]", "[", "n", "]"}], "]"}]}]}]], "Input",
 CellLabel->
  "In[126]:=",ExpressionUUID->"00b36fc8-ce35-41c0-8d50-7d7b871ea584"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]LowerBoundP\[Beta]", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", 
     RowBox[{"n_Integer", "?", "NonNegative"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
       RowBox[{"m", "=", 
        RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], ",", 
       RowBox[{"P", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "==", "m"}], ",", "s", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"0", "==", "n"}], ",", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c0", ",", "q"}], "}"}], ",", 
           RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
            RowBox[{
             RowBox[{"Array", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"c0", "=", 
                   RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"m", "+", "1"}], ",", "#"}], "]"}], " ", ".", " ", 
                    RowBox[{"W\[Beta]", "[", "m", "]"}]}]}], ";", 
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"q", "=", "1"}], ",", 
                    RowBox[{"q", "<=", "m"}], ",", 
                    RowBox[{"q", "+=", "1"}], ",", 
                    RowBox[{
                    RowBox[{"c0", "[", 
                    RowBox[{"[", 
                    RowBox[{"0", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "+=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"c0", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "]"}]}]}], 
                   "]"}], ";", 
                  RowBox[{"c0", "[", 
                   RowBox[{"[", 
                    RowBox[{"0", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ")"}], "&"}], ",",
                "P", ",", "0"}], "]"}], ",", "0", ",", 
             RowBox[{"\[CapitalDelta]x", "+", 
              RowBox[{"m", "/", "2"}]}]}], "]"}]}], "]"}], ",", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Gamma]", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"\[Infinity]", ",", "P"}], "]"}]}], ",", "p", ",", 
             "c0", ",", "q"}], "}"}], ",", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"p", "=", "0"}], ",", 
              RowBox[{"p", "<", "P"}], ",", 
              RowBox[{"p", "+=", "1"}], ",", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"m", "<=", "n"}], ",", 
                 RowBox[{"c0", "=", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"m", "+", "1"}], ",", "p"}], "]"}], " ", ".", " ", 
                    RowBox[{"W\[Beta]", "[", "m", "]"}]}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"n", "-", "m"}]}], "]"}]}], "]"}], " ", ".", " ", 
                   
                   RowBox[{"InvW\[Beta]", "[", "n", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"c0", "=", 
                   RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"m", "+", "1"}], ",", "p"}], "]"}], " ", ".", " ", 
                    RowBox[{"W\[Beta]", "[", "m", "]"}]}]}], ";", 
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"q", "=", 
                    RowBox[{"n", "+", "1"}]}], ",", 
                    RowBox[{"q", "<=", "m"}], ",", 
                    RowBox[{"q", "+=", "1"}], ",", 
                    RowBox[{
                    RowBox[{"c0", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "+=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"c0", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "]"}]}]}], 
                   "]"}], ";", 
                  RowBox[{"c0", "=", 
                   RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{"c0", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], " ", ".", " ", 
                    RowBox[{"InvW\[Beta]", "[", "n", "]"}]}]}]}]}], "]"}], ";", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"q", "=", "0"}], ",", 
                 RowBox[{"q", "<=", "n"}], ",", 
                 RowBox[{"q", "+=", "1"}], ",", 
                 RowBox[{
                  RowBox[{"\[Gamma]", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"p", "+", "q"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "=", 
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{"\[Gamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"p", "+", "q"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", 
                    RowBox[{"c0", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "]"}]}]}], 
                "]"}]}]}], "]"}], ";", 
            RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
             RowBox[{"\[Gamma]", ",", "n", ",", 
              RowBox[{"\[CapitalDelta]x", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"m", "-", "n"}], ")"}], "/", "2"}]}]}], "]"}]}]}], 
          "]"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[127]:=",ExpressionUUID->"39063e5a-738a-469e-a601-02ebb4c079fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]UpperBoundP\[Beta]", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", 
     RowBox[{"n_Integer", "?", "NonNegative"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
       RowBox[{"m", "=", 
        RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], ",", 
       RowBox[{"P", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "==", "m"}], ",", "s", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"0", "==", "n"}], ",", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c0", ",", "q"}], "}"}], ",", 
           RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
            RowBox[{
             RowBox[{"Array", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"c0", "=", 
                   RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"m", "+", "1"}], ",", "#"}], "]"}], " ", ".", " ", 
                    RowBox[{"W\[Beta]", "[", "m", "]"}]}]}], ";", 
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"q", "=", "1"}], ",", 
                    RowBox[{"q", "<=", "m"}], ",", 
                    RowBox[{"q", "+=", "1"}], ",", 
                    RowBox[{
                    RowBox[{"c0", "[", 
                    RowBox[{"[", 
                    RowBox[{"0", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "+=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"c0", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "]"}]}]}], 
                   "]"}], ";", 
                  RowBox[{"c0", "[", 
                   RowBox[{"[", 
                    RowBox[{"0", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ")"}], "&"}], ",",
                "P", ",", "0"}], "]"}], ",", "0", ",", 
             RowBox[{"\[CapitalDelta]x", "+", 
              RowBox[{"m", "/", "2"}]}]}], "]"}]}], "]"}], ",", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Gamma]", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"-", "\[Infinity]"}], ",", "P"}], "]"}]}], ",", "p", ",",
              "c0", ",", "q"}], "}"}], ",", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"p", "=", "0"}], ",", 
              RowBox[{"p", "<", "P"}], ",", 
              RowBox[{"p", "+=", "1"}], ",", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"m", "<=", "n"}], ",", 
                 RowBox[{"c0", "=", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"m", "+", "1"}], ",", "p"}], "]"}], " ", ".", " ", 
                    RowBox[{"W\[Beta]", "[", "m", "]"}]}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"n", "-", "m"}]}], "]"}]}], "]"}], " ", ".", " ", 
                   
                   RowBox[{"InvW\[Beta]", "[", "n", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"c0", "=", 
                   RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"m", "+", "1"}], ",", "p"}], "]"}], " ", ".", " ", 
                    RowBox[{"W\[Beta]", "[", "m", "]"}]}]}], ";", 
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"q", "=", 
                    RowBox[{"n", "+", "1"}]}], ",", 
                    RowBox[{"q", "<=", "m"}], ",", 
                    RowBox[{"q", "+=", "1"}], ",", 
                    RowBox[{
                    RowBox[{"c0", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "+=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"c0", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "]"}]}]}], 
                   "]"}], ";", 
                  RowBox[{"c0", "=", 
                   RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{"c0", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], " ", ".", " ", 
                    RowBox[{"InvW\[Beta]", "[", "n", "]"}]}]}]}]}], "]"}], ";", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"q", "=", "0"}], ",", 
                 RowBox[{"q", "<=", "n"}], ",", 
                 RowBox[{"q", "+=", "1"}], ",", 
                 RowBox[{
                  RowBox[{"\[Gamma]", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"p", "+", "q"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "=", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{"\[Gamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"p", "+", "q"}], ",", "P"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", 
                    RowBox[{"c0", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "]"}]}]}], 
                "]"}]}]}], "]"}], ";", 
            RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
             RowBox[{"\[Gamma]", ",", "n", ",", 
              RowBox[{"\[CapitalDelta]x", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"m", "-", "n"}], ")"}], "/", "2"}]}]}], "]"}]}]}], 
          "]"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[128]:=",ExpressionUUID->"c2b316a9-bacc-4098-a92d-0c816e52268b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]WithFractionalDelay", "[", 
    RowBox[{"s_", "/;", 
     RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalDelta]x", "=", 
       RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], "}"}], ",", 
     RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
      RowBox[{
       RowBox[{"RotateRight", "[", 
        RowBox[{
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], ",", 
         RowBox[{"\[LeftFloor]", "\[CapitalDelta]x", "\[RightFloor]"}]}], 
        "]"}], ",", 
       RowBox[{"s", "[", "\"\<n\>\"", "]"}], ",", 
       RowBox[{"\[CapitalDelta]x", "-", 
        RowBox[{"\[LeftFloor]", "\[CapitalDelta]x", "\[RightFloor]"}]}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[129]:=",ExpressionUUID->"53c11faa-80bd-412d-bb08-248eff181744"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Delayed", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", "\[Tau]_"}], "]"}], ":=", 
   RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
    RowBox[{
     RowBox[{"s", "[", "\"\<c\>\"", "]"}], ",", 
     RowBox[{"s", "[", "\"\<n\>\"", "]"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "+", "\[Tau]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[130]:=",ExpressionUUID->"a772a9cb-3f2e-4e5c-b682-cd20320f0ec0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Reversed", "[", 
    RowBox[{"s_", "/;", 
     RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], "]"}], ":=", 
   RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"0", "+", 
           RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "}"}], ",", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"s", "[", "\"\<c\>\"", "]"}], ",", 
          RowBox[{"1", "-", 
           RowBox[{"Length", "[", 
            RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}]}], "]"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"s", "[", "\"\<n\>\"", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[131]:=",ExpressionUUID->"8ee0415c-4929-4b3b-b7ce-734566ebb56d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]PlusScalar", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", "c0_"}], "]"}], ":=", 
   RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
    RowBox[{
     RowBox[{"c0", "+", 
      RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
     RowBox[{"s", "[", "\"\<n\>\"", "]"}], ",", 
     RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[132]:=",ExpressionUUID->"a881951a-3fb8-4766-afba-2b0b56c016de"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Negated", "[", 
    RowBox[{"s_", "/;", 
     RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], "]"}], ":=", 
   RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
     RowBox[{"s", "[", "\"\<n\>\"", "]"}], ",", 
     RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[133]:=",ExpressionUUID->"74ed62ef-8f65-44c1-a94e-f26197dabe17"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]TimesScalar", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", "\[Lambda]_"}], "]"}], ":=", 
   RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
    RowBox[{
     RowBox[{"\[Lambda]", " ", 
      RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
     RowBox[{"s", "[", "\"\<n\>\"", "]"}], ",", 
     RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[134]:=",ExpressionUUID->"d3665081-9ef5-4402-ba2e-a9c0b8b04171"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Grad", "[", 
    RowBox[{"s_", "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"P\[Beta]Q", "[", "s", "]"}], "\[And]", 
       RowBox[{"1", "<=", 
        RowBox[{"DegreeP\[Beta]", "[", "s", "]"}]}]}], ")"}]}], "]"}], ":=", 
   RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
    RowBox[{
     RowBox[{"ListConvolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"s", "[", "\"\<c\>\"", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "\"\<n\>\"", "]"}], "-", "1"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "-", 
      RowBox[{"1", "/", "2"}]}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[135]:=",ExpressionUUID->"8a51c3d7-1f89-4551-ab6b-fc75772432a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]AntiGrad", "[", 
    RowBox[{"s_", "/;", 
     RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], "]"}], ":=", 
   RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
    RowBox[{
     RowBox[{"Accumulate", "[", 
      RowBox[{
       RowBox[{"s", "[", "\"\<c\>\"", "]"}], "-", 
       RowBox[{"MeanP\[Beta]", "[", "s", "]"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "\"\<n\>\"", "]"}], "+", "1"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "+", 
      RowBox[{"1", "/", "2"}]}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[136]:=",ExpressionUUID->"df691860-cb2b-4899-b3ce-79a63a665508"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Diff", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", 
     RowBox[{"m_Integer", "?", "NonNegative"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"s", "[", "\"\<n\>\"", "]"}], "<", "m"}], ",", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"P\[Beta]Diff", "[", 
       RowBox[{"s", ",", "m"}], "]"}], "]"}], ",", 
     RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
      RowBox[{
       RowBox[{"ListConvolve", "[", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "^", "#"}], " ", 
             RowBox[{"Binomial", "[", 
              RowBox[{"m", ",", "#"}], "]"}]}], "&"}], ",", 
           RowBox[{"m", "+", "1"}], ",", "0"}], "]"}], ",", 
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", "\"\<n\>\"", "]"}], "-", "m"}], ",", 
       RowBox[{
        RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "-", 
        RowBox[{"m", "/", "2"}]}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[137]:=",ExpressionUUID->"814eedaf-93bc-42a8-96ba-30e832560a00"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Projected", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n_Integer", "?", "NonNegative"}], ",", "\[CapitalDelta]x_"}], 
      "}"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "=", 
        RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
       RowBox[{"\[Delta]x", "=", 
        RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}]}], "}"}], ",", 
     RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
      RowBox[{
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"ListConvolve", "[", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Beta]", "[", 
               RowBox[{"#", ",", 
                RowBox[{"m", "+", "n", "+", "1"}]}], "]"}], "&"}], ",", 
             RowBox[{"m", "+", "n", "+", "2"}], ",", 
             RowBox[{"\[CapitalDelta]x", "-", "\[Delta]x", "-", 
              RowBox[{"\[LeftFloor]", 
               RowBox[{"\[CapitalDelta]x", "-", "\[Delta]x", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"m", "+", "n", "+", "2"}], ")"}], "/", "2"}]}], 
               "\[RightFloor]"}]}]}], "]"}], ",", 
           RowBox[{"PeriodicSamplesToCoeff\[Beta]", "[", 
            RowBox[{
             RowBox[{"s", "[", "\"\<c\>\"", "]"}], ",", 
             RowBox[{
              RowBox[{"2", "n"}], "+", "1"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{"\[LeftFloor]", 
          RowBox[{"\[CapitalDelta]x", "-", "\[Delta]x", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "n", "+", "2"}], ")"}], "/", "2"}]}], 
          "\[RightFloor]"}]}], "]"}], ",", "n", ",", "\[CapitalDelta]x"}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[138]:=",ExpressionUUID->"67165af5-04e6-4dcb-b381-7598c0cf5a9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]Upscaled", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", 
     RowBox[{"M_Integer", "?", "Positive"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], ",", 
       RowBox[{"P", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}], ",", 
       RowBox[{"H", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"H\[Beta]", "[", 
          RowBox[{"M", ",", 
           RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"1", "==", "M"}], ",", "s", ",", 
       RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"c", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{"p", ",", "P"}], "]"}], "+", 
                   RowBox[{"(", "1", ")"}]}], "]"}], "]"}], 
                RowBox[{
                 RowBox[{"H\[Beta]", "[", 
                  RowBox[{"M", ",", "n"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"#", "-", 
                   RowBox[{"M", " ", "p"}], "+", 
                   RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"p", ",", 
                 RowBox[{"\[LeftCeiling]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"#", "-", 
                    RowBox[{"(", 
                    RowBox[{"H", "-", "1"}], ")"}]}], ")"}], "/", "M"}], 
                  "\[RightCeiling]"}], ",", 
                 RowBox[{"\[LeftFloor]", 
                  RowBox[{"#", "/", "M"}], "\[RightFloor]"}]}], "}"}]}], 
              "]"}], "/", 
             RowBox[{"M", "^", "n"}]}], "&"}], ",", 
           RowBox[{"M", " ", "P"}], ",", "0"}], "]"}], ",", "n", ",", 
         RowBox[{
          RowBox[{"M", " ", "\[CapitalDelta]x"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"M", "-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "1"}], ")"}], "/", "2"}]}]}]}], "]"}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[139]:=",ExpressionUUID->"1bdb3cd6-2826-4e01-833e-5b320864312f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]UpscaledProjected", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", 
     RowBox[{"M_Integer", "?", "Positive"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n_Integer", "?", "NonNegative"}], ",", "\[CapitalDelta]x_"}], 
      "}"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"1", "==", "M"}], ",", 
     RowBox[{"P\[Beta]Projected", "[", 
      RowBox[{"s", ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "\[CapitalDelta]x"}], "}"}]}], "]"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c", "=", 
          RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
         RowBox[{"m", "=", 
          RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
         RowBox[{"\[Delta]x", "=", 
          RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}]}], "}"}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"K", "=", 
           RowBox[{"Length", "[", "c", "]"}]}], "}"}], ",", 
         RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
          RowBox[{
           RowBox[{"RotateLeft", "[", 
            RowBox[{
             RowBox[{"ListConvolve", "[", 
              RowBox[{
               RowBox[{"Array", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Beta]", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"m", "+", "n", "+", "1"}]}], "]"}], "&"}], ",", 
                 RowBox[{"m", "+", "n", "+", "3"}], ",", 
                 RowBox[{"\[CapitalDelta]x", "-", 
                  RowBox[{"M", " ", "\[Delta]x"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"M", "-", "1"}], ")"}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m", "+", "1"}], ")"}], "/", "2"}]}], "-", 
                  RowBox[{"\[LeftFloor]", 
                   RowBox[{"\[CapitalDelta]x", "-", 
                    RowBox[{"M", " ", "\[Delta]x"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"M", "-", "1"}], ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m", "+", "1"}], ")"}], "/", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m", "+", "n", "+", "2"}], ")"}], "/", "2"}]}], 
                   "\[RightFloor]"}]}]}], "]"}], ",", 
               RowBox[{"PeriodicSamplesToCoeff\[Beta]", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"M", "^", 
                    RowBox[{"-", "m"}]}], " ", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"H\[Beta]", "[", 
                    RowBox[{"M", ",", "m"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "-", 
                    RowBox[{"M", " ", "v"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], 
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"v", ",", "K"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"v", ",", 
                    RowBox[{"\[LeftCeiling]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"k", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"M", "-", "1"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "1"}], ")"}]}]}], ")"}], "/", "M"}], 
                    "\[RightCeiling]"}], ",", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"k", "/", "M"}], "\[RightFloor]"}]}], "}"}]}], 
                    "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"M", " ", "K"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"2", "n"}], "+", "1"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
             RowBox[{"\[LeftFloor]", 
              RowBox[{"\[CapitalDelta]x", "-", 
               RowBox[{"M", " ", "\[Delta]x"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"M", "-", "1"}], ")"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"m", "+", "1"}], ")"}], "/", "2"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"m", "+", "n", "+", "2"}], ")"}], "/", "2"}]}], 
              "\[RightFloor]"}]}], "]"}], ",", "n", ",", "\[CapitalDelta]x"}],
           "]"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[140]:=",ExpressionUUID->"2c625c3d-d662-4fee-8cc3-abd85749b4ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]DownscaledProjected", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", 
     RowBox[{"M_Integer", "?", "Positive"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n_Integer", "?", "NonNegative"}], ",", "\[CapitalDelta]x_"}], 
      "}"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"s", "[", "\"\<c\>\"", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"M", "/", 
             RowBox[{"GCD", "[", 
              RowBox[{"M", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}], "]"}]}], 
            "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"m", "=", 
        RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
       RowBox[{"\[Delta]x", "=", 
        RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"1", "==", "M"}], ",", 
       RowBox[{"P\[Beta]Projected", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "\[CapitalDelta]x"}], "}"}]}], "]"}], ",", 
       RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
        RowBox[{
         RowBox[{"PeriodicSamplesToCoeff\[Beta]", "[", 
          RowBox[{
           RowBox[{"Downsample", "[", 
            RowBox[{
             RowBox[{"RotateRight", "[", 
              RowBox[{
               RowBox[{"ListConvolve", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Beta]", "[", 
                    RowBox[{
                    RowBox[{"#", "+", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"\[Delta]x", "-", 
                    RowBox[{"M", " ", "\[CapitalDelta]x"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"M", "-", "1"}], ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m", "+", "n"}], ")"}], "/", "2"}]}], 
                    "\[RightFloor]"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"\[Delta]x", "-", 
                    RowBox[{"M", " ", "\[CapitalDelta]x"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"M", "-", "1"}], ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}]}]}], ")"}]}], ",", 
                    RowBox[{"m", "+", "n", "+", "1"}]}], "]"}], "&"}], ",", 
                   RowBox[{"m", "+", "n", "+", "2"}], ",", "0"}], "]"}], ",", 
                 
                 RowBox[{
                  RowBox[{"M", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "n"}], "-", "1"}], ")"}]}], " ", 
                  RowBox[{"ListConvolve", "[", 
                   RowBox[{
                    RowBox[{"H\[Beta]", "[", 
                    RowBox[{"M", ",", "n"}], "]"}], ",", "c", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
               RowBox[{"\[LeftFloor]", 
                RowBox[{"\[Delta]x", "-", 
                 RowBox[{"M", " ", "\[CapitalDelta]x"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"M", "-", "1"}], ")"}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", "+", "n"}], ")"}], "/", "2"}]}], 
                "\[RightFloor]"}]}], "]"}], ",", "M", ",", 
             RowBox[{"0", "+", 
              RowBox[{"(", "1", ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "1"}]}], "]"}], ",", "n", ",", 
         "\[CapitalDelta]x"}], "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[141]:=",ExpressionUUID->"0ec9cd10-b6c5-4b6e-b02b-2b51a4171498"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]RescaledProjected", "[", 
    RowBox[{
     RowBox[{"s_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s", "]"}]}], ",", 
     RowBox[{"P_Integer", "?", "Positive"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n_Integer", "?", "NonNegative"}], ",", "\[CapitalDelta]x_"}], 
      "}"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"s", "[", "\"\<c\>\"", "]"}]}], ",", 
       RowBox[{"m", "=", 
        RowBox[{"s", "[", "\"\<n\>\"", "]"}]}], ",", 
       RowBox[{"\[Delta]x", "=", 
        RowBox[{"s", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], ",", 
       RowBox[{"Q", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"s", "[", "\"\<c\>\"", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Q", "==", "P"}], ",", 
       RowBox[{"P\[Beta]Projected", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "\[CapitalDelta]x"}], "}"}]}], "]"}], ",", 
       RowBox[{"P\[Beta]DownscaledProjected", "[", 
        RowBox[{
         RowBox[{"P\[Beta]Upscaled", "[", 
          RowBox[{"s", ",", 
           RowBox[{"P", "/", 
            RowBox[{"GCD", "[", 
             RowBox[{"P", ",", "Q"}], "]"}]}]}], "]"}], ",", 
         RowBox[{"Q", "/", 
          RowBox[{"GCD", "[", 
           RowBox[{"P", ",", "Q"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "\[CapitalDelta]x"}], "}"}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[142]:=",ExpressionUUID->"17bd6c12-b24b-4cfe-943e-8c8ce96c344f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]PlusP\[Beta]", "[", 
    RowBox[{
     RowBox[{"s1_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s1", "]"}]}], ",", 
     RowBox[{"s2_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s2", "]"}]}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"s1", "[", "\"\<c\>\"", "]"}], "]"}], "!=", 
      RowBox[{"Length", "[", 
       RowBox[{
        RowBox[{"s2", "[", "\"\<c\>\"", "]"}], "\[Or]", 
        RowBox[{
         RowBox[{"s1", "[", "\"\<n\>\"", "]"}], "!=", 
         RowBox[{"s2", "[", "\"\<n\>\"", "]"}]}], "\[Or]", 
        RowBox[{
         RowBox[{"s1", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "!=", 
         RowBox[{"s2", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}]}], "]"}]}], ",", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"P\[Beta]PlusP\[Beta]", "[", 
       RowBox[{"s1", ",", "s2"}], "]"}], "]"}], ",", 
     RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"s1", "[", "\"\<c\>\"", "]"}], "+", 
        RowBox[{"s2", "[", "\"\<c\>\"", "]"}]}], ",", 
       RowBox[{"s1", "[", "\"\<n\>\"", "]"}], ",", 
       RowBox[{"s1", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[143]:=",ExpressionUUID->"9c9095e0-a413-4473-9e1d-2824a91c8e8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]PlusP\[Beta]Projected", "[", 
    RowBox[{
     RowBox[{"s1_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s1", "]"}]}], ",", 
     RowBox[{"s2_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s2", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n_Integer", "?", "NonNegative"}], ",", "\[CapitalDelta]x_"}], 
      "}"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"s1", "[", "\"\<c\>\"", "]"}], "]"}], "!=", 
      RowBox[{"Length", "[", 
       RowBox[{"s2", "[", "\"\<c\>\"", "]"}], "]"}]}], ",", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"P\[Beta]PlusP\[Beta]Projected", "[", 
       RowBox[{"s1", ",", "s2", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "\[CapitalDelta]x"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"P\[Beta]Projected", "[", 
          RowBox[{"s1", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "\[CapitalDelta]x"}], "}"}]}], "]"}], 
         "[", "\"\<c\>\"", "]"}], "+", 
        RowBox[{
         RowBox[{"P\[Beta]Projected", "[", 
          RowBox[{"s2", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "\[CapitalDelta]x"}], "}"}]}], "]"}], 
         "[", "\"\<c\>\"", "]"}]}], ",", "n", ",", "\[CapitalDelta]x"}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[144]:=",ExpressionUUID->"88c33ac2-c879-4346-8a55-b034dc0f1189"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]ConvolveP\[Beta]", "[", 
    RowBox[{
     RowBox[{"s1_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s1", "]"}]}], ",", 
     RowBox[{"s2_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s2", "]"}]}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"s1", "[", "\"\<c\>\"", "]"}], "]"}], "!=", 
      RowBox[{"Length", "[", 
       RowBox[{"s2", "[", "\"\<c\>\"", "]"}], "]"}]}], ",", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"P\[Beta]ConvolveP\[Beta]", "[", 
       RowBox[{"s1", ",", "s2"}], "]"}], "]"}], ",", 
     RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
      RowBox[{
       RowBox[{"ListConvolve", "[", 
        RowBox[{
         RowBox[{"s1", "[", "\"\<c\>\"", "]"}], ",", 
         RowBox[{"s2", "[", "\"\<c\>\"", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"s1", "[", "\"\<n\>\"", "]"}], "+", 
        RowBox[{"s2", "[", "\"\<n\>\"", "]"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"s1", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "+", 
        RowBox[{"s2", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[145]:=",ExpressionUUID->"b655e821-94e5-40b9-8f1f-bfc9e5b3a558"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]NormedCrossCorrP\[Beta]", "[", 
    RowBox[{
     RowBox[{"s1_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s1", "]"}]}], ",", 
     RowBox[{"s2_", "/;", 
      RowBox[{"P\[Beta]Q", "[", "s2", "]"}]}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"s1", "[", "\"\<c\>\"", "]"}], "]"}], "!=", 
      RowBox[{"Length", "[", 
       RowBox[{
        RowBox[{"s2", "[", "\"\<c\>\"", "]"}], "\[Or]", 
        RowBox[{"0", "==", 
         RowBox[{"Chop", "[", 
          RowBox[{"VarianceP\[Beta]", "[", "s1", "]"}], "]"}]}], "\[Or]", 
        RowBox[{"0", "==", 
         RowBox[{"Chop", "[", 
          RowBox[{"VarianceP\[Beta]", "[", "s2", "]"}], "]"}]}]}], "]"}]}], ",", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"P\[Beta]NormedCrossCorrP\[Beta]", "[", 
       RowBox[{"s1", ",", "s2"}], "]"}], "]"}], ",", 
     RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListCorrelate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s1", "[", "\"\<c\>\"", "]"}], "-", 
           RowBox[{"Mean", "[", 
            RowBox[{"s1", "[", "\"\<c\>\"", "]"}], "]"}]}], ",", 
          RowBox[{"s2", "[", "\"\<c\>\"", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"s1", "[", "\"\<c\>\"", "]"}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"VarianceP\[Beta]", "[", "s1", "]"}], 
            RowBox[{"VarianceP\[Beta]", "[", "s2", "]"}]}], "]"}]}], ")"}]}], 
       ",", 
       RowBox[{
        RowBox[{"s1", "[", "\"\<n\>\"", "]"}], "+", 
        RowBox[{"s2", "[", "\"\<n\>\"", "]"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"s2", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "-", 
        RowBox[{"s1", "[", "\"\<\[CapitalDelta]x\>\"", "]"}]}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[146]:=",ExpressionUUID->"08b7f9c4-d51d-48f8-b9f0-df98d5714a0f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Title",
 CellChangeTimes->{{3.958727269039544*^9, 3.95872726953959*^9}, {
  3.958728224991064*^9, 
  3.958728232565131*^9}},ExpressionUUID->"954b0036-432b-4ba4-b5f9-\
6108df398f42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "from_samples", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"f", "=", 
                 RowBox[{"RandomVariate", "[", 
                  RowBox[{
                   RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                  "]"}]}], ",", 
                RowBox[{"delay", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], ",", 
                    RowBox[{"-", "0.5"}], ",", "0.0", ",", "0.5", ",", 
                    "1.0"}], "}"}], ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}], ",", 
                    "3"}], "]"}]}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{"CForm", ",", "f"}], "]"}], ",", 
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ps", "=", 
                    RowBox[{"P\[Beta]FromSamples", "[", 
                    RowBox[{"f", ",", "n", ",", 
                    RowBox[{"Delay", "->", 
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", 
                    RowBox[{"Regularized", "->", "regularized"}]}], "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{
                    RowBox[{"ps", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "//",
                     "CForm"}], ",", " ", "regularized", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"ps", "[", "\"\<c\>\"", "]"}]}], "]"}]}], "}"}]}],
                     "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"regularized", ",", 
                    RowBox[{"{", 
                    RowBox[{"False", ",", "True"}], "}"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"d", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "delay", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}], ",", "1"}], "]"}]}], "}"}]}], "]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "9"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.938586359547517*^9, {3.938586397583316*^9, 3.938586398841621*^9}, {
   3.9385864458842077`*^9, 3.938586447193768*^9}, {3.938586488709961*^9, 
   3.9385865906077337`*^9}, {3.938586662000264*^9, 3.938586714848836*^9}, {
   3.938586753402912*^9, 3.9385869231002493`*^9}, {3.9385869966720877`*^9, 
   3.938587049105826*^9}, {3.9385873163299923`*^9, 3.938587348904435*^9}, {
   3.9385874352857018`*^9, 3.9385874721013727`*^9}, {3.938587566837228*^9, 
   3.938587571841302*^9}, {3.9569007618222427`*^9, 3.956900776027605*^9}, 
   3.956900816249206*^9, {3.956901124463397*^9, 3.956901276766511*^9}, {
   3.956901328515028*^9, 3.956901340465918*^9}, {3.9600160601449413`*^9, 
   3.9600160633821507`*^9}, {3.9600161259221783`*^9, 
   3.9600162473988457`*^9}, {3.96001631397302*^9, 3.960016374419465*^9}, {
   3.960016416178966*^9, 3.960016500915917*^9}, {3.960016565708789*^9, 
   3.96001659234052*^9}, {3.960016646927198*^9, 3.9600167111648607`*^9}, {
   3.960016931539708*^9, 3.960016931902403*^9}, {3.960017006668791*^9, 
   3.960017028199914*^9}, {3.960017147742866*^9, 3.960017148126548*^9}, {
   3.960017224522367*^9, 3.96001722462997*^9}, {3.960017640292343*^9, 
   3.9600176417523746`*^9}, {3.9600180037102547`*^9, 3.960018026377084*^9}, {
   3.960018130649789*^9, 3.960018181769369*^9}, {3.9600182452634897`*^9, 
   3.960018303801558*^9}, {3.960018350108754*^9, 3.960018350560236*^9}, 
   3.961049202875475*^9, {3.96104948289468*^9, 3.961049491773293*^9}, {
   3.961049538870125*^9, 3.9610496827291803`*^9}, {3.96104972889664*^9, 
   3.961049834414349*^9}, {3.961049881024974*^9, 3.9610499100586023`*^9}, {
   3.961049975539424*^9, 3.9610500226846333`*^9}, {3.961050271000372*^9, 
   3.961050273917872*^9}, 3.961050315098806*^9, {3.9610505915873537`*^9, 
   3.96105062124012*^9}, {3.961050673777708*^9, 3.961050722111554*^9}, {
   3.961050789268351*^9, 3.961050789869947*^9}, {3.961050836563994*^9, 
   3.9610508368335047`*^9}, {3.961050987879705*^9, 3.961050988041172*^9}, {
   3.961051025512784*^9, 3.961051044695527*^9}, {3.961051163676936*^9, 
   3.961051167108152*^9}, {3.961051295777504*^9, 3.961051295949915*^9}, {
   3.961051348061645*^9, 3.961051350260594*^9}, {3.96105142506476*^9, 
   3.96105142865031*^9}, {3.961051529643632*^9, 3.9610515306002693`*^9}, {
   3.9610516372363777`*^9, 3.9610516381487637`*^9}, {3.9610519439879417`*^9, 
   3.9610519597453833`*^9}, {3.961052009179163*^9, 3.961052013817349*^9}, {
   3.9610521734874477`*^9, 3.9610521773430977`*^9}, {3.961052218241638*^9, 
   3.9610522409539137`*^9}, {3.96105239662568*^9, 3.961052429963388*^9}, {
   3.9610524723376417`*^9, 3.961052472509528*^9}, {3.961052647216442*^9, 
   3.961052647334168*^9}, {3.96105334981843*^9, 3.961053350051495*^9}, {
   3.963472730687182*^9, 3.9634727369601088`*^9}, {3.963487741218994*^9, 
   3.96348774141636*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"2581f01d-f2c7-4273-8781-bb6f575d63a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "add", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c1", "=", 
                 RowBox[{"RandomVariate", "[", 
                  RowBox[{
                   RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                  "]"}]}], ",", 
                RowBox[{"c2", "=", 
                 RowBox[{"RandomVariate", "[", 
                  RowBox[{
                   RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                  "]"}]}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\[CapitalDelta]x", "=", 
                  RowBox[{"RandomVariate", "[", 
                   RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ps1", "=", 
                    RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                    RowBox[{"c1", ",", "n", ",", "\[CapitalDelta]x"}], 
                    "]"}]}], ",", 
                    RowBox[{"ps2", "=", 
                    RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                    RowBox[{"c2", ",", "n", ",", "\[CapitalDelta]x"}], 
                    "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"n", ",", 
                    RowBox[{"\[CapitalDelta]x", "//", "CForm"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"ps1", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"ps2", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{
                    RowBox[{"P\[Beta]PlusP\[Beta]", "[", 
                    RowBox[{"ps1", ",", "ps2"}], "]"}], "[", "\"\<c\>\"", 
                    "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "9"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054083925015*^9}, {
  3.9611429595185423`*^9, 3.9611430911847563`*^9}, {3.961143136053296*^9, 
  3.961143200334854*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"069ca011-7061-45a4-84e6-b39b47819de2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "add_projected", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"K", "=", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "9"}], "}"}], "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"c1", "=", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                    "]"}]}], ",", 
                  RowBox[{"c2", "=", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                    "]"}]}], ",", 
                  RowBox[{"n1", "=", 
                   RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "9"}], "}"}], "]"}]}], ",", 
                  RowBox[{"n2", "=", 
                   RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "9"}], "}"}], "]"}]}], ",", 
                  RowBox[{"\[CapitalDelta]x1", "=", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], ",", 
                  RowBox[{"\[CapitalDelta]x2", "=", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}]}], 
                 "}"}], ",", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ps1", "=", 
                    RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                    RowBox[{"c1", ",", "n1", ",", "\[CapitalDelta]x1"}], 
                    "]"}]}], ",", 
                    RowBox[{"ps2", "=", 
                    RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                    RowBox[{"c2", ",", "n2", ",", "\[CapitalDelta]x2"}], 
                    "]"}]}], ",", 
                    RowBox[{"n", "=", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "9"}], "}"}], "]"}]}], ",", 
                    RowBox[{"\[CapitalDelta]x", "=", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}]}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"n1", ",", 
                    RowBox[{"\[CapitalDelta]x1", "//", "CForm"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"ps1", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", 
                    "n2", ",", 
                    RowBox[{"\[CapitalDelta]x2", "//", "CForm"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"ps2", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", "n",
                     ",", 
                    RowBox[{"\[CapitalDelta]x", "//", "CForm"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{
                    RowBox[{"P\[Beta]PlusP\[Beta]Projected", "[", 
                    RowBox[{"ps1", ",", "ps2", ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "\[CapitalDelta]x"}], "}"}]}], "]"}], 
                    "[", "\"\<c\>\"", "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
               "]"}]}], "]"}], ",", 
            RowBox[{"{", "50", "}"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"#1", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "<", 
          RowBox[{"Length", "[", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054099586877*^9}, {
  3.961145846836437*^9, 3.961146091383429*^9}, {3.9611461995909157`*^9, 
  3.961146269751882*^9}, {3.961146345419763*^9, 3.961146356528326*^9}, {
  3.961146507954507*^9, 3.961146581104735*^9}, {3.961146664768634*^9, 
  3.961146668274047*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"3ed3b5e1-377b-44b6-bedc-34c290afdb23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "convolve", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"K", "=", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "9"}], "}"}], "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"c1", "=", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                    "]"}]}], ",", 
                  RowBox[{"c2", "=", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                    "]"}]}], ",", 
                  RowBox[{"n1", "=", 
                   RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "9"}], "}"}], "]"}]}], ",", 
                  RowBox[{"n2", "=", 
                   RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "9"}], "}"}], "]"}]}], ",", 
                  RowBox[{"\[CapitalDelta]x1", "=", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], ",", 
                  RowBox[{"\[CapitalDelta]x2", "=", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}]}], 
                 "}"}], ",", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ps1", "=", 
                    RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                    RowBox[{"c1", ",", "n1", ",", "\[CapitalDelta]x1"}], 
                    "]"}]}], ",", 
                    RowBox[{"ps2", "=", 
                    RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                    RowBox[{"c2", ",", "n2", ",", "\[CapitalDelta]x2"}], 
                    "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"n1", ",", 
                    RowBox[{"\[CapitalDelta]x1", "//", "CForm"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"ps1", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", 
                    "n2", ",", 
                    RowBox[{"\[CapitalDelta]x2", "//", "CForm"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"ps2", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"P\[Beta]ConvolveP\[Beta]", "[", 
                    RowBox[{"ps1", ",", "ps2"}], "]"}], "[", "\"\<n\>\"", 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P\[Beta]ConvolveP\[Beta]", "[", 
                    RowBox[{"ps1", ",", "ps2"}], "]"}], 
                    "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "//", "CForm"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{
                    RowBox[{"P\[Beta]ConvolveP\[Beta]", "[", 
                    RowBox[{"ps1", ",", "ps2"}], "]"}], "[", "\"\<c\>\"", 
                    "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", "50", "}"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"#1", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "<", 
          RowBox[{"Length", "[", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.96105411037613*^9}, {
   3.961148125518626*^9, 3.961148194956613*^9}, {3.961148255369215*^9, 
   3.961148268986122*^9}, 3.961148661709567*^9},
 CellLabel->
  "In[150]:=",ExpressionUUID->"5760652a-d17d-4920-b336-7469a4a4fd6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"normed_cross", "_correlate"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"K", "=", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "9"}], "}"}], "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"c1", "=", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                    "]"}]}], ",", 
                  RowBox[{"c2", "=", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                    "]"}]}], ",", 
                  RowBox[{"n1", "=", 
                   RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "9"}], "}"}], "]"}]}], ",", 
                  RowBox[{"n2", "=", 
                   RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "9"}], "}"}], "]"}]}], ",", 
                  RowBox[{"\[CapitalDelta]x1", "=", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], ",", 
                  RowBox[{"\[CapitalDelta]x2", "=", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}]}], 
                 "}"}], ",", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ps1", "=", 
                    RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                    RowBox[{"c1", ",", "n1", ",", "\[CapitalDelta]x1"}], 
                    "]"}]}], ",", 
                    RowBox[{"ps2", "=", 
                    RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                    RowBox[{"c2", ",", "n2", ",", "\[CapitalDelta]x2"}], 
                    "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"n1", ",", 
                    RowBox[{"\[CapitalDelta]x1", "//", "CForm"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"ps1", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", 
                    "n2", ",", 
                    RowBox[{"\[CapitalDelta]x2", "//", "CForm"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"ps2", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"P\[Beta]NormedCrossCorrP\[Beta]", "[", 
                    RowBox[{"ps1", ",", "ps2"}], "]"}], "[", "\"\<n\>\"", 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P\[Beta]NormedCrossCorrP\[Beta]", "[", 
                    RowBox[{"ps1", ",", "ps2"}], "]"}], 
                    "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "//", "CForm"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{
                    RowBox[{"P\[Beta]NormedCrossCorrP\[Beta]", "[", 
                    RowBox[{"ps1", ",", "ps2"}], "]"}], "[", "\"\<c\>\"", 
                    "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", "50", "}"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"#1", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "<", 
          RowBox[{"Length", "[", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054123122272*^9}, {
  3.961149879338423*^9, 3.961149880341063*^9}, {3.961150262339088*^9, 
  3.961150262855672*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"9b4ace9b-a8bd-4744-955e-baf8e1a5518a"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"eval_piecewise", "_signs", "_at"}], " ", "*)"}]], "Input",
 CellChangeTimes->{3.9610540592602663`*^9},
 CellLabel->
  "In[152]:=",ExpressionUUID->"a8212efb-152f-49c0-ad13-37ff7144bdc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"eval_piecewise", "_polynomials", "_at"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c", "=", 
                 RowBox[{"RandomVariate", "[", 
                  RowBox[{
                   RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                  "]"}]}], ",", 
                RowBox[{"x", "=", 
                 RowBox[{"RandomVariate", "[", 
                  RowBox[{
                   RowBox[{"NormalDistribution", "[", 
                    RowBox[{
                    RowBox[{"K", "/", "2"}], ",", "K"}], "]"}], ",", 
                   RowBox[{"{", "10", "}"}]}], "]"}]}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ps", "=", 
                  RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                   RowBox[{"c", ",", "n", ",", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", 
                  RowBox[{
                   RowBox[{"ps", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "//",
                    "CForm"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"CForm", ",", 
                    RowBox[{"ps", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"CForm", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], "}"}]}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"CForm", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"ps", ",", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], "}"}]}], 
                    "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "9"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
   3.961054181837019*^9, 3.961054182027688*^9}, {3.9614776200830383`*^9, 
   3.961477647018631*^9}, {3.961477677790538*^9, 3.961477744965514*^9}, {
   3.961477809595974*^9, 3.961477833279187*^9}, 3.9629439725975227`*^9},
 CellLabel->
  "In[153]:=",ExpressionUUID->"a7d645bc-6711-4ac5-b49a-9604939da996"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "copy", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"c", "=", 
                RowBox[{"RandomVariate", "[", 
                 RowBox[{
                  RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ps", "=", 
                  RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                   RowBox[{"c", ",", "n", ",", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", 
                  RowBox[{
                   RowBox[{"ps", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "//",
                    "CForm"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"CForm", ",", 
                    RowBox[{"ps", "[", "\"\<c\>\"", "]"}]}], "]"}]}], "}"}]}],
                "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "9"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054133636127*^9}, {
  3.961056309617811*^9, 3.96105644800625*^9}, {3.961056509280901*^9, 
  3.961056559829113*^9}, {3.961056663216219*^9, 3.9610566993090878`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"28f4c7d0-ed4b-431b-9b88-23c97f55fdf6"],

Cell[BoxData[
 RowBox[{"(*", " ", "plot", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.962347839506572*^9, 3.962348061464519*^9}, {3.962348095360512*^9, 
  3.962348157264997*^9}, {3.9623482025206833`*^9, 3.96234820316108*^9}, {
  3.962348235435267*^9, 3.962348315628166*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"3089e7ba-08a4-48bc-9d40-76b3c797bcdc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"get_knots", " ", 
    RowBox[{"(", "empty", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"delay", "=", 
                RowBox[{"Sort", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], ",", 
                    RowBox[{"-", "0.5"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], " ", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "20"}]]}], ",", "0.0", ",", "0.5", ",", 
                    "1.0"}], "}"}], ",", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "K"}], "]"}], ",", "5"}], "]"}]}], 
                  "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"K", ",", "n", ",", 
                  RowBox[{
                   RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                  ",", 
                  RowBox[{"{", "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "0", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "delay", "]"}], "-", "1"}]}], 
                 "}"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", "2"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054170314952*^9}, {
  3.9623477647089367`*^9, 3.962347776469133*^9}, {3.962348319858796*^9, 
  3.9623483211087627`*^9}, {3.962348372313335*^9, 3.9623483723369293`*^9}, {
  3.9623485586551647`*^9, 3.962348559047635*^9}, {3.962348644203158*^9, 
  3.9623486458407516`*^9}, {3.9623487180396423`*^9, 3.962348727103162*^9}, {
  3.9623508098083467`*^9, 3.9623508201756897`*^9}, {3.962351068287421*^9, 
  3.962351072230425*^9}, {3.962355539478919*^9, 3.96235555338984*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"84339a99-8d0c-49be-b01a-4a09ea2295dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"get_knots", " ", 
    RowBox[{"(", "rr", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"delay", "=", 
                RowBox[{"Sort", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], ",", 
                    RowBox[{"-", "0.5"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], " ", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "20"}]]}], ",", "0.0", ",", "0.5", ",", 
                    "1.0"}], "}"}], ",", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "K"}], "]"}], ",", "5"}], "]"}]}], 
                  "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"K", ",", "n", ",", 
                  RowBox[{
                   RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"CForm", ",", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"q", "+", 
                    FractionBox[
                    RowBox[{"n", "+", "1"}], "2"], "+", 
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", "K"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "0", ",", 
                    RowBox[{"K", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "0", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "delay", "]"}], "-", "1"}]}], 
                 "}"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", "2"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054170314952*^9}, {
   3.9623477647089367`*^9, 3.962347776469133*^9}, {3.962348319858796*^9, 
   3.9623483211087627`*^9}, {3.962348372313335*^9, 3.9623483723369293`*^9}, {
   3.9623485586551647`*^9, 3.962348559047635*^9}, {3.962348644203158*^9, 
   3.9623486458407516`*^9}, {3.9623487180396423`*^9, 3.962348727103162*^9}, {
   3.962348913612862*^9, 3.9623489137632093`*^9}, {3.96234896677816*^9, 
   3.962349040205056*^9}, {3.9623491606215153`*^9, 3.962349231717909*^9}, {
   3.9623492636737556`*^9, 3.962349337160964*^9}, {3.9623493833982077`*^9, 
   3.9623494495440807`*^9}, {3.962349482857666*^9, 3.9623494943148127`*^9}, 
   3.962351151951836*^9, 3.962355560154784*^9},
 CellLabel->
  "In[157]:=",ExpressionUUID->"8153b54b-aeed-42e9-ab2c-995155421705"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"get_knots", " ", 
    RowBox[{"(", "singleton", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"delay", "=", 
                RowBox[{"Sort", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], ",", 
                    RowBox[{"-", "0.5"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], " ", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "20"}]]}], ",", "0.0", ",", "0.5", ",", 
                    "1.0"}], "}"}], ",", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "K"}], "]"}], ",", "3"}], "]"}]}], 
                  "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"value", "=", 
                  RowBox[{"Sort", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RandomChoice", "[", "delay", "]"}], ",", 
                    RowBox[{
                    RowBox[{"RandomChoice", "[", "delay", "]"}], "+", 
                    "0.5"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "K"}], "]"}], "]"}], "}"}]}], "]"}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"K", ",", "n", ",", 
                    RowBox[{
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"value", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"n", "+", "1"}], "2"], "+", 
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", "1"}], 
                    "]"}], "==", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"value", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"value", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "delay", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"q", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "value", "]"}], "-", "1"}]}], 
                   "}"}]}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", "3"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054170314952*^9}, {
   3.9623477647089367`*^9, 3.962347776469133*^9}, {3.962348319858796*^9, 
   3.9623483211087627`*^9}, {3.962348372313335*^9, 3.9623483723369293`*^9}, {
   3.9623485586551647`*^9, 3.962348559047635*^9}, {3.962348644203158*^9, 
   3.9623486458407516`*^9}, {3.9623487180396423`*^9, 3.962348727103162*^9}, {
   3.962348913612862*^9, 3.9623489137632093`*^9}, {3.96234896677816*^9, 
   3.962349040205056*^9}, {3.9623491606215153`*^9, 3.962349231717909*^9}, {
   3.9623492636737556`*^9, 3.962349337160964*^9}, {3.9623493833982077`*^9, 
   3.9623494495440807`*^9}, {3.962349482857666*^9, 3.9623494943148127`*^9}, 
   3.962351151951836*^9, {3.9623513188737993`*^9, 3.9623513219489737`*^9}, {
   3.96235154352682*^9, 3.962351564757039*^9}, {3.962351599248597*^9, 
   3.9623516071915627`*^9}, {3.962351658007269*^9, 3.9623517292397327`*^9}, {
   3.962352181230133*^9, 3.9623523759365263`*^9}, {3.962352414536833*^9, 
   3.962352414865902*^9}, {3.962352493266745*^9, 3.9623525256195993`*^9}, {
   3.962352826305458*^9, 3.962352831148333*^9}, 3.962355563124457*^9, 
   3.962356862895228*^9, {3.962357066851893*^9, 3.962357067361401*^9}, {
   3.962357115454898*^9, 3.962357115759159*^9}, {3.962357182962981*^9, 
   3.96235721255658*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"eb1e2129-c5ba-4d23-b234-9bcb3a8287be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"get_knots", " ", 
    RowBox[{"(", "above", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"delay", "=", 
                RowBox[{"Sort", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], ",", 
                    RowBox[{"-", "0.5"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], " ", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "20"}]]}], ",", "0.0", ",", "0.5", ",", 
                    "1.0"}], "}"}], ",", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "K"}], "]"}], ",", "3"}], "]"}]}], 
                  "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"threshold", "=", 
                  RowBox[{"Sort", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RandomChoice", "[", "delay", "]"}], ",", 
                    RowBox[{
                    RowBox[{"RandomChoice", "[", "delay", "]"}], "+", 
                    "0.5"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "K"}], "]"}], "]"}], "}"}]}], "]"}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"K", ",", "n", ",", 
                    RowBox[{
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r0", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"n", "+", "1"}], "2"], "+", 
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", "1"}], 
                    "]"}]}], ",", 
                    RowBox[{"k1", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"1.0", "==", 
                    RowBox[{"Last", "[", 
                    RowBox[{"QuotientRemainder", "[", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "+", "1"}]}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"p", "+", "r0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"k1", "-", "1"}], ",", 
                    RowBox[{"k1", "+", "1", "+", "K", "-", "1"}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", ">", 
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "&"}]}], "]"}],
                     ",", "K"}], "]"}]}], "]"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "delay", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"q", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "threshold", "]"}], "-", "1"}]}], 
                   "}"}]}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", "3"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054170314952*^9}, {
   3.9623477647089367`*^9, 3.962347776469133*^9}, {3.962348319858796*^9, 
   3.9623483211087627`*^9}, {3.962348372313335*^9, 3.9623483723369293`*^9}, {
   3.9623485586551647`*^9, 3.962348559047635*^9}, {3.962348644203158*^9, 
   3.9623486458407516`*^9}, {3.9623487180396423`*^9, 3.962348727103162*^9}, {
   3.962348913612862*^9, 3.9623489137632093`*^9}, {3.96234896677816*^9, 
   3.962349040205056*^9}, {3.9623491606215153`*^9, 3.962349231717909*^9}, {
   3.9623492636737556`*^9, 3.962349337160964*^9}, {3.9623493833982077`*^9, 
   3.9623494495440807`*^9}, {3.962349482857666*^9, 3.9623494943148127`*^9}, 
   3.962351151951836*^9, {3.9623513188737993`*^9, 3.9623513219489737`*^9}, {
   3.96235154352682*^9, 3.962351564757039*^9}, {3.962351599248597*^9, 
   3.9623516071915627`*^9}, {3.962351658007269*^9, 3.9623517292397327`*^9}, {
   3.962352181230133*^9, 3.9623523759365263`*^9}, {3.962352414536833*^9, 
   3.962352414865902*^9}, {3.962352493266745*^9, 3.9623525256195993`*^9}, {
   3.962352826305458*^9, 3.962352831148333*^9}, 3.962355563124457*^9, 
   3.962356862895228*^9, {3.962357066851893*^9, 3.962357067361401*^9}, {
   3.962357115454898*^9, 3.962357115759159*^9}, {3.962357182962981*^9, 
   3.96235721255658*^9}, {3.962357433889847*^9, 3.9623574347295837`*^9}, {
   3.9623576054583607`*^9, 3.962357623629521*^9}, {3.962357703411824*^9, 
   3.9623577645055227`*^9}, {3.962357918502344*^9, 3.962357995288438*^9}, {
   3.962358182533257*^9, 3.962358182724842*^9}, {3.962358224237322*^9, 
   3.9623583396916523`*^9}, {3.962358370926631*^9, 3.9623584223174067`*^9}, {
   3.962358511051978*^9, 3.962358538856943*^9}, {3.9623587187624407`*^9, 
   3.962358724375073*^9}, {3.962359222443474*^9, 3.962359229223056*^9}, {
   3.962359288925465*^9, 3.9623592912408867`*^9}, {3.962359508991498*^9, 
   3.962359515626862*^9}, {3.962359550467607*^9, 3.9623595707943287`*^9}, {
   3.962359602221654*^9, 3.962359650026079*^9}, {3.962360066333911*^9, 
   3.9623600730995913`*^9}, 3.962360840849679*^9, {3.962360877583147*^9, 
   3.962360877973412*^9}, {3.96236272114599*^9, 3.962362740038806*^9}, {
   3.962362811539177*^9, 3.9623628594769487`*^9}, {3.962362896173156*^9, 
   3.9623629013543577`*^9}, {3.962425725312258*^9, 3.962425808125032*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"8fdf0d42-49b1-4c76-9cca-9bf7eb279763"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"get_knots", " ", 
    RowBox[{"(", 
     RowBox[{"not", " ", "below"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"delay", "=", 
                RowBox[{"Sort", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], ",", 
                    RowBox[{"-", "0.5"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], " ", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "20"}]]}], ",", "0.0", ",", "0.5", ",", 
                    "1.0"}], "}"}], ",", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "K"}], "]"}], ",", "3"}], "]"}]}], 
                  "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"threshold", "=", 
                  RowBox[{"Sort", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RandomChoice", "[", "delay", "]"}], ",", 
                    RowBox[{
                    RowBox[{"RandomChoice", "[", "delay", "]"}], "+", 
                    "0.5"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "K"}], "]"}], "]"}], "}"}]}], "]"}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"K", ",", "n", ",", 
                    RowBox[{
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r0", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"n", "+", "1"}], "2"], "+", 
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", "1"}], 
                    "]"}]}], ",", 
                    RowBox[{"k1", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"1.0", "==", 
                    RowBox[{"Last", "[", 
                    RowBox[{"QuotientRemainder", "[", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "+", "1"}]}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"p", "+", "r0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"k1", "-", "1"}], ",", 
                    RowBox[{"k1", "+", "1", "+", "K", "-", "1"}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", ">=", 
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "&"}]}], "]"}],
                     ",", "K"}], "]"}]}], "]"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "delay", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"q", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "threshold", "]"}], "-", "1"}]}], 
                   "}"}]}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", "3"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054170314952*^9}, {
   3.9623477647089367`*^9, 3.962347776469133*^9}, {3.962348319858796*^9, 
   3.9623483211087627`*^9}, {3.962348372313335*^9, 3.9623483723369293`*^9}, {
   3.9623485586551647`*^9, 3.962348559047635*^9}, {3.962348644203158*^9, 
   3.9623486458407516`*^9}, {3.9623487180396423`*^9, 3.962348727103162*^9}, {
   3.962348913612862*^9, 3.9623489137632093`*^9}, {3.96234896677816*^9, 
   3.962349040205056*^9}, {3.9623491606215153`*^9, 3.962349231717909*^9}, {
   3.9623492636737556`*^9, 3.962349337160964*^9}, {3.9623493833982077`*^9, 
   3.9623494495440807`*^9}, {3.962349482857666*^9, 3.9623494943148127`*^9}, 
   3.962351151951836*^9, {3.9623513188737993`*^9, 3.9623513219489737`*^9}, {
   3.96235154352682*^9, 3.962351564757039*^9}, {3.962351599248597*^9, 
   3.9623516071915627`*^9}, {3.962351658007269*^9, 3.9623517292397327`*^9}, {
   3.962352181230133*^9, 3.9623523759365263`*^9}, {3.962352414536833*^9, 
   3.962352414865902*^9}, {3.962352493266745*^9, 3.9623525256195993`*^9}, {
   3.962352826305458*^9, 3.962352831148333*^9}, 3.962355563124457*^9, 
   3.962356862895228*^9, {3.962357066851893*^9, 3.962357067361401*^9}, {
   3.962357115454898*^9, 3.962357115759159*^9}, {3.962357182962981*^9, 
   3.96235721255658*^9}, {3.962357433889847*^9, 3.9623574347295837`*^9}, {
   3.9623576054583607`*^9, 3.962357623629521*^9}, {3.962357703411824*^9, 
   3.9623577645055227`*^9}, {3.962357918502344*^9, 3.962357995288438*^9}, {
   3.962358182533257*^9, 3.962358182724842*^9}, {3.962358224237322*^9, 
   3.9623583396916523`*^9}, {3.962358370926631*^9, 3.9623584223174067`*^9}, {
   3.962358511051978*^9, 3.962358538856943*^9}, {3.9623587187624407`*^9, 
   3.962358724375073*^9}, {3.962359222443474*^9, 3.962359229223056*^9}, {
   3.962359288925465*^9, 3.9623592912408867`*^9}, {3.962359508991498*^9, 
   3.962359515626862*^9}, {3.962359550467607*^9, 3.9623595707943287`*^9}, {
   3.962359602221654*^9, 3.962359650026079*^9}, {3.962360066333911*^9, 
   3.9623600730995913`*^9}, 3.962360840849679*^9, {3.962360877583147*^9, 
   3.962360877973412*^9}, {3.96236272114599*^9, 3.962362740038806*^9}, {
   3.962362811539177*^9, 3.9623628594769487`*^9}, {3.962362896173156*^9, 
   3.9623629013543577`*^9}, {3.962363655260401*^9, 3.962363656860825*^9}, {
   3.962363767727437*^9, 3.9623637726375732`*^9}, 3.962425979427586*^9},
 CellLabel->
  "In[160]:=",ExpressionUUID->"9073b9ac-0dfe-4203-8e93-c990c93c2968"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"get_knots", " ", 
    RowBox[{"(", 
     RowBox[{"not", " ", "above"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"delay", "=", 
                RowBox[{"Sort", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], ",", 
                    RowBox[{"-", "0.5"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], " ", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "20"}]]}], ",", "0.0", ",", "0.5", ",", 
                    "1.0"}], "}"}], ",", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "K"}], "]"}], ",", "3"}], "]"}]}], 
                  "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"threshold", "=", 
                  RowBox[{"Sort", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RandomChoice", "[", "delay", "]"}], ",", 
                    RowBox[{
                    RowBox[{"RandomChoice", "[", "delay", "]"}], "+", 
                    "0.5"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "K"}], "]"}], "]"}], "}"}]}], "]"}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"K", ",", "n", ",", 
                    RowBox[{
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r0", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"n", "+", "1"}], "2"], "+", 
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", "1"}], 
                    "]"}]}], ",", 
                    RowBox[{"k1", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"1.0", "==", 
                    RowBox[{"Last", "[", 
                    RowBox[{"QuotientRemainder", "[", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "+", "1"}]}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"p", "+", "r0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"k1", "-", "K", "-", "1"}], ",", 
                    RowBox[{"k1", "+", "1", "-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "<=", 
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "&"}]}], "]"}],
                     ",", 
                    RowBox[{"-", "K"}]}], "]"}]}], "]"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "delay", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"q", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "threshold", "]"}], "-", "1"}]}], 
                   "}"}]}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", "3"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054170314952*^9}, {
   3.9623477647089367`*^9, 3.962347776469133*^9}, {3.962348319858796*^9, 
   3.9623483211087627`*^9}, {3.962348372313335*^9, 3.9623483723369293`*^9}, {
   3.9623485586551647`*^9, 3.962348559047635*^9}, {3.962348644203158*^9, 
   3.9623486458407516`*^9}, {3.9623487180396423`*^9, 3.962348727103162*^9}, {
   3.962348913612862*^9, 3.9623489137632093`*^9}, {3.96234896677816*^9, 
   3.962349040205056*^9}, {3.9623491606215153`*^9, 3.962349231717909*^9}, {
   3.9623492636737556`*^9, 3.962349337160964*^9}, {3.9623493833982077`*^9, 
   3.9623494495440807`*^9}, {3.962349482857666*^9, 3.9623494943148127`*^9}, 
   3.962351151951836*^9, {3.9623513188737993`*^9, 3.9623513219489737`*^9}, {
   3.96235154352682*^9, 3.962351564757039*^9}, {3.962351599248597*^9, 
   3.9623516071915627`*^9}, {3.962351658007269*^9, 3.9623517292397327`*^9}, {
   3.962352181230133*^9, 3.9623523759365263`*^9}, {3.962352414536833*^9, 
   3.962352414865902*^9}, {3.962352493266745*^9, 3.9623525256195993`*^9}, {
   3.962352826305458*^9, 3.962352831148333*^9}, 3.962355563124457*^9, 
   3.962356862895228*^9, {3.962357066851893*^9, 3.962357067361401*^9}, {
   3.962357115454898*^9, 3.962357115759159*^9}, {3.962357182962981*^9, 
   3.96235721255658*^9}, {3.962357433889847*^9, 3.9623574347295837`*^9}, {
   3.9623576054583607`*^9, 3.962357623629521*^9}, {3.962357703411824*^9, 
   3.9623577645055227`*^9}, {3.962357918502344*^9, 3.962357995288438*^9}, {
   3.962358182533257*^9, 3.962358182724842*^9}, {3.962358224237322*^9, 
   3.9623583396916523`*^9}, {3.962358370926631*^9, 3.9623584223174067`*^9}, {
   3.962358511051978*^9, 3.962358538856943*^9}, {3.9623587187624407`*^9, 
   3.962358724375073*^9}, {3.962359222443474*^9, 3.962359229223056*^9}, {
   3.962359288925465*^9, 3.9623592912408867`*^9}, {3.962359508991498*^9, 
   3.962359515626862*^9}, {3.962359550467607*^9, 3.9623595707943287`*^9}, {
   3.962359602221654*^9, 3.962359650026079*^9}, {3.962360066333911*^9, 
   3.9623600730995913`*^9}, 3.962360840849679*^9, {3.962360877583147*^9, 
   3.962360877973412*^9}, {3.96236272114599*^9, 3.962362740038806*^9}, {
   3.962362811539177*^9, 3.9623628594769487`*^9}, {3.962362896173156*^9, 
   3.9623629013543577`*^9}, {3.962363655260401*^9, 3.962363656860825*^9}, {
   3.962363767727437*^9, 3.9623637726375732`*^9}, {3.9623639590226192`*^9, 
   3.9623640193822727`*^9}, {3.962364160035239*^9, 3.962364178737124*^9}, {
   3.9623642274106197`*^9, 3.962364230511304*^9}, 3.962364290248021*^9, 
   3.962426072893141*^9},
 CellLabel->
  "In[161]:=",ExpressionUUID->"26a3bde6-9876-48ca-bc6f-3fd4b87af5ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"get_knots", " ", 
    RowBox[{"(", "below", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"delay", "=", 
                RowBox[{"Sort", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], ",", 
                    RowBox[{"-", "0.5"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], " ", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "20"}]]}], ",", "0.0", ",", "0.5", ",", 
                    "1.0"}], "}"}], ",", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "K"}], "]"}], ",", "3"}], "]"}]}], 
                  "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"threshold", "=", 
                  RowBox[{"Sort", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RandomChoice", "[", "delay", "]"}], ",", 
                    RowBox[{
                    RowBox[{"RandomChoice", "[", "delay", "]"}], "+", 
                    "0.5"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "K"}], "]"}], "]"}], "}"}]}], "]"}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"K", ",", "n", ",", 
                    RowBox[{
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r0", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"n", "+", "1"}], "2"], "+", 
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", "1"}], 
                    "]"}]}], ",", 
                    RowBox[{"k1", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"1.0", "==", 
                    RowBox[{"Last", "[", 
                    RowBox[{"QuotientRemainder", "[", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "+", "1"}]}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"p", "+", "r0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"k1", "-", "K", "-", "1"}], ",", 
                    RowBox[{"k1", "+", "1", "-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "<", 
                    RowBox[{"threshold", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "&"}]}], "]"}],
                     ",", 
                    RowBox[{"-", "K"}]}], "]"}]}], "]"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "delay", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"q", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "threshold", "]"}], "-", "1"}]}], 
                   "}"}]}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", "3"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054170314952*^9}, {
   3.9623477647089367`*^9, 3.962347776469133*^9}, {3.962348319858796*^9, 
   3.9623483211087627`*^9}, {3.962348372313335*^9, 3.9623483723369293`*^9}, {
   3.9623485586551647`*^9, 3.962348559047635*^9}, {3.962348644203158*^9, 
   3.9623486458407516`*^9}, {3.9623487180396423`*^9, 3.962348727103162*^9}, {
   3.962348913612862*^9, 3.9623489137632093`*^9}, {3.96234896677816*^9, 
   3.962349040205056*^9}, {3.9623491606215153`*^9, 3.962349231717909*^9}, {
   3.9623492636737556`*^9, 3.962349337160964*^9}, {3.9623493833982077`*^9, 
   3.9623494495440807`*^9}, {3.962349482857666*^9, 3.9623494943148127`*^9}, 
   3.962351151951836*^9, {3.9623513188737993`*^9, 3.9623513219489737`*^9}, {
   3.96235154352682*^9, 3.962351564757039*^9}, {3.962351599248597*^9, 
   3.9623516071915627`*^9}, {3.962351658007269*^9, 3.9623517292397327`*^9}, {
   3.962352181230133*^9, 3.9623523759365263`*^9}, {3.962352414536833*^9, 
   3.962352414865902*^9}, {3.962352493266745*^9, 3.9623525256195993`*^9}, {
   3.962352826305458*^9, 3.962352831148333*^9}, 3.962355563124457*^9, 
   3.962356862895228*^9, {3.962357066851893*^9, 3.962357067361401*^9}, {
   3.962357115454898*^9, 3.962357115759159*^9}, {3.962357182962981*^9, 
   3.96235721255658*^9}, {3.962357433889847*^9, 3.9623574347295837`*^9}, {
   3.9623576054583607`*^9, 3.962357623629521*^9}, {3.962357703411824*^9, 
   3.9623577645055227`*^9}, {3.962357918502344*^9, 3.962357995288438*^9}, {
   3.962358182533257*^9, 3.962358182724842*^9}, {3.962358224237322*^9, 
   3.9623583396916523`*^9}, {3.962358370926631*^9, 3.9623584223174067`*^9}, {
   3.962358511051978*^9, 3.962358538856943*^9}, {3.9623587187624407`*^9, 
   3.962358724375073*^9}, {3.962359222443474*^9, 3.962359229223056*^9}, {
   3.962359288925465*^9, 3.9623592912408867`*^9}, {3.962359508991498*^9, 
   3.962359515626862*^9}, {3.962359550467607*^9, 3.9623595707943287`*^9}, {
   3.962359602221654*^9, 3.962359650026079*^9}, {3.962360066333911*^9, 
   3.9623600730995913`*^9}, 3.962360840849679*^9, {3.962360877583147*^9, 
   3.962360877973412*^9}, {3.96236272114599*^9, 3.962362740038806*^9}, {
   3.962362811539177*^9, 3.9623628594769487`*^9}, {3.962362896173156*^9, 
   3.9623629013543577`*^9}, {3.962363655260401*^9, 3.962363656860825*^9}, {
   3.962363767727437*^9, 3.9623637726375732`*^9}, {3.9623639590226192`*^9, 
   3.9623640193822727`*^9}, {3.962364160035239*^9, 3.962364178737124*^9}, {
   3.9623642274106197`*^9, 3.962364230511304*^9}, 3.962364290248021*^9, {
   3.962364808464881*^9, 3.962364817524431*^9}, 3.962426147642407*^9},
 CellLabel->
  "In[162]:=",ExpressionUUID->"20bf59f1-f8b3-4dd8-be60-d3cd0b60ebc3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"get_knots", " ", 
    RowBox[{"(", "open", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"delay", "=", 
                RowBox[{"Sort", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5.0"}], ",", 
                    RowBox[{"-", "2.5"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], " ", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "20"}]]}], ",", "0.0", ",", "2.5", ",", 
                    "5.0"}], "}"}], ",", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"2", "K"}], "+", "3"}]}], "]"}], ",", "3"}], 
                    "]"}]}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x0", "=", 
                   RowBox[{"RandomChoice", "[", "delay", "]"}]}], ",", 
                  RowBox[{"x1", "=", 
                   RowBox[{"RandomChoice", "[", "delay", "]"}]}]}], "}"}], ",", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"ivls", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"x0", "+", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "4"}], "}"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "x1"}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x1", "-", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "4"}], "}"}], "]"}]}], ",", "x1"}], 
                    "}"}]}], "}"}]}], "}"}], ",", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"infimum", "=", 
                    RowBox[{"First", "[", 
                    RowBox[{"Transpose", "[", "ivls", "]"}], "]"}]}], ",", 
                    RowBox[{"supremum", "=", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Transpose", "[", "ivls", "]"}], "]"}]}]}], "}"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"K", ",", "n", ",", 
                    RowBox[{
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r0", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"n", "+", "1"}], "2"], "+", 
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", "1"}], 
                    "]"}]}], ",", 
                    RowBox[{"k1", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"1.0", "==", 
                    RowBox[{"Last", "[", 
                    RowBox[{"QuotientRemainder", "[", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "+", "1"}]}], "]"}]}], ",", 
                    RowBox[{"k2", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"1.0", "==", 
                    RowBox[{"Last", "[", 
                    RowBox[{"QuotientRemainder", "[", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "+", "1"}]}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"p", "+", "r0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"k1", "-", "1"}], ",", 
                    RowBox[{"k2", "+", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "<", "#", "<", 
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "&"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "delay", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "infimum", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", "3"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054170314952*^9}, {
   3.9623477647089367`*^9, 3.962347776469133*^9}, {3.962348319858796*^9, 
   3.9623483211087627`*^9}, {3.962348372313335*^9, 3.9623483723369293`*^9}, {
   3.9623485586551647`*^9, 3.962348559047635*^9}, {3.962348644203158*^9, 
   3.9623486458407516`*^9}, {3.9623487180396423`*^9, 3.962348727103162*^9}, {
   3.962348913612862*^9, 3.9623489137632093`*^9}, {3.96234896677816*^9, 
   3.962349040205056*^9}, {3.9623491606215153`*^9, 3.962349231717909*^9}, {
   3.9623492636737556`*^9, 3.962349337160964*^9}, {3.9623493833982077`*^9, 
   3.9623494495440807`*^9}, {3.962349482857666*^9, 3.9623494943148127`*^9}, 
   3.962351151951836*^9, {3.9623513188737993`*^9, 3.9623513219489737`*^9}, {
   3.96235154352682*^9, 3.962351564757039*^9}, {3.962351599248597*^9, 
   3.9623516071915627`*^9}, {3.962351658007269*^9, 3.9623517292397327`*^9}, {
   3.962352181230133*^9, 3.9623523759365263`*^9}, {3.962352414536833*^9, 
   3.962352414865902*^9}, {3.962352493266745*^9, 3.9623525256195993`*^9}, {
   3.962352826305458*^9, 3.962352831148333*^9}, 3.962355563124457*^9, 
   3.962356862895228*^9, {3.962357066851893*^9, 3.962357067361401*^9}, {
   3.962357115454898*^9, 3.962357115759159*^9}, {3.962357182962981*^9, 
   3.96235721255658*^9}, {3.962357433889847*^9, 3.9623574347295837`*^9}, {
   3.9623576054583607`*^9, 3.962357623629521*^9}, {3.962357703411824*^9, 
   3.9623577645055227`*^9}, {3.962357918502344*^9, 3.962357995288438*^9}, {
   3.962358182533257*^9, 3.962358182724842*^9}, {3.962358224237322*^9, 
   3.9623583396916523`*^9}, {3.962358370926631*^9, 3.9623584223174067`*^9}, {
   3.962358511051978*^9, 3.962358538856943*^9}, {3.9623587187624407`*^9, 
   3.962358724375073*^9}, {3.962359222443474*^9, 3.962359229223056*^9}, {
   3.962359288925465*^9, 3.9623592912408867`*^9}, {3.962359508991498*^9, 
   3.962359515626862*^9}, {3.962359550467607*^9, 3.9623595707943287`*^9}, {
   3.962359602221654*^9, 3.962359650026079*^9}, {3.962360066333911*^9, 
   3.9623600730995913`*^9}, 3.962360840849679*^9, {3.962360877583147*^9, 
   3.962360877973412*^9}, {3.96236272114599*^9, 3.962362740038806*^9}, {
   3.962362811539177*^9, 3.9623628594769487`*^9}, {3.962362896173156*^9, 
   3.9623629013543577`*^9}, {3.962363655260401*^9, 3.962363656860825*^9}, {
   3.962363767727437*^9, 3.9623637726375732`*^9}, {3.9623639590226192`*^9, 
   3.9623640193822727`*^9}, {3.962364160035239*^9, 3.962364178737124*^9}, {
   3.9623642274106197`*^9, 3.962364230511304*^9}, 3.962364290248021*^9, {
   3.962364808464881*^9, 3.962364817524431*^9}, 3.962426147642407*^9, {
   3.962438372663904*^9, 3.962438373259302*^9}, {3.962438407847021*^9, 
   3.9624385322477903`*^9}, {3.9624385624718237`*^9, 3.962438714755397*^9}, {
   3.9624388084187098`*^9, 3.962438826463006*^9}, {3.962438887186236*^9, 
   3.962438919215822*^9}, {3.962439012546267*^9, 3.962439027247019*^9}, {
   3.9624391088660097`*^9, 3.962439119391173*^9}, {3.9624391678627443`*^9, 
   3.962439184943118*^9}, {3.9624392794803267`*^9, 3.9624392795528173`*^9}, {
   3.962439327864129*^9, 3.962439348304047*^9}, {3.962439439696598*^9, 
   3.9624394503777027`*^9}, {3.962439507966275*^9, 3.9624395107907*^9}, {
   3.9624395588409033`*^9, 3.96243961638484*^9}, {3.96243995438046*^9, 
   3.9624399629811974`*^9}, {3.962440005992629*^9, 3.9624400245312634`*^9}, {
   3.962440069437626*^9, 3.962440143996728*^9}, {3.9624402543403254`*^9, 
   3.9624403484007673`*^9}, {3.9624406089982967`*^9, 3.962440613541856*^9}, {
   3.9624406482042627`*^9, 3.962440758148974*^9}, {3.962440791399558*^9, 
   3.96244086915904*^9}, {3.962440905406135*^9, 3.9624409065735273`*^9}, {
   3.962440937502144*^9, 3.9624409665408583`*^9}, {3.962441000582218*^9, 
   3.96244103225193*^9}, {3.962441062369279*^9, 3.962441127694521*^9}, {
   3.9624411680410852`*^9, 3.96244119801544*^9}, {3.962441234835354*^9, 
   3.96244127172757*^9}, {3.962441375133854*^9, 3.962441380862623*^9}, {
   3.962441420766223*^9, 3.962441431589295*^9}, {3.962441612147234*^9, 
   3.962441614049913*^9}, {3.9624421655069027`*^9, 3.962442166824139*^9}, {
   3.962442204219625*^9, 3.9624422400542793`*^9}, 3.962442318070972*^9, 
   3.9624423716984863`*^9, {3.96244243195374*^9, 3.962442472075303*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"a099bbc7-712e-4b90-aa90-2abaed6a9325"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"get_knots", " ", 
    RowBox[{"(", "open_closed", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"delay", "=", 
                RowBox[{"Sort", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5.0"}], ",", 
                    RowBox[{"-", "2.5"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], " ", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "20"}]]}], ",", "0.0", ",", "2.5", ",", 
                    "5.0"}], "}"}], ",", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"2", "K"}], "+", "3"}]}], "]"}], ",", "3"}], 
                    "]"}]}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x0", "=", 
                   RowBox[{"RandomChoice", "[", "delay", "]"}]}], ",", 
                  RowBox[{"x1", "=", 
                   RowBox[{"RandomChoice", "[", "delay", "]"}]}]}], "}"}], ",", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"ivls", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"x0", "+", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "4"}], "}"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "x1"}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x1", "-", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "4"}], "}"}], "]"}]}], ",", "x1"}], 
                    "}"}]}], "}"}]}], "}"}], ",", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"infimum", "=", 
                    RowBox[{"First", "[", 
                    RowBox[{"Transpose", "[", "ivls", "]"}], "]"}]}], ",", 
                    RowBox[{"supremum", "=", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Transpose", "[", "ivls", "]"}], "]"}]}]}], "}"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"K", ",", "n", ",", 
                    RowBox[{
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r0", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"n", "+", "1"}], "2"], "+", 
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", "1"}], 
                    "]"}]}], ",", 
                    RowBox[{"k1", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"1.0", "==", 
                    RowBox[{"Last", "[", 
                    RowBox[{"QuotientRemainder", "[", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "+", "1"}]}], "]"}]}], ",", 
                    RowBox[{"k2", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"1.0", "==", 
                    RowBox[{"Last", "[", 
                    RowBox[{"QuotientRemainder", "[", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "+", "1"}]}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"p", "+", "r0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"k1", "-", "1"}], ",", 
                    RowBox[{"k2", "+", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "<", "#", "<=", 
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "&"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "delay", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "infimum", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", "3"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054170314952*^9}, {
   3.9623477647089367`*^9, 3.962347776469133*^9}, {3.962348319858796*^9, 
   3.9623483211087627`*^9}, {3.962348372313335*^9, 3.9623483723369293`*^9}, {
   3.9623485586551647`*^9, 3.962348559047635*^9}, {3.962348644203158*^9, 
   3.9623486458407516`*^9}, {3.9623487180396423`*^9, 3.962348727103162*^9}, {
   3.962348913612862*^9, 3.9623489137632093`*^9}, {3.96234896677816*^9, 
   3.962349040205056*^9}, {3.9623491606215153`*^9, 3.962349231717909*^9}, {
   3.9623492636737556`*^9, 3.962349337160964*^9}, {3.9623493833982077`*^9, 
   3.9623494495440807`*^9}, {3.962349482857666*^9, 3.9623494943148127`*^9}, 
   3.962351151951836*^9, {3.9623513188737993`*^9, 3.9623513219489737`*^9}, {
   3.96235154352682*^9, 3.962351564757039*^9}, {3.962351599248597*^9, 
   3.9623516071915627`*^9}, {3.962351658007269*^9, 3.9623517292397327`*^9}, {
   3.962352181230133*^9, 3.9623523759365263`*^9}, {3.962352414536833*^9, 
   3.962352414865902*^9}, {3.962352493266745*^9, 3.9623525256195993`*^9}, {
   3.962352826305458*^9, 3.962352831148333*^9}, 3.962355563124457*^9, 
   3.962356862895228*^9, {3.962357066851893*^9, 3.962357067361401*^9}, {
   3.962357115454898*^9, 3.962357115759159*^9}, {3.962357182962981*^9, 
   3.96235721255658*^9}, {3.962357433889847*^9, 3.9623574347295837`*^9}, {
   3.9623576054583607`*^9, 3.962357623629521*^9}, {3.962357703411824*^9, 
   3.9623577645055227`*^9}, {3.962357918502344*^9, 3.962357995288438*^9}, {
   3.962358182533257*^9, 3.962358182724842*^9}, {3.962358224237322*^9, 
   3.9623583396916523`*^9}, {3.962358370926631*^9, 3.9623584223174067`*^9}, {
   3.962358511051978*^9, 3.962358538856943*^9}, {3.9623587187624407`*^9, 
   3.962358724375073*^9}, {3.962359222443474*^9, 3.962359229223056*^9}, {
   3.962359288925465*^9, 3.9623592912408867`*^9}, {3.962359508991498*^9, 
   3.962359515626862*^9}, {3.962359550467607*^9, 3.9623595707943287`*^9}, {
   3.962359602221654*^9, 3.962359650026079*^9}, {3.962360066333911*^9, 
   3.9623600730995913`*^9}, 3.962360840849679*^9, {3.962360877583147*^9, 
   3.962360877973412*^9}, {3.96236272114599*^9, 3.962362740038806*^9}, {
   3.962362811539177*^9, 3.9623628594769487`*^9}, {3.962362896173156*^9, 
   3.9623629013543577`*^9}, {3.962363655260401*^9, 3.962363656860825*^9}, {
   3.962363767727437*^9, 3.9623637726375732`*^9}, {3.9623639590226192`*^9, 
   3.9623640193822727`*^9}, {3.962364160035239*^9, 3.962364178737124*^9}, {
   3.9623642274106197`*^9, 3.962364230511304*^9}, 3.962364290248021*^9, {
   3.962364808464881*^9, 3.962364817524431*^9}, 3.962426147642407*^9, {
   3.962438372663904*^9, 3.962438373259302*^9}, {3.962438407847021*^9, 
   3.9624385322477903`*^9}, {3.9624385624718237`*^9, 3.962438714755397*^9}, {
   3.9624388084187098`*^9, 3.962438826463006*^9}, {3.962438887186236*^9, 
   3.962438919215822*^9}, {3.962439012546267*^9, 3.962439027247019*^9}, {
   3.9624391088660097`*^9, 3.962439119391173*^9}, {3.9624391678627443`*^9, 
   3.962439184943118*^9}, {3.9624392794803267`*^9, 3.9624392795528173`*^9}, {
   3.962439327864129*^9, 3.962439348304047*^9}, {3.962439439696598*^9, 
   3.9624394503777027`*^9}, {3.962439507966275*^9, 3.9624395107907*^9}, {
   3.9624395588409033`*^9, 3.96243961638484*^9}, {3.96243995438046*^9, 
   3.9624399629811974`*^9}, {3.962440005992629*^9, 3.9624400245312634`*^9}, {
   3.962440069437626*^9, 3.962440143996728*^9}, {3.9624402543403254`*^9, 
   3.9624403484007673`*^9}, {3.9624406089982967`*^9, 3.962440613541856*^9}, {
   3.9624406482042627`*^9, 3.962440758148974*^9}, {3.962440791399558*^9, 
   3.96244086915904*^9}, {3.962440905406135*^9, 3.9624409065735273`*^9}, {
   3.962440937502144*^9, 3.9624409665408583`*^9}, {3.962441000582218*^9, 
   3.96244103225193*^9}, {3.962441062369279*^9, 3.962441127694521*^9}, {
   3.9624411680410852`*^9, 3.96244119801544*^9}, {3.962441234835354*^9, 
   3.96244127172757*^9}, {3.962441375133854*^9, 3.962441380862623*^9}, {
   3.962441420766223*^9, 3.962441431589295*^9}, {3.962441612147234*^9, 
   3.962441614049913*^9}, {3.9624421655069027`*^9, 3.962442166824139*^9}, {
   3.962442204219625*^9, 3.9624422400542793`*^9}, 3.962442318070972*^9, 
   3.9624423716984863`*^9, {3.96244243195374*^9, 3.962442472075303*^9}, {
   3.962443447023613*^9, 3.962443460083794*^9}, {3.96244359644271*^9, 
   3.962443596824712*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"de993606-906e-45e0-82f8-8d76a9019a2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"get_knots", " ", 
    RowBox[{"(", "closed", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"delay", "=", 
                RowBox[{"Sort", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5.0"}], ",", 
                    RowBox[{"-", "2.5"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], " ", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "20"}]]}], ",", "0.0", ",", "2.5", ",", 
                    "5.0"}], "}"}], ",", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"2", "K"}], "+", "3"}]}], "]"}], ",", "3"}], 
                    "]"}]}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x0", "=", 
                   RowBox[{"RandomChoice", "[", "delay", "]"}]}], ",", 
                  RowBox[{"x1", "=", 
                   RowBox[{"RandomChoice", "[", "delay", "]"}]}]}], "}"}], ",", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"ivls", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"x0", "+", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "4"}], "}"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "x1"}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x1", "-", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "4"}], "}"}], "]"}]}], ",", "x1"}], 
                    "}"}]}], "}"}]}], "}"}], ",", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"infimum", "=", 
                    RowBox[{"First", "[", 
                    RowBox[{"Transpose", "[", "ivls", "]"}], "]"}]}], ",", 
                    RowBox[{"supremum", "=", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Transpose", "[", "ivls", "]"}], "]"}]}]}], "}"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"K", ",", "n", ",", 
                    RowBox[{
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r0", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"n", "+", "1"}], "2"], "+", 
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", "1"}], 
                    "]"}]}], ",", 
                    RowBox[{"k1", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"1.0", "==", 
                    RowBox[{"Last", "[", 
                    RowBox[{"QuotientRemainder", "[", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "+", "1"}]}], "]"}]}], ",", 
                    RowBox[{"k2", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"1.0", "==", 
                    RowBox[{"Last", "[", 
                    RowBox[{"QuotientRemainder", "[", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "+", "1"}]}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"p", "+", "r0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"k1", "-", "1"}], ",", 
                    RowBox[{"k2", "+", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "<=", "#", "<=", 
                    
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "&"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "delay", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "infimum", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", "3"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054170314952*^9}, {
   3.9623477647089367`*^9, 3.962347776469133*^9}, {3.962348319858796*^9, 
   3.9623483211087627`*^9}, {3.962348372313335*^9, 3.9623483723369293`*^9}, {
   3.9623485586551647`*^9, 3.962348559047635*^9}, {3.962348644203158*^9, 
   3.9623486458407516`*^9}, {3.9623487180396423`*^9, 3.962348727103162*^9}, {
   3.962348913612862*^9, 3.9623489137632093`*^9}, {3.96234896677816*^9, 
   3.962349040205056*^9}, {3.9623491606215153`*^9, 3.962349231717909*^9}, {
   3.9623492636737556`*^9, 3.962349337160964*^9}, {3.9623493833982077`*^9, 
   3.9623494495440807`*^9}, {3.962349482857666*^9, 3.9623494943148127`*^9}, 
   3.962351151951836*^9, {3.9623513188737993`*^9, 3.9623513219489737`*^9}, {
   3.96235154352682*^9, 3.962351564757039*^9}, {3.962351599248597*^9, 
   3.9623516071915627`*^9}, {3.962351658007269*^9, 3.9623517292397327`*^9}, {
   3.962352181230133*^9, 3.9623523759365263`*^9}, {3.962352414536833*^9, 
   3.962352414865902*^9}, {3.962352493266745*^9, 3.9623525256195993`*^9}, {
   3.962352826305458*^9, 3.962352831148333*^9}, 3.962355563124457*^9, 
   3.962356862895228*^9, {3.962357066851893*^9, 3.962357067361401*^9}, {
   3.962357115454898*^9, 3.962357115759159*^9}, {3.962357182962981*^9, 
   3.96235721255658*^9}, {3.962357433889847*^9, 3.9623574347295837`*^9}, {
   3.9623576054583607`*^9, 3.962357623629521*^9}, {3.962357703411824*^9, 
   3.9623577645055227`*^9}, {3.962357918502344*^9, 3.962357995288438*^9}, {
   3.962358182533257*^9, 3.962358182724842*^9}, {3.962358224237322*^9, 
   3.9623583396916523`*^9}, {3.962358370926631*^9, 3.9623584223174067`*^9}, {
   3.962358511051978*^9, 3.962358538856943*^9}, {3.9623587187624407`*^9, 
   3.962358724375073*^9}, {3.962359222443474*^9, 3.962359229223056*^9}, {
   3.962359288925465*^9, 3.9623592912408867`*^9}, {3.962359508991498*^9, 
   3.962359515626862*^9}, {3.962359550467607*^9, 3.9623595707943287`*^9}, {
   3.962359602221654*^9, 3.962359650026079*^9}, {3.962360066333911*^9, 
   3.9623600730995913`*^9}, 3.962360840849679*^9, {3.962360877583147*^9, 
   3.962360877973412*^9}, {3.96236272114599*^9, 3.962362740038806*^9}, {
   3.962362811539177*^9, 3.9623628594769487`*^9}, {3.962362896173156*^9, 
   3.9623629013543577`*^9}, {3.962363655260401*^9, 3.962363656860825*^9}, {
   3.962363767727437*^9, 3.9623637726375732`*^9}, {3.9623639590226192`*^9, 
   3.9623640193822727`*^9}, {3.962364160035239*^9, 3.962364178737124*^9}, {
   3.9623642274106197`*^9, 3.962364230511304*^9}, 3.962364290248021*^9, {
   3.962364808464881*^9, 3.962364817524431*^9}, 3.962426147642407*^9, {
   3.962438372663904*^9, 3.962438373259302*^9}, {3.962438407847021*^9, 
   3.9624385322477903`*^9}, {3.9624385624718237`*^9, 3.962438714755397*^9}, {
   3.9624388084187098`*^9, 3.962438826463006*^9}, {3.962438887186236*^9, 
   3.962438919215822*^9}, {3.962439012546267*^9, 3.962439027247019*^9}, {
   3.9624391088660097`*^9, 3.962439119391173*^9}, {3.9624391678627443`*^9, 
   3.962439184943118*^9}, {3.9624392794803267`*^9, 3.9624392795528173`*^9}, {
   3.962439327864129*^9, 3.962439348304047*^9}, {3.962439439696598*^9, 
   3.9624394503777027`*^9}, {3.962439507966275*^9, 3.9624395107907*^9}, {
   3.9624395588409033`*^9, 3.96243961638484*^9}, {3.96243995438046*^9, 
   3.9624399629811974`*^9}, {3.962440005992629*^9, 3.9624400245312634`*^9}, {
   3.962440069437626*^9, 3.962440143996728*^9}, {3.9624402543403254`*^9, 
   3.9624403484007673`*^9}, {3.9624406089982967`*^9, 3.962440613541856*^9}, {
   3.9624406482042627`*^9, 3.962440758148974*^9}, {3.962440791399558*^9, 
   3.96244086915904*^9}, {3.962440905406135*^9, 3.9624409065735273`*^9}, {
   3.962440937502144*^9, 3.9624409665408583`*^9}, {3.962441000582218*^9, 
   3.96244103225193*^9}, {3.962441062369279*^9, 3.962441127694521*^9}, {
   3.9624411680410852`*^9, 3.96244119801544*^9}, {3.962441234835354*^9, 
   3.96244127172757*^9}, {3.962441375133854*^9, 3.962441380862623*^9}, {
   3.962441420766223*^9, 3.962441431589295*^9}, {3.962441612147234*^9, 
   3.962441614049913*^9}, {3.9624421655069027`*^9, 3.962442166824139*^9}, {
   3.962442204219625*^9, 3.9624422400542793`*^9}, 3.962442318070972*^9, 
   3.9624423716984863`*^9, {3.96244243195374*^9, 3.962442472075303*^9}, {
   3.962443447023613*^9, 3.962443460083794*^9}, {3.96244359644271*^9, 
   3.962443620674806*^9}, {3.962443674624619*^9, 3.9624436815238857`*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"49c10cbc-b53d-4de7-9d80-b23287881914"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"get_knots", " ", 
    RowBox[{"(", "closed_open", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"delay", "=", 
                RowBox[{"Sort", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5.0"}], ",", 
                    RowBox[{"-", "2.5"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], " ", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "20"}]]}], ",", "0.0", ",", "2.5", ",", 
                    "5.0"}], "}"}], ",", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"2", "K"}], "+", "3"}]}], "]"}], ",", "3"}], 
                    "]"}]}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x0", "=", 
                   RowBox[{"RandomChoice", "[", "delay", "]"}]}], ",", 
                  RowBox[{"x1", "=", 
                   RowBox[{"RandomChoice", "[", "delay", "]"}]}]}], "}"}], ",", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"ivls", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"x0", "+", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "4"}], "}"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "x1"}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x1", "-", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "4"}], "}"}], "]"}]}], ",", "x1"}], 
                    "}"}]}], "}"}]}], "}"}], ",", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"infimum", "=", 
                    RowBox[{"First", "[", 
                    RowBox[{"Transpose", "[", "ivls", "]"}], "]"}]}], ",", 
                    RowBox[{"supremum", "=", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Transpose", "[", "ivls", "]"}], "]"}]}]}], "}"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"K", ",", "n", ",", 
                    RowBox[{
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r0", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"n", "+", "1"}], "2"], "+", 
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", "1"}], 
                    "]"}]}], ",", 
                    RowBox[{"k1", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"1.0", "==", 
                    RowBox[{"Last", "[", 
                    RowBox[{"QuotientRemainder", "[", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "+", "1"}]}], "]"}]}], ",", 
                    RowBox[{"k2", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"1.0", "==", 
                    RowBox[{"Last", "[", 
                    RowBox[{"QuotientRemainder", "[", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], "+", "1"}]}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"p", "+", "r0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"k1", "-", "1"}], ",", 
                    RowBox[{"k2", "+", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"infimum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "<=", "#", "<", 
                    RowBox[{"supremum", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "&"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "delay", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "infimum", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", "3"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054170314952*^9}, {
   3.9623477647089367`*^9, 3.962347776469133*^9}, {3.962348319858796*^9, 
   3.9623483211087627`*^9}, {3.962348372313335*^9, 3.9623483723369293`*^9}, {
   3.9623485586551647`*^9, 3.962348559047635*^9}, {3.962348644203158*^9, 
   3.9623486458407516`*^9}, {3.9623487180396423`*^9, 3.962348727103162*^9}, {
   3.962348913612862*^9, 3.9623489137632093`*^9}, {3.96234896677816*^9, 
   3.962349040205056*^9}, {3.9623491606215153`*^9, 3.962349231717909*^9}, {
   3.9623492636737556`*^9, 3.962349337160964*^9}, {3.9623493833982077`*^9, 
   3.9623494495440807`*^9}, {3.962349482857666*^9, 3.9623494943148127`*^9}, 
   3.962351151951836*^9, {3.9623513188737993`*^9, 3.9623513219489737`*^9}, {
   3.96235154352682*^9, 3.962351564757039*^9}, {3.962351599248597*^9, 
   3.9623516071915627`*^9}, {3.962351658007269*^9, 3.9623517292397327`*^9}, {
   3.962352181230133*^9, 3.9623523759365263`*^9}, {3.962352414536833*^9, 
   3.962352414865902*^9}, {3.962352493266745*^9, 3.9623525256195993`*^9}, {
   3.962352826305458*^9, 3.962352831148333*^9}, 3.962355563124457*^9, 
   3.962356862895228*^9, {3.962357066851893*^9, 3.962357067361401*^9}, {
   3.962357115454898*^9, 3.962357115759159*^9}, {3.962357182962981*^9, 
   3.96235721255658*^9}, {3.962357433889847*^9, 3.9623574347295837`*^9}, {
   3.9623576054583607`*^9, 3.962357623629521*^9}, {3.962357703411824*^9, 
   3.9623577645055227`*^9}, {3.962357918502344*^9, 3.962357995288438*^9}, {
   3.962358182533257*^9, 3.962358182724842*^9}, {3.962358224237322*^9, 
   3.9623583396916523`*^9}, {3.962358370926631*^9, 3.9623584223174067`*^9}, {
   3.962358511051978*^9, 3.962358538856943*^9}, {3.9623587187624407`*^9, 
   3.962358724375073*^9}, {3.962359222443474*^9, 3.962359229223056*^9}, {
   3.962359288925465*^9, 3.9623592912408867`*^9}, {3.962359508991498*^9, 
   3.962359515626862*^9}, {3.962359550467607*^9, 3.9623595707943287`*^9}, {
   3.962359602221654*^9, 3.962359650026079*^9}, {3.962360066333911*^9, 
   3.9623600730995913`*^9}, 3.962360840849679*^9, {3.962360877583147*^9, 
   3.962360877973412*^9}, {3.96236272114599*^9, 3.962362740038806*^9}, {
   3.962362811539177*^9, 3.9623628594769487`*^9}, {3.962362896173156*^9, 
   3.9623629013543577`*^9}, {3.962363655260401*^9, 3.962363656860825*^9}, {
   3.962363767727437*^9, 3.9623637726375732`*^9}, {3.9623639590226192`*^9, 
   3.9623640193822727`*^9}, {3.962364160035239*^9, 3.962364178737124*^9}, {
   3.9623642274106197`*^9, 3.962364230511304*^9}, 3.962364290248021*^9, {
   3.962364808464881*^9, 3.962364817524431*^9}, 3.962426147642407*^9, {
   3.962438372663904*^9, 3.962438373259302*^9}, {3.962438407847021*^9, 
   3.9624385322477903`*^9}, {3.9624385624718237`*^9, 3.962438714755397*^9}, {
   3.9624388084187098`*^9, 3.962438826463006*^9}, {3.962438887186236*^9, 
   3.962438919215822*^9}, {3.962439012546267*^9, 3.962439027247019*^9}, {
   3.9624391088660097`*^9, 3.962439119391173*^9}, {3.9624391678627443`*^9, 
   3.962439184943118*^9}, {3.9624392794803267`*^9, 3.9624392795528173`*^9}, {
   3.962439327864129*^9, 3.962439348304047*^9}, {3.962439439696598*^9, 
   3.9624394503777027`*^9}, {3.962439507966275*^9, 3.9624395107907*^9}, {
   3.9624395588409033`*^9, 3.96243961638484*^9}, {3.96243995438046*^9, 
   3.9624399629811974`*^9}, {3.962440005992629*^9, 3.9624400245312634`*^9}, {
   3.962440069437626*^9, 3.962440143996728*^9}, {3.9624402543403254`*^9, 
   3.9624403484007673`*^9}, {3.9624406089982967`*^9, 3.962440613541856*^9}, {
   3.9624406482042627`*^9, 3.962440758148974*^9}, {3.962440791399558*^9, 
   3.96244086915904*^9}, {3.962440905406135*^9, 3.9624409065735273`*^9}, {
   3.962440937502144*^9, 3.9624409665408583`*^9}, {3.962441000582218*^9, 
   3.96244103225193*^9}, {3.962441062369279*^9, 3.962441127694521*^9}, {
   3.9624411680410852`*^9, 3.96244119801544*^9}, {3.962441234835354*^9, 
   3.96244127172757*^9}, {3.962441375133854*^9, 3.962441380862623*^9}, {
   3.962441420766223*^9, 3.962441431589295*^9}, {3.962441612147234*^9, 
   3.962441614049913*^9}, {3.9624421655069027`*^9, 3.962442166824139*^9}, {
   3.962442204219625*^9, 3.9624422400542793`*^9}, 3.962442318070972*^9, 
   3.9624423716984863`*^9, {3.96244243195374*^9, 3.962442472075303*^9}, {
   3.962443447023613*^9, 3.962443460083794*^9}, {3.96244359644271*^9, 
   3.962443620674806*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"7b09d00e-bb67-483f-9728-c429b598faa4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "at", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c", "=", 
                 RowBox[{"RandomVariate", "[", 
                  RowBox[{
                   RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                  "]"}]}], ",", 
                RowBox[{"x", "=", 
                 RowBox[{"RandomVariate", "[", 
                  RowBox[{
                   RowBox[{"NormalDistribution", "[", 
                    RowBox[{
                    RowBox[{"K", "/", "2"}], ",", "K"}], "]"}], ",", 
                   RowBox[{"{", "10", "}"}]}], "]"}]}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ps", "=", 
                  RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                   RowBox[{"c", ",", "n", ",", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", 
                  RowBox[{
                   RowBox[{"ps", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "//",
                    "CForm"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"CForm", ",", 
                    RowBox[{"ps", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"CForm", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], "}"}]}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"CForm", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"ps", ",", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], "}"}]}], 
                    "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "9"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.961054182027688*^9}, {3.9614776200830383`*^9, 
  3.961477647018631*^9}, {3.961477677790538*^9, 3.961477744965514*^9}, {
  3.961477809595974*^9, 3.961477833279187*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"c33b2978-fefe-47e3-ae13-050ca66f36dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "get_samples", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c", "=", 
                 RowBox[{"RandomVariate", "[", 
                  RowBox[{
                   RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                  "]"}]}], ",", 
                RowBox[{"tests", "=", "3"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ps", "=", 
                   RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                    RowBox[{"c", ",", "n", ",", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], 
                    "]"}]}], ",", 
                  RowBox[{"x0", "=", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{
                    RowBox[{"K", "/", "2"}], ",", "K"}], "]"}], ",", 
                    "tests"}], "]"}]}], ",", 
                  RowBox[{"L0", "=", 
                   RowBox[{"RandomInteger", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}], ",", "tests"}], "]"}]}], ",", 
                  RowBox[{"M0", "=", 
                   RowBox[{"RandomInteger", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}], ",", "tests"}], "]"}]}]}],
                  "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", 
                  RowBox[{
                   RowBox[{"ps", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "//",
                    "CForm"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"CForm", ",", 
                    RowBox[{"ps", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x0", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    ",", 
                    RowBox[{"L0", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", 
                    RowBox[{"M0", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"SamplesFromP\[Beta]", "[", 
                    RowBox[{"ps", ",", 
                    RowBox[{"L0", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", 
                    RowBox[{"M0", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", 
                    RowBox[{"x0", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "]"}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{"tests", "-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], 
               "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "9"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610541951640663`*^9}, {3.962266131467564*^9, 
  3.962266132569984*^9}, {3.9622661781497183`*^9, 3.962266178863842*^9}, {
  3.962266217260964*^9, 3.96226632782975*^9}, {3.962269136577902*^9, 
  3.962269231322941*^9}, {3.9622694993285513`*^9, 3.962269551509124*^9}, {
  3.962269599077402*^9, 3.962269692432556*^9}, {3.96226977623731*^9, 
  3.962269815385475*^9}, {3.962269937782571*^9, 3.96227000642419*^9}, {
  3.962270043862417*^9, 3.962270076090124*^9}, {3.962270756507188*^9, 
  3.962270852627739*^9}, {3.962271975217659*^9, 3.962272093465603*^9}, {
  3.962272146710314*^9, 3.962272233931365*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"c4d49eb8-5662-44a3-a550-d19a3f9d3c56"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "mean", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"c", "=", 
                RowBox[{"RandomVariate", "[", 
                 RowBox[{
                  RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ps", "=", 
                  RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                   RowBox[{"c", ",", "n", ",", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", 
                  RowBox[{
                   RowBox[{"ps", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "//",
                    "CForm"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"CForm", ",", 
                    RowBox[{"ps", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"MeanP\[Beta]", "[", "ps", "]"}], "//", 
                   "CForm"}]}], "}"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "9"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.961054206163179*^9}, {3.961471134654173*^9, 
  3.9614712056450987`*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"379c1b49-3e28-4728-a377-280bdfd992cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "variance", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"c", "=", 
                RowBox[{"RandomVariate", "[", 
                 RowBox[{
                  RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ps", "=", 
                  RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                   RowBox[{"c", ",", "n", ",", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", 
                  RowBox[{
                   RowBox[{"ps", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "//",
                    "CForm"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"CForm", ",", 
                    RowBox[{"ps", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"VarianceP\[Beta]", "[", "ps", "]"}], "//", 
                   "CForm"}]}], "}"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "9"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.961054213356661*^9}, {3.9614727028443527`*^9, 
  3.96147271445881*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"a53d32b6-305b-4485-a84e-f5329edf9ebc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "integrate", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c", "=", 
                 RowBox[{"RandomVariate", "[", 
                  RowBox[{
                   RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                  "]"}]}], ",", 
                RowBox[{"x0", "=", 
                 RowBox[{"RandomVariate", "[", 
                  RowBox[{
                   RowBox[{"NormalDistribution", "[", 
                    RowBox[{
                    RowBox[{"K", "/", "2"}], ",", "K"}], "]"}], ",", 
                   RowBox[{"{", "10", "}"}]}], "]"}]}], ",", 
                RowBox[{"x1", "=", 
                 RowBox[{"RandomVariate", "[", 
                  RowBox[{
                   RowBox[{"NormalDistribution", "[", 
                    RowBox[{
                    RowBox[{"K", "/", "2"}], ",", "K"}], "]"}], ",", 
                   RowBox[{"{", "10", "}"}]}], "]"}]}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ps", "=", 
                  RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                   RowBox[{"c", ",", "n", ",", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", 
                  RowBox[{
                   RowBox[{"ps", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "//",
                    "CForm"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"CForm", ",", 
                    RowBox[{"ps", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x0", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", 
                    RowBox[{"x1", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", 
                    RowBox[{"AreaUnderP\[Beta]", "[", 
                    RowBox[{"ps", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x0", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], ",", 
                    RowBox[{"x1", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "x0", "]"}], "-", "1"}]}], "}"}]}],
                    "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "9"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
   3.961054181837019*^9, 3.9610542220122137`*^9}, {3.962691975231299*^9, 
   3.9626919962542763`*^9}, {3.9626920758057833`*^9, 3.962692110497158*^9}, 
   3.962692165684782*^9, {3.9626925621832*^9, 3.962692577502913*^9}, {
   3.962692650550415*^9, 3.962692692064567*^9}, {3.9626927256051903`*^9, 
   3.962692776654848*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"0466c9bf-ace6-4fb2-b219-2562d030fa22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "piecewise_polynomials", " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c", "=", 
                 RowBox[{"RandomVariate", "[", 
                  RowBox[{
                   RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                  "]"}]}], ",", 
                RowBox[{"delay", "=", 
                 RowBox[{"Sort", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5.0"}], ",", 
                    RowBox[{"-", "2.5"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1.0"}], " ", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "20"}]]}], ",", "0.0", ",", "2.5", ",", 
                    "5.0"}], "}"}], ",", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"2", "K"}], "+", "3"}]}], "]"}], ",", "3"}], 
                    "]"}]}], "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", 
                RowBox[{"Map", "[", 
                 RowBox[{"CForm", ",", "c"}], "]"}], ",", 
                RowBox[{"Map", "[", 
                 RowBox[{"CForm", ",", "delay"}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ps", "=", 
                    RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                    RowBox[{"c", ",", "n", ",", 
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"b", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"delay", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "+", 
                    FractionBox[
                    RowBox[{"n", "-", "1"}], "2"]}], ",", "K"}], "]"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"1", "==", "K"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{"0", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "//", "CForm"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b0", "=", "b"}], ",", "b1", ",", 
                    RowBox[{"pp", "=", 
                    RowBox[{"{", "}"}]}], ",", "k"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"0", "==", "n"}], ",", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "0"}], ",", 
                    RowBox[{"k", "<", "K"}], ",", 
                    RowBox[{"k", "++"}], ",", 
                    RowBox[{
                    RowBox[{"b1", "=", 
                    RowBox[{"b0", "+", "1"}]}], ";", 
                    RowBox[{"pp", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"pp", ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b0", "//", "CForm"}], ",", 
                    RowBox[{"b0", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b0", "-", 
                    FractionBox["1", "2"]}], "//", "CForm"}], ",", 
                    RowBox[{
                    RowBox[{"b0", "+", 
                    FractionBox["1", "2"]}], "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", "2"]}], "//", "CForm"}], ",", 
                    RowBox[{
                    FractionBox["1", "2"], "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"ps", ",", 
                    RowBox[{"b0", "-", 
                    FractionBox["1", "2"]}]}], "]"}], "+", 
                    RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"ps", ",", 
                    RowBox[{"b0", "+", 
                    FractionBox["1", "2"]}]}], "]"}]}], "2"], "//", "CForm"}],
                     "}"}]}], "}"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"b1", "<", "K"}], ",", 
                    RowBox[{
                    RowBox[{"pp", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"pp", ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b0", "//", "CForm"}], ",", 
                    RowBox[{"b1", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b0", "//", "CForm"}], ",", 
                    RowBox[{"b1", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"ps", ",", 
                    FractionBox[
                    RowBox[{"b0", "+", "b1"}], "2"]}], "]"}], "//", "CForm"}],
                     "}"}]}], "}"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"b0", "=", "b1"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"K", "==", "b1"}], ",", 
                    RowBox[{
                    RowBox[{"pp", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"pp", ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b0", "//", "CForm"}], ",", 
                    RowBox[{"b1", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b0", "//", "CForm"}], ",", 
                    RowBox[{"b1", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"ps", ",", 
                    FractionBox[
                    RowBox[{"b0", "+", "b1"}], "2"]}], "]"}], "//", "CForm"}],
                     "}"}]}], "}"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"b0", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{"b", ",", "1"}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"0", "!=", "b0"}], ",", 
                    RowBox[{"pp", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"pp", ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"b0", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"b0", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"b0", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"ps", ",", 
                    FractionBox["b0", "2"]}], "]"}], "//", "CForm"}], "}"}]}],
                     "}"}], "}"}]}], "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"pp", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"pp", ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b0", "//", "CForm"}], ",", "K"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b0", "//", "CForm"}], ",", "K"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"K", "-", "b0"}], "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"ps", ",", 
                    FractionBox[
                    RowBox[{"b0", "+", "K"}], "2"]}], "]"}], "//", "CForm"}], 
                    "}"}]}], "}"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"b0", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{"b", ",", "1"}], "]"}]}], ";", 
                    RowBox[{"pp", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"pp", ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"b0", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"b0", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"b0", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fP\[Beta]", "[", 
                    RowBox[{"ps", ",", 
                    FractionBox["b0", "2"]}], "]"}], "//", "CForm"}], "}"}]}],
                     "}"}], "}"}]}], "]"}]}]}]}], "]"}]}], "]"}]}]}], "]"}], ",", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "0"}], ",", 
                    RowBox[{"k", "<", "K"}], ",", 
                    RowBox[{"k", "++"}], ",", 
                    RowBox[{
                    RowBox[{"b1", "=", 
                    RowBox[{"b0", "+", "1"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"b1", "<", "K"}], ",", 
                    RowBox[{
                    RowBox[{"pp", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"pp", ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b0", "//", "CForm"}], ",", 
                    RowBox[{"b1", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b0", "//", "CForm"}], ",", 
                    RowBox[{"b1", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "K"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"n", "+", "1"}], ",", "k"}], "]"}], " ", ".", " ", 
                    RowBox[{"W\[Beta]", "[", "n", "]"}]}]}], "]"}]}], "}"}], 
                    "}"}]}], "]"}]}], ";", 
                    RowBox[{"b0", "=", "b1"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"K", "==", "b1"}], ",", 
                    RowBox[{
                    RowBox[{"pp", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"pp", ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b0", "//", "CForm"}], ",", 
                    RowBox[{"b1", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b0", "//", "CForm"}], ",", 
                    RowBox[{"b1", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "K"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"n", "+", "1"}], ",", "k"}], "]"}], " ", ".", " ", 
                    RowBox[{"W\[Beta]", "[", "n", "]"}]}]}], "]"}]}], "}"}], 
                    "}"}]}], "]"}]}], ";", 
                    RowBox[{"b0", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{"b", ",", "1"}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"0", "!=", "b0"}], ",", 
                    RowBox[{"pp", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"pp", ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"b0", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"b0", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"b0", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "K"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"n", "+", "1"}], ",", "k"}], "]"}], " ", ".", " ", 
                    RowBox[{"W\[Beta]", "[", "n", "]"}]}]}], "]"}]}], "}"}], 
                    "}"}]}], "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"pp", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"pp", ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b0", "//", "CForm"}], ",", "K"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b0", "//", "CForm"}], ",", "K"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"K", "-", "b0"}], "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "K"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"n", "+", "1"}], ",", "k"}], "]"}], " ", ".", " ", 
                    RowBox[{"W\[Beta]", "[", "n", "]"}]}]}], "]"}]}], "}"}], 
                    "}"}]}], "]"}]}], ";", 
                    RowBox[{"b0", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{"b", ",", "1"}], "]"}]}], ";", 
                    RowBox[{"pp", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"pp", ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"b0", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"b0", "//", "CForm"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "-", "b0"}], "//", "CForm"}], ",", "1"}], 
                    "}"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "K"}], "]"}], "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"n", "+", "1"}], ",", "k"}], "]"}], " ", ".", " ", 
                    RowBox[{"W\[Beta]", "[", "n", "]"}]}]}], "]"}]}], "}"}], 
                    "}"}]}], "]"}]}]}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}], 
                    ";", "pp"}]}], "]"}]}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"d", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "delay", "]"}], "-", "1"}]}], 
                   "}"}]}], "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "5"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054170314952*^9}, {
   3.9623477647089367`*^9, 3.962347776469133*^9}, {3.962348319858796*^9, 
   3.9623483211087627`*^9}, {3.962348372313335*^9, 3.9623483723369293`*^9}, {
   3.9623485586551647`*^9, 3.962348559047635*^9}, {3.962348644203158*^9, 
   3.9623486458407516`*^9}, {3.9623487180396423`*^9, 3.962348727103162*^9}, {
   3.962348913612862*^9, 3.9623489137632093`*^9}, {3.96234896677816*^9, 
   3.962349040205056*^9}, {3.9623491606215153`*^9, 3.962349231717909*^9}, {
   3.9623492636737556`*^9, 3.962349337160964*^9}, {3.9623493833982077`*^9, 
   3.9623494495440807`*^9}, {3.962349482857666*^9, 3.9623494943148127`*^9}, 
   3.962351151951836*^9, {3.9623513188737993`*^9, 3.9623513219489737`*^9}, {
   3.96235154352682*^9, 3.962351564757039*^9}, {3.962351599248597*^9, 
   3.9623516071915627`*^9}, {3.962351658007269*^9, 3.9623517292397327`*^9}, {
   3.962352181230133*^9, 3.9623523759365263`*^9}, {3.962352414536833*^9, 
   3.962352414865902*^9}, {3.962352493266745*^9, 3.9623525256195993`*^9}, {
   3.962352826305458*^9, 3.962352831148333*^9}, 3.962355563124457*^9, 
   3.962356862895228*^9, {3.962357066851893*^9, 3.962357067361401*^9}, {
   3.962357115454898*^9, 3.962357115759159*^9}, {3.962357182962981*^9, 
   3.96235721255658*^9}, {3.962357433889847*^9, 3.9623574347295837`*^9}, {
   3.9623576054583607`*^9, 3.962357623629521*^9}, {3.962357703411824*^9, 
   3.9623577645055227`*^9}, {3.962357918502344*^9, 3.962357995288438*^9}, {
   3.962358182533257*^9, 3.962358182724842*^9}, {3.962358224237322*^9, 
   3.9623583396916523`*^9}, {3.962358370926631*^9, 3.9623584223174067`*^9}, {
   3.962358511051978*^9, 3.962358538856943*^9}, {3.9623587187624407`*^9, 
   3.962358724375073*^9}, {3.962359222443474*^9, 3.962359229223056*^9}, {
   3.962359288925465*^9, 3.9623592912408867`*^9}, {3.962359508991498*^9, 
   3.962359515626862*^9}, {3.962359550467607*^9, 3.9623595707943287`*^9}, {
   3.962359602221654*^9, 3.962359650026079*^9}, {3.962360066333911*^9, 
   3.9623600730995913`*^9}, 3.962360840849679*^9, {3.962360877583147*^9, 
   3.962360877973412*^9}, {3.96236272114599*^9, 3.962362740038806*^9}, {
   3.962362811539177*^9, 3.9623628594769487`*^9}, {3.962362896173156*^9, 
   3.9623629013543577`*^9}, {3.962363655260401*^9, 3.962363656860825*^9}, {
   3.962363767727437*^9, 3.9623637726375732`*^9}, {3.9623639590226192`*^9, 
   3.9623640193822727`*^9}, {3.962364160035239*^9, 3.962364178737124*^9}, {
   3.9623642274106197`*^9, 3.962364230511304*^9}, 3.962364290248021*^9, {
   3.962364808464881*^9, 3.962364817524431*^9}, 3.962426147642407*^9, {
   3.962438372663904*^9, 3.962438373259302*^9}, {3.962438407847021*^9, 
   3.9624385322477903`*^9}, {3.9624385624718237`*^9, 3.962438714755397*^9}, {
   3.9624388084187098`*^9, 3.962438826463006*^9}, {3.962438887186236*^9, 
   3.962438919215822*^9}, {3.962439012546267*^9, 3.962439027247019*^9}, {
   3.9624391088660097`*^9, 3.962439119391173*^9}, {3.9624391678627443`*^9, 
   3.962439184943118*^9}, {3.9624392794803267`*^9, 3.9624392795528173`*^9}, {
   3.962439327864129*^9, 3.962439348304047*^9}, {3.962439439696598*^9, 
   3.9624394503777027`*^9}, {3.962439507966275*^9, 3.9624395107907*^9}, {
   3.9624395588409033`*^9, 3.96243961638484*^9}, {3.96243995438046*^9, 
   3.9624399629811974`*^9}, {3.962440005992629*^9, 3.9624400245312634`*^9}, {
   3.962440069437626*^9, 3.962440143996728*^9}, {3.9624402543403254`*^9, 
   3.9624403484007673`*^9}, {3.9624406089982967`*^9, 3.962440613541856*^9}, {
   3.9624406482042627`*^9, 3.962440758148974*^9}, {3.962440791399558*^9, 
   3.96244086915904*^9}, {3.962440905406135*^9, 3.9624409065735273`*^9}, {
   3.962440937502144*^9, 3.9624409665408583`*^9}, {3.962441000582218*^9, 
   3.96244103225193*^9}, {3.962441062369279*^9, 3.962441127694521*^9}, {
   3.9624411680410852`*^9, 3.96244119801544*^9}, {3.962441234835354*^9, 
   3.96244127172757*^9}, {3.962441375133854*^9, 3.962441380862623*^9}, {
   3.962441420766223*^9, 3.962441431589295*^9}, {3.962441612147234*^9, 
   3.962441614049913*^9}, {3.9624421655069027`*^9, 3.962442166824139*^9}, {
   3.962442204219625*^9, 3.9624422400542793`*^9}, 3.962442318070972*^9, 
   3.9624423716984863`*^9, {3.96244243195374*^9, 3.962442472075303*^9}, {
   3.962443447023613*^9, 3.962443460083794*^9}, {3.96244359644271*^9, 
   3.962443620674806*^9}, {3.962768963057992*^9, 3.9627690397977552`*^9}, {
   3.962769076533937*^9, 3.9627691234146357`*^9}, {3.962769160084445*^9, 
   3.962769374737294*^9}, {3.962769411221629*^9, 3.962769482665681*^9}, {
   3.962769547403265*^9, 3.962769664464048*^9}, {3.962769734670965*^9, 
   3.96276980933576*^9}, {3.9627698408302107`*^9, 3.962769937027965*^9}, {
   3.962769967308853*^9, 3.962770069914216*^9}, 3.9627701399319687`*^9, {
   3.962770172940691*^9, 3.962770173368023*^9}, {3.962770344448799*^9, 
   3.96277044505094*^9}, {3.9627709914704103`*^9, 3.9627709956078463`*^9}, {
   3.9627711976172256`*^9, 3.962771197741103*^9}, {3.9627713204687767`*^9, 
   3.962771408306978*^9}, {3.962771467262679*^9, 3.962771693480311*^9}, {
   3.962771732481001*^9, 3.9627719757184343`*^9}, {3.962772023840103*^9, 
   3.96277203839895*^9}, {3.9627720734877157`*^9, 3.962772161430374*^9}, {
   3.962772321386557*^9, 3.962772323522953*^9}, {3.962772357333521*^9, 
   3.9627723692982273`*^9}, {3.962772400851232*^9, 3.962772416269945*^9}, {
   3.962772451724947*^9, 3.962772531316491*^9}, 3.962772566440983*^9, {
   3.962772654166956*^9, 3.962772655886963*^9}, {3.962772765544425*^9, 
   3.962772782640758*^9}, {3.9627729355398397`*^9, 3.96277298510777*^9}, {
   3.962773027745645*^9, 3.9627731132028103`*^9}, {3.962773193019967*^9, 
   3.962773209126052*^9}, {3.96277327148414*^9, 3.9627733093331013`*^9}, {
   3.9627733742373238`*^9, 3.962773508373259*^9}, {3.962773540262735*^9, 
   3.9627736218576097`*^9}, {3.962773737449812*^9, 3.962773748454083*^9}, {
   3.962773797795512*^9, 3.962774011500638*^9}, {3.962774380685586*^9, 
   3.962774435567864*^9}, {3.962774587912784*^9, 3.962774613159636*^9}, {
   3.962774784584903*^9, 3.962774809278452*^9}, {3.962774881973637*^9, 
   3.9627749264865932`*^9}, {3.962775079460177*^9, 3.96277508321171*^9}, {
   3.9627758049911613`*^9, 3.962775805965742*^9}, {3.962775931039001*^9, 
   3.962776038392836*^9}, {3.962777205557811*^9, 3.962777205717716*^9}, {
   3.962777612721376*^9, 3.96277761291551*^9}, {3.962778346477392*^9, 
   3.962778356940796*^9}, {3.9627787405367117`*^9, 3.962778740678405*^9}, {
   3.962783154421961*^9, 3.96278323023624*^9}, {3.9627832682104692`*^9, 
   3.962783276897684*^9}, {3.962783323195063*^9, 3.962783381658309*^9}, {
   3.962784826531736*^9, 3.962784833918077*^9}, {3.9627850292377453`*^9, 
   3.962785035159647*^9}, {3.9627851214999323`*^9, 3.962785129326311*^9}, {
   3.9627880756576138`*^9, 3.962788082750396*^9}, {3.9627881261126413`*^9, 
   3.962788178005934*^9}, {3.962788222420223*^9, 3.9627882345343027`*^9}, {
   3.9627883819603767`*^9, 3.9627884109097033`*^9}, {3.962789398158972*^9, 
   3.9627894033398733`*^9}, {3.962789456903451*^9, 3.96278946041822*^9}, {
   3.9627971928396263`*^9, 3.9627972664027653`*^9}, {3.96279740069226*^9, 
   3.962797445962677*^9}, {3.962797478947068*^9, 3.962797483568844*^9}, {
   3.962797517309681*^9, 3.96279752500634*^9}, {3.9627981894561033`*^9, 
   3.962798204969202*^9}, {3.9627982390011377`*^9, 3.962798245968122*^9}, {
   3.962798304435442*^9, 3.962798337496784*^9}, {3.962798369462531*^9, 
   3.962798379620384*^9}, {3.962798460336577*^9, 3.9627984636211557`*^9}, {
   3.962798507492671*^9, 3.962798528295164*^9}, {3.962798561370276*^9, 
   3.962798612568213*^9}, {3.962798714222677*^9, 3.962798714701295*^9}, {
   3.962798949454495*^9, 3.9627989910410557`*^9}, {3.962799026783182*^9, 
   3.9627990425054817`*^9}, {3.962799675552822*^9, 3.962799769484146*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"5b1f4ef6-da02-4883-8258-bff983c19cf9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "lower_bound", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"c", "=", 
                RowBox[{"RandomVariate", "[", 
                 RowBox[{
                  RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ps", "=", 
                   RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                    RowBox[{"c", ",", "n", ",", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], 
                    "]"}]}], ",", 
                  RowBox[{"m", "=", 
                   RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "5"}], "}"}], "]"}]}]}], "}"}], ",", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"b", "=", 
                    RowBox[{"P\[Beta]LowerBoundP\[Beta]", "[", 
                    RowBox[{"ps", ",", "m"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"n", ",", 
                    RowBox[{
                    RowBox[{"ps", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "//",
                     "CForm"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"ps", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", "m", 
                    ",", 
                    RowBox[{
                    RowBox[{"b", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "//",
                     "CForm"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"b", "[", "\"\<c\>\"", "]"}]}], "]"}]}], "}"}]}], 
                 "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "9"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.938586359547517*^9, {3.938586397583316*^9, 3.938586398841621*^9}, {
   3.9385864458842077`*^9, 3.938586447193768*^9}, {3.938586488709961*^9, 
   3.9385865906077337`*^9}, {3.938586662000264*^9, 3.938586714848836*^9}, {
   3.938586753402912*^9, 3.9385869231002493`*^9}, {3.9385869966720877`*^9, 
   3.938587049105826*^9}, {3.9385873163299923`*^9, 3.938587348904435*^9}, {
   3.9385874352857018`*^9, 3.9385874721013727`*^9}, {3.938587566837228*^9, 
   3.938587571841302*^9}, {3.9569007618222427`*^9, 3.956900776027605*^9}, 
   3.956900816249206*^9, {3.956901124463397*^9, 3.956901276766511*^9}, {
   3.956901328515028*^9, 3.956901340465918*^9}, {3.9600160601449413`*^9, 
   3.9600160633821507`*^9}, {3.9600161259221783`*^9, 
   3.9600162473988457`*^9}, {3.96001631397302*^9, 3.960016374419465*^9}, {
   3.960016416178966*^9, 3.960016500915917*^9}, {3.960016565708789*^9, 
   3.96001659234052*^9}, {3.960016646927198*^9, 3.9600167111648607`*^9}, {
   3.960016931539708*^9, 3.960016931902403*^9}, {3.960017006668791*^9, 
   3.960017028199914*^9}, {3.960017147742866*^9, 3.960017148126548*^9}, {
   3.960017224522367*^9, 3.96001722462997*^9}, {3.960017640292343*^9, 
   3.9600176417523746`*^9}, {3.9600180037102547`*^9, 3.960018026377084*^9}, {
   3.960018130649789*^9, 3.960018181769369*^9}, {3.9600182452634897`*^9, 
   3.960018303801558*^9}, {3.960018350108754*^9, 3.960018350560236*^9}, 
   3.961049202875475*^9, {3.96104948289468*^9, 3.961049491773293*^9}, {
   3.961049538870125*^9, 3.9610496827291803`*^9}, {3.96104972889664*^9, 
   3.961049834414349*^9}, {3.961049881024974*^9, 3.9610499100586023`*^9}, {
   3.961049975539424*^9, 3.9610500226846333`*^9}, {3.961050271000372*^9, 
   3.961050273917872*^9}, 3.961050315098806*^9, {3.9610505915873537`*^9, 
   3.96105062124012*^9}, {3.961050673777708*^9, 3.961050722111554*^9}, {
   3.961050789268351*^9, 3.961050789869947*^9}, {3.961050836563994*^9, 
   3.9610508368335047`*^9}, {3.961050987879705*^9, 3.961050988041172*^9}, {
   3.961051025512784*^9, 3.961051044695527*^9}, {3.961051163676936*^9, 
   3.961051167108152*^9}, {3.961051295777504*^9, 3.961051295949915*^9}, {
   3.961051348061645*^9, 3.961051350260594*^9}, {3.96105142506476*^9, 
   3.96105142865031*^9}, {3.961051529643632*^9, 3.9610515306002693`*^9}, {
   3.9610516372363777`*^9, 3.9610516381487637`*^9}, {3.9610519439879417`*^9, 
   3.9610519597453833`*^9}, {3.961052009179163*^9, 3.961052013817349*^9}, {
   3.9610521734874477`*^9, 3.9610521773430977`*^9}, {3.961052218241638*^9, 
   3.9610522409539137`*^9}, {3.96105239662568*^9, 3.961052429963388*^9}, {
   3.9610524723376417`*^9, 3.961052472509528*^9}, {3.961052647216442*^9, 
   3.961052647334168*^9}, {3.96105334981843*^9, 3.961053350051495*^9}, {
   3.962875578340571*^9, 3.962875826460655*^9}, {3.962875857326236*^9, 
   3.9628759301109467`*^9}, 3.9628759983563843`*^9, {3.96287603092117*^9, 
   3.962876040262838*^9}, {3.9628760721559563`*^9, 3.9628762429292707`*^9}, {
   3.96287636467204*^9, 3.962876368805656*^9}, {3.962876402957508*^9, 
   3.962876430907507*^9}, {3.962876462700355*^9, 3.9628764662820883`*^9}, {
   3.962876507017126*^9, 3.962876507371086*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"466b0256-23aa-4e31-b1a6-ccf12c519d8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "upper_bound", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CopyToClipboard", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"c", "=", 
                RowBox[{"RandomVariate", "[", 
                 RowBox[{
                  RowBox[{"NormalDistribution", "[", "]"}], ",", "K"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ps", "=", 
                   RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
                    RowBox[{"c", ",", "n", ",", 
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], 
                    "]"}]}], ",", 
                  RowBox[{"m", "=", 
                   RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "5"}], "}"}], "]"}]}]}], "}"}], ",", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"b", "=", 
                    RowBox[{"P\[Beta]UpperBoundP\[Beta]", "[", 
                    RowBox[{"ps", ",", "m"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"n", ",", 
                    RowBox[{
                    RowBox[{"ps", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "//",
                     "CForm"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"ps", "[", "\"\<c\>\"", "]"}]}], "]"}], ",", "m", 
                    ",", 
                    RowBox[{
                    RowBox[{"b", "[", "\"\<\[CapitalDelta]x\>\"", "]"}], "//",
                     "CForm"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"CForm", ",", 
                    RowBox[{"b", "[", "\"\<c\>\"", "]"}]}], "]"}]}], "}"}]}], 
                 "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"K", ",", "1", ",", "9"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}], ",", 
       RowBox[{"\"\<, \\r\>\"", "->", "\"\<\\r\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
   3.961054181837019*^9, 3.9610542220122137`*^9}, 3.961054255104478*^9, {
   3.962877439573818*^9, 3.962877451596648*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"61886591-3e21-4e6e-8c55-7e8a8cf3ef42"],

Cell[BoxData[
 RowBox[{"(*", " ", "piecewise_signs", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
   3.961054181837019*^9, 3.9610542220122137`*^9}, 3.9610542650389433`*^9},
 CellLabel->
  "In[175]:=",ExpressionUUID->"2176b276-9a42-4a51-963e-1abeedce62f5"],

Cell[BoxData[
 RowBox[{"(*", " ", "zeros", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
   3.961054181837019*^9, 3.9610542220122137`*^9}, 3.96105428237932*^9},
 CellLabel->
  "In[176]:=",ExpressionUUID->"87eba284-fedb-4c65-a1e6-967ec0abf573"],

Cell[BoxData[
 RowBox[{"(*", " ", "zero_crossings", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.9610542916317263`*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"60fa75a0-2d8b-4a9e-bcc5-3ac3c55c39fb"],

Cell[BoxData[
 RowBox[{"(*", " ", "Extremum", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054303571333*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"baeee88d-1827-402e-a9c0-980738228f62"],

Cell[BoxData[
 RowBox[{"(*", " ", "extrema", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054312318972*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"6da677a2-e548-4abc-aecf-25ff72ca99c6"],

Cell[BoxData[
 RowBox[{"(*", " ", "fourier_coeff", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054322002252*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"9c1470e4-e1b4-435d-b077-44828bf14a64"],

Cell[BoxData[
 RowBox[{"(*", " ", "fractionalized_delay", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054329486108*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"c1a6670b-c422-4ef1-a819-4fcab7547a20"],

Cell[BoxData[
 RowBox[{"(*", " ", "delayed_by", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054336875556*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"3b8d88cf-1af6-4a08-a773-677d28a5da07"],

Cell[BoxData[
 RowBox[{"(*", " ", "mirrored", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
   3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
   3.961054312318972*^9}, 3.9610543457457047`*^9},
 CellLabel->
  "In[183]:=",ExpressionUUID->"771a3894-2023-4096-9129-46ec95f723de"],

Cell[BoxData[
 RowBox[{"(*", " ", "plus", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054312318972*^9}, {3.9610543457457047`*^9, 3.961054353981542*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"519566d4-7e19-4192-8c42-7d5e16f0268b"],

Cell[BoxData[
 RowBox[{"(*", " ", "negated", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054312318972*^9}, {3.9610543457457047`*^9, 3.961054360111301*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"c248f79d-5374-4a2e-8628-93184f2d9788"],

Cell[BoxData[
 RowBox[{"(*", " ", "times", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054312318972*^9}, {3.9610543457457047`*^9, 3.961054367394992*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"f213eeae-ba82-424b-8a56-2e55890bd7f4"],

Cell[BoxData[
 RowBox[{"(*", " ", "gradient", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054312318972*^9}, {3.9610543457457047`*^9, 3.961054373306603*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"0c91a2b1-4b82-46ae-9985-f36538f89088"],

Cell[BoxData[
 RowBox[{"(*", " ", "anti_grad", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054312318972*^9}, {3.9610543457457047`*^9, 3.961054384288486*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"55cc84fa-0c0d-4d28-a90d-ffab4bcdd06b"],

Cell[BoxData[
 RowBox[{"(*", " ", "differentiated", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054312318972*^9}, {3.9610543457457047`*^9, 3.961054390670532*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"1f1e8f1e-0c7d-4c11-ad2e-3b62917a935f"],

Cell[BoxData[
 RowBox[{"(*", " ", "projected", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054312318972*^9}, {3.9610543457457047`*^9, 3.961054399482732*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"d93f2d14-52aa-49e9-b70d-e93284c9e735"],

Cell[BoxData[
 RowBox[{"(*", " ", "upscaled", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054312318972*^9}, {3.9610543457457047`*^9, 3.961054407789781*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"a6f42a38-2be6-4c1e-83c3-128e0fc598be"],

Cell[BoxData[
 RowBox[{"(*", " ", "upscaled_projected", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054312318972*^9}, {3.9610543457457047`*^9, 3.961054415570718*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"eea1db3c-e2ce-42d6-8d36-95a09bfd858f"],

Cell[BoxData[
 RowBox[{"(*", " ", "downscaled_projected", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054312318972*^9}, {3.9610543457457047`*^9, 3.9610544258613462`*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"148bae29-b26e-47ee-93c4-1affaec01c4d"],

Cell[BoxData[
 RowBox[{"(*", " ", "rescaled_projected", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9610540592602663`*^9, 3.961054151515955*^9}, {
  3.961054181837019*^9, 3.9610542220122137`*^9}, {3.96105428237932*^9, 
  3.961054312318972*^9}, {3.9610543457457047`*^9, 3.961054436514504*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"7b9db954-d659-4da5-b48e-1fb2362b2bc3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromSamplesToSmoothedCoeffP\[Beta]", "[", 
   RowBox[{"f0_", ",", "\[Lambda]_", ",", 
    RowBox[{"{", 
     RowBox[{"\[CapitalDelta]x_", ",", "n_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"K", "=", 
      RowBox[{"Length", "[", "f0", "]"}]}], "}"}], ",", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Bm", "=", 
         RowBox[{"Fourier", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"p", "=", 
                RowBox[{
                 RowBox[{"\[LeftCeiling]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"k", "-", 
                    FractionBox[
                    RowBox[{"n", "-", "1"}], "2"], "-", "\[CapitalDelta]x"}], 
                    ")"}], "/", "K"}], "\[RightCeiling]"}], "-", "1"}]}], 
               RowBox[{
                RowBox[{"\[LeftFloor]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"k", "+", 
                    FractionBox[
                    RowBox[{"n", "-", "1"}], "2"], "-", "\[CapitalDelta]x"}], 
                   ")"}], "/", "K"}], "\[RightFloor]"}], "+", "1"}]], 
              RowBox[{"N", "[", 
               RowBox[{"d\[Beta]", "[", 
                RowBox[{
                 RowBox[{"k", "-", "\[CapitalDelta]x", "-", 
                  RowBox[{"p", " ", "K"}]}], ",", "n", ",", "0"}], "]"}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "0", ",", 
               RowBox[{"K", "-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"FourierParameters", "->", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", 
              RowBox[{"-", "1"}]}], "}"}]}]}], "]"}]}], ",", 
        RowBox[{"Bp", "=", 
         RowBox[{"Fourier", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"p", "=", 
                RowBox[{
                 RowBox[{"\[LeftCeiling]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"k", "-", 
                    FractionBox[
                    RowBox[{"n", "-", "1"}], "2"], "+", "\[CapitalDelta]x"}], 
                    ")"}], "/", "K"}], "\[RightCeiling]"}], "-", "1"}]}], 
               RowBox[{
                RowBox[{"\[LeftFloor]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"k", "+", 
                    FractionBox[
                    RowBox[{"n", "-", "1"}], "2"], "+", "\[CapitalDelta]x"}], 
                   ")"}], "/", "K"}], "\[RightFloor]"}], "+", "1"}]], 
              RowBox[{"N", "[", 
               RowBox[{"d\[Beta]", "[", 
                RowBox[{
                 RowBox[{"k", "+", "\[CapitalDelta]x", "-", 
                  RowBox[{"p", " ", "K"}]}], ",", "n", ",", "0"}], "]"}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "0", ",", 
               RowBox[{"K", "-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"FourierParameters", "->", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", 
              RowBox[{"-", "1"}]}], "}"}]}]}], "]"}]}], ",", 
        RowBox[{"dB", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Fourier", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"p", "=", 
                  RowBox[{"\[LeftCeiling]", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"k", "-", "n"}], ")"}], "/", "K"}], 
                   "\[RightCeiling]"}]}], 
                 RowBox[{"\[LeftFloor]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"k", "+", "n"}], ")"}], "/", "K"}], 
                  "\[RightFloor]"}]], 
                RowBox[{"N", "[", 
                 RowBox[{"d\[Beta]", "[", 
                  RowBox[{
                   RowBox[{"k", "-", 
                    RowBox[{"p", " ", "K"}]}], ",", 
                   RowBox[{
                    RowBox[{"2", "n"}], "+", "1"}], ",", 
                   RowBox[{"2", "m"}]}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "0", ",", 
                 RowBox[{"K", "-", "1"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"FourierParameters", "->", 
              RowBox[{"{", 
               RowBox[{"1", ",", " ", 
                RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"F0", "=", 
         RowBox[{"Fourier", "[", 
          RowBox[{"f0", ",", 
           RowBox[{"FourierParameters", "->", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", 
              RowBox[{"-", "1"}]}], "}"}]}]}], "]"}]}]}], "}"}], ",", 
      RowBox[{"Re", "[", 
       RowBox[{"InverseFourier", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"B1", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Bm", "[", 
                   RowBox[{"[", 
                    RowBox[{"\[Nu]", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], 
                  RowBox[{"Bp", "[", 
                   RowBox[{"[", 
                    RowBox[{"\[Nu]", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"m", "=", "0"}], "n"], 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "m"], 
                   RowBox[{"\[Lambda]", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], 
                   RowBox[{"dB", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"m", "+", 
                    RowBox[{"(", "1", ")"}]}], ",", 
                    RowBox[{"\[Nu]", "+", 
                    RowBox[{"(", "1", ")"}]}]}], "]"}], "]"}]}]}]}]}], "}"}], 
              ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"0", "==", 
                 RowBox[{"Chop", "[", 
                  RowBox[{"Abs", "[", "B1", "]"}], "]"}]}], ",", "0", ",", 
                FractionBox[
                 RowBox[{"Bp", "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Nu]", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], "B1"]}], "]"}]}],
              "]"}], 
            RowBox[{"F0", "[", 
             RowBox[{"[", 
              RowBox[{"\[Nu]", "+", 
               RowBox[{"(", "1", ")"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Nu]", ",", "0", ",", 
             RowBox[{"K", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"FourierParameters", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", 
            RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.963398449651985*^9, 3.963398474683799*^9}, {
   3.9633989386387873`*^9, 3.9633989432060204`*^9}, 3.9634710572014093`*^9, {
   3.963471839805273*^9, 3.963471845567718*^9}, {3.9634718888111753`*^9, 
   3.963471901604659*^9}, {3.963472276907997*^9, 3.9634723675304317`*^9}, {
   3.963472471081213*^9, 3.963472494656053*^9}, {3.963487912119474*^9, 
   3.9634879882395372`*^9}, 3.963649565542642*^9, {3.963650418716694*^9, 
   3.963650428949457*^9}, 3.963651504581903*^9, {3.963651895219521*^9, 
   3.963651902232383*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"9eb8d069-decf-43c5-8d90-9df46c719d61"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P\[Beta]FromSamplesFourier", "[", 
    RowBox[{
     RowBox[{"f_List", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VectorQ", "[", "f", "]"}], "\[And]", 
        RowBox[{"1", "<=", 
         RowBox[{"Length", "[", "f", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"n_Integer", "?", "NonNegative"}], ",", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Delay", "->", "0"}], ",", 
        RowBox[{"Regularized", "->", "False"}]}], "}"}], "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", "=", 
        RowBox[{"Length", "[", "f", "]"}]}], ",", 
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{"OptionValue", "[", "Delay", "]"}]}], ",", 
       RowBox[{"r", "=", 
        RowBox[{"OptionValue", "[", "Regularized", "]"}]}]}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"samples", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OddQ", "[", "P", "]"}], "\[Or]", 
            RowBox[{"\[Not]", "r"}]}], ",", "f", ",", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"e", "=", 
                RowBox[{"Downsample", "[", 
                 RowBox[{"f", ",", "2", ",", 
                  RowBox[{"0", "+", 
                   RowBox[{"(", "1", ")"}]}]}], "]"}]}], ",", 
               RowBox[{"o", "=", 
                RowBox[{"Downsample", "[", 
                 RowBox[{"f", ",", "2", ",", 
                  RowBox[{"1", "+", 
                   RowBox[{"(", "1", ")"}]}]}], "]"}]}], ",", "e0", ",", 
               "o0"}], "}"}], ",", 
             RowBox[{
              RowBox[{"e0", "=", 
               RowBox[{"Mean", "[", "e", "]"}]}], ";", 
              RowBox[{"o0", "=", 
               RowBox[{"Mean", "[", "o", "]"}]}], ";", 
              RowBox[{"e", "+=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"o0", "-", "e0"}], ")"}], "/", "2"}]}], ";", 
              RowBox[{"o", "+=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"e0", "-", "o0"}], ")"}], "/", "2"}]}], ";", 
              RowBox[{
               RowBox[{"Upsample", "[", 
                RowBox[{"e", ",", "2", ",", 
                 RowBox[{"0", "+", 
                  RowBox[{"(", "1", ")"}]}]}], "]"}], "+", 
               RowBox[{"Upsample", "[", 
                RowBox[{"o", ",", "2", ",", 
                 RowBox[{"1", "+", 
                  RowBox[{"(", "1", ")"}]}]}], "]"}]}]}]}], "]"}]}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Fs", "=", 
            RowBox[{"Fourier", "[", 
             RowBox[{"samples", ",", 
              RowBox[{"FourierParameters", "->", 
               RowBox[{"{", 
                RowBox[{"1", ",", " ", 
                 RowBox[{"-", "1"}]}], "}"}]}]}], "]"}]}], ",", 
           RowBox[{"F\[Beta]", "=", 
            RowBox[{"Fourier", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"p", "=", 
                   RowBox[{"\[LeftCeiling]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"k", "-", 
                    FractionBox[
                    RowBox[{"n", "+", "1"}], "2"], "-", "\[CapitalDelta]x"}], 
                    ")"}], "/", "P"}], "\[RightCeiling]"}]}], 
                  RowBox[{"\[LeftFloor]", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"k", "+", 
                    FractionBox[
                    RowBox[{"n", "+", "1"}], "2"], "-", "\[CapitalDelta]x"}], 
                    ")"}], "/", "P"}], "\[RightFloor]"}]], 
                 RowBox[{"\[Beta]", "[", 
                  RowBox[{
                   RowBox[{"k", "-", "\[CapitalDelta]x", "-", 
                    RowBox[{"p", " ", "P"}]}], ",", "n"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "0", ",", 
                  RowBox[{"P", "-", "1"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"FourierParameters", "->", 
               RowBox[{"{", 
                RowBox[{"1", ",", " ", 
                 RowBox[{"-", "1"}]}], "}"}]}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Fc", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"r", "\[And]", 
                  RowBox[{
                   FractionBox["P", "2"], "==", "\[Nu]"}]}], ",", "0", ",", 
                 FractionBox[
                  RowBox[{"Fs", "[", 
                   RowBox[{"[", 
                    RowBox[{"\[Nu]", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}], 
                  RowBox[{"F\[Beta]", "[", 
                   RowBox[{"[", 
                    RowBox[{"\[Nu]", "+", 
                    RowBox[{"(", "1", ")"}]}], "]"}], "]"}]]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Nu]", ",", "0", ",", 
                 RowBox[{"P", "-", "1"}]}], "}"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
            RowBox[{
             RowBox[{"Re", "[", 
              RowBox[{"InverseFourier", "[", 
               RowBox[{"Fc", ",", 
                RowBox[{"FourierParameters", "->", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", " ", 
                   RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], "]"}], ",", "n", ",",
              "\[CapitalDelta]x"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.963473906011168*^9, 3.963474199623782*^9, {3.96347445352713*^9, 
   3.9634744612058163`*^9}, {3.963474660927619*^9, 3.963474663072192*^9}, {
   3.963474695117228*^9, 3.9634746958386803`*^9}, 3.963474821989047*^9, {
   3.963474872054123*^9, 3.96347491598952*^9}, {3.963475099401265*^9, 
   3.963475115901906*^9}, {3.9634752703133163`*^9, 3.9634752732506523`*^9}, {
   3.963475424431266*^9, 3.963475426231237*^9}, {3.9634758734616337`*^9, 
   3.963475916093462*^9}, {3.963476166055644*^9, 3.9634761741239567`*^9}, {
   3.963477954509701*^9, 3.963477955312974*^9}, {3.96347799758679*^9, 
   3.963478043731118*^9}, {3.96347808611917*^9, 3.963478334727747*^9}, {
   3.9634787073830557`*^9, 3.963478820492127*^9}, {3.963478873539679*^9, 
   3.963479038855048*^9}, 3.963479130828329*^9, 3.9634792394252663`*^9, {
   3.963479304334834*^9, 3.9634793180398073`*^9}, {3.963479545654698*^9, 
   3.9634795910825453`*^9}, {3.963481025894779*^9, 3.963481080940234*^9}, {
   3.963481117589233*^9, 3.963481166307411*^9}, {3.9634811991318207`*^9, 
   3.963481200830665*^9}, {3.963481244406098*^9, 3.9634812586291237`*^9}, {
   3.9634814549439363`*^9, 3.963481455077773*^9}, {3.9634824104752703`*^9, 
   3.9634824106765137`*^9}, {3.9634824926496677`*^9, 3.96348249315455*^9}, {
   3.963482613386036*^9, 3.963482613563615*^9}, {3.963484254763948*^9, 
   3.963484289223197*^9}, {3.963488227174932*^9, 3.963488228880644*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"faa9a866-4b90-43d1-8d6e-cf53e0fc4ba9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", "]"}], ",", "13"}], "]"}]}], ",", 
     RowBox[{"n", "=", "3"}], ",", "regularizedData", ",", "c1", ",", "s1", ",",
      "ss", ",", "cc"}], "}"}], ",", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"regularizedData", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OddQ", "[", 
          RowBox[{"Length", "[", "data", "]"}], "]"}], ",", "data", ",", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"e", "=", 
              RowBox[{"Downsample", "[", 
               RowBox[{"data", ",", "2", ",", 
                RowBox[{"0", "+", 
                 RowBox[{"(", "1", ")"}]}]}], "]"}]}], ",", 
             RowBox[{"o", "=", 
              RowBox[{"Downsample", "[", 
               RowBox[{"data", ",", "2", ",", 
                RowBox[{"1", "+", 
                 RowBox[{"(", "1", ")"}]}]}], "]"}]}], ",", "e0", ",", "o0"}],
             "}"}], ",", 
           RowBox[{
            RowBox[{"e0", "=", 
             RowBox[{"Mean", "[", "e", "]"}]}], ";", 
            RowBox[{"o0", "=", 
             RowBox[{"Mean", "[", "o", "]"}]}], ";", 
            RowBox[{"e", "+=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"o0", "-", "e0"}], ")"}], "/", "2"}]}], ";", 
            RowBox[{"o", "+=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"e0", "-", "o0"}], ")"}], "/", "2"}]}], ";", 
            RowBox[{
             RowBox[{"Upsample", "[", 
              RowBox[{"e", ",", "2", ",", 
               RowBox[{"0", "+", 
                RowBox[{"(", "1", ")"}]}]}], "]"}], "+", 
             RowBox[{"Upsample", "[", 
              RowBox[{"o", ",", "2", ",", 
               RowBox[{"1", "+", 
                RowBox[{"(", "1", ")"}]}]}], "]"}]}]}]}], "]"}]}], "]"}]}], ";", 
      RowBox[{"c1", "=", 
       RowBox[{
        RowBox[{"P\[Beta]FromSamplesFourier", "[", 
         RowBox[{"data", ",", "n", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Delay", "->", "\[Delta]x"}], ",", 
            RowBox[{"Regularized", "->", "True"}]}], "}"}]}], "]"}], 
        "[", "\"\<c\>\"", "]"}]}], ";", 
      RowBox[{"cc", "=", 
       RowBox[{"FromSamplesToSmoothedCoeffP\[Beta]", "[", 
        RowBox[{"regularizedData", ",", 
         RowBox[{"{", 
          RowBox[{
          "\[Lambda]0", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
           "\[Lambda]3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Delta]x", ",", "n"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"s1", "=", 
       RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
        RowBox[{"c1", ",", "n", ",", "\[Delta]x"}], "]"}]}], ";", 
      RowBox[{"ss", "=", 
       RowBox[{"P\[Beta]FromCoeff\[Beta]", "[", 
        RowBox[{"cc", ",", "n", ",", "\[Delta]x"}], "]"}]}], ";", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ShowP\[Beta]", "[", 
           RowBox[{"s1", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "13"}], "}"}]}], "]"}], ",", 
          RowBox[{"ShowP\[Beta]", "[", 
           RowBox[{"ss", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "13"}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "13"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Delta]x", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "2.5"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]0", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "2"}], ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]1", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "2"}], ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]2", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "2"}], ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]3", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "2"}], ",", "10"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9633984904754143`*^9, 3.9633987258194838`*^9}, {
   3.963398760586615*^9, 3.9633987763805113`*^9}, {3.963398839683391*^9, 
   3.963398852129736*^9}, {3.963398919179886*^9, 3.9633989499469423`*^9}, {
   3.963398995428684*^9, 3.9633990054587*^9}, {3.963399088159832*^9, 
   3.963399096988186*^9}, {3.963399172318059*^9, 3.963399208480052*^9}, {
   3.963399276029891*^9, 3.963399375185419*^9}, {3.9633994106998796`*^9, 
   3.963399414207466*^9}, {3.963399510474379*^9, 3.963399576082211*^9}, {
   3.963399629890671*^9, 3.9633996306876698`*^9}, {3.9633996826655617`*^9, 
   3.963399758048892*^9}, {3.963471252251184*^9, 3.963471254545946*^9}, {
   3.9634713369079647`*^9, 3.963471346461431*^9}, {3.963471456384823*^9, 
   3.963471710831482*^9}, {3.963471742128476*^9, 3.96347178104736*^9}, 
   3.963471813620735*^9, {3.963471921436706*^9, 3.963471928312248*^9}, {
   3.9634719696640377`*^9, 3.963472004067301*^9}, {3.963472041162509*^9, 
   3.963472066039123*^9}, {3.963472134829546*^9, 3.9634721357107067`*^9}, {
   3.963472231247484*^9, 3.963472232053698*^9}, {3.963472386894924*^9, 
   3.963472387077927*^9}, {3.963472436775833*^9, 3.9634724370933657`*^9}, {
   3.9634725577811832`*^9, 3.9634725582855453`*^9}, {3.963472643238009*^9, 
   3.9634726435903807`*^9}, {3.963472853855135*^9, 3.963472953831811*^9}, {
   3.963472998324045*^9, 3.963473023968177*^9}, {3.963473069234008*^9, 
   3.963473069601191*^9}, 3.963474175309087*^9, {3.963475184629273*^9, 
   3.963475186010913*^9}, {3.963476178706428*^9, 3.963476221657071*^9}, {
   3.9634790709291983`*^9, 3.9634790710988817`*^9}, {3.963479194166562*^9, 
   3.963479194677195*^9}, {3.963479624051136*^9, 3.9634796296370373`*^9}, {
   3.963479663723854*^9, 3.9634797357717857`*^9}, {3.963479765947032*^9, 
   3.963479789250409*^9}, {3.963479840747801*^9, 3.963479841411229*^9}, {
   3.963479896403268*^9, 3.96347990837055*^9}, {3.963480085835341*^9, 
   3.963480104954747*^9}, {3.963480397197095*^9, 3.963480404490654*^9}, {
   3.963480455131239*^9, 3.963480461364854*^9}, {3.9634805272777042`*^9, 
   3.963480527676721*^9}, {3.963480570337397*^9, 3.963480596822061*^9}, {
   3.963480920241907*^9, 3.963480925086502*^9}, {3.9634812874376707`*^9, 
   3.9634812880207577`*^9}, {3.963481463052369*^9, 3.9634814885981207`*^9}, {
   3.963481950016766*^9, 3.963481969037385*^9}, {3.963482020566794*^9, 
   3.9634820207335167`*^9}, {3.963482052785144*^9, 3.963482111989917*^9}, {
   3.963482146914419*^9, 3.963482151685699*^9}, {3.963482182923761*^9, 
   3.96348220375814*^9}, {3.963482235047132*^9, 3.963482235487958*^9}, {
   3.9634824199673758`*^9, 3.963482420622274*^9}, {3.9634827059373207`*^9, 
   3.963482829139865*^9}, {3.96348289108461*^9, 3.9634829205711327`*^9}, {
   3.963482956931432*^9, 3.963483022890831*^9}, {3.963483514569635*^9, 
   3.9634835278138237`*^9}, {3.963483661937957*^9, 3.9634837323931847`*^9}, {
   3.963483769724308*^9, 3.963483771040864*^9}, {3.963483821118203*^9, 
   3.963483823339511*^9}, {3.963483859748535*^9, 3.963483871242414*^9}, {
   3.9634839816951733`*^9, 3.963484009974091*^9}, {3.963484058480678*^9, 
   3.963484058791143*^9}, {3.963484321123567*^9, 3.963484418779956*^9}, {
   3.9634844747984667`*^9, 3.9634848002953568`*^9}, {3.963484841725335*^9, 
   3.963484862696171*^9}, {3.9634849329025*^9, 3.9634850020097322`*^9}, {
   3.963485039516595*^9, 3.963485202724224*^9}, {3.963485332096856*^9, 
   3.963485332576756*^9}, {3.963488037581275*^9, 3.963488037888751*^9}, {
   3.963488236111917*^9, 3.963488266113412*^9}, {3.963488300778928*^9, 
   3.963488301436516*^9}, {3.963488340403932*^9, 3.9634883464420633`*^9}, {
   3.963488380032177*^9, 3.96348838043754*^9}, {3.9634885367549963`*^9, 
   3.9634885411039467`*^9}, {3.963649610370467*^9, 3.9636496160452423`*^9}, {
   3.963649741662879*^9, 3.96364976443151*^9}, {3.9636499160397453`*^9, 
   3.96365001248708*^9}, {3.9636505027417297`*^9, 3.963650506900766*^9}, {
   3.963650593753769*^9, 3.963650594154849*^9}, {3.963651520194333*^9, 
   3.963651551511086*^9}, {3.963651617258419*^9, 3.9636516221570263`*^9}, 
   3.963651914556171*^9, {3.963651986727091*^9, 3.963651995487752*^9}},
 CellLabel->
  "In[221]:=",ExpressionUUID->"6e25c1d5-7477-4fee-bd70-25ab9a0fd9d2"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`data$$ = {-0.5889094023380845, \
-0.19119805258081282`, 0.06298059714562385, 
  1.237001235759746, -0.20264513234063525`, 
  1.589471493979069, -0.671448390256882, -0.4956602696574626, \
-0.04314136236617721, 0.41282875735012675`, -0.1913822494735323, 
  1.1340093927411632`, -1.4278151853784884`}, $CellContext`n$$ = 
  3, $CellContext`regularizedData$$ = {-0.5889094023380845, \
-0.19119805258081282`, 0.06298059714562385, 
  1.237001235759746, -0.20264513234063525`, 
  1.589471493979069, -0.671448390256882, -0.4956602696574626, \
-0.04314136236617721, 0.41282875735012675`, -0.1913822494735323, 
  1.1340093927411632`, -1.4278151853784884`}, $CellContext`c1$$ = \
{-0.1569227512140979, -0.12902064321901738`, -0.4741829913947109, 
  2.403636191671604, -1.7183543607332281`, 
  3.2539104572174993`, -1.760458504262353, -0.24076678170937774`, \
-0.2504359868449118, 0.983662554891963, -1.2072416886221806`, 
  2.697010702755565, -2.7767447659530995`}, $CellContext`s1$$ = <|
  "c" -> {-0.1569227512140979, -0.12902064321901738`, -0.4741829913947109, 
    2.403636191671604, -1.7183543607332281`, 
    3.2539104572174993`, -1.760458504262353, -0.24076678170937774`, \
-0.2504359868449118, 0.983662554891963, -1.2072416886221806`, 
    2.697010702755565, -2.7767447659530995`}, "n" -> 3, "\[CapitalDelta]x" -> 
   0|>, $CellContext`ss$$ = <|
  "c" -> {-0.15692275121409768`, -0.12902064321901682`, -0.47418299139471043`,
     2.4036361916716036`, -1.7183543607332281`, 
    3.2539104572174984`, -1.7604585042623526`, -0.2407667817093776, \
-0.2504359868449123, 0.983662554891963, -1.2072416886221806`, 
    2.697010702755564, -2.776744765953099}, "n" -> 3, "\[CapitalDelta]x" -> 
   0|>, $CellContext`cc$$ = {-0.15692275121409768`, -0.12902064321901682`, \
-0.47418299139471043`, 2.4036361916716036`, -1.7183543607332281`, 
  3.2539104572174984`, -1.7604585042623526`, -0.2407667817093776, \
-0.2504359868449123, 0.983662554891963, -1.2072416886221806`, 
  2.697010702755564, -2.776744765953099}}, 
  TagBox[
   StyleBox[
    DynamicModuleBox[{$CellContext`\[Delta]x$$ = 
     0, $CellContext`\[Lambda]0$$ = 0, $CellContext`\[Lambda]1$$ = 
     0, $CellContext`\[Lambda]2$$ = 0, $CellContext`\[Lambda]3$$ = 0, 
     Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
     Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
     1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
        Hold[$CellContext`\[Delta]x$$], 0}, -2.5, 2, ControlType -> 
       Manipulator}, {{
        Hold[$CellContext`\[Lambda]0$$], 0}, -2, 10, ControlType -> 
       Manipulator}, {{
        Hold[$CellContext`\[Lambda]1$$], 0}, -2, 10, ControlType -> 
       Manipulator}, {{
        Hold[$CellContext`\[Lambda]2$$], 0}, -2, 10, ControlType -> 
       Manipulator}, {{
        Hold[$CellContext`\[Lambda]3$$], 0}, -2, 10, ControlType -> 
       Manipulator}}, Typeset`size$$ = {
     576., {174.60034802563936`, 180.33228161938936`}}, Typeset`update$$ = 0, 
     Typeset`initDone$$, Typeset`skipInitDone$$ = True, 
     Typeset`keyframeActionsQ$$ = False, Typeset`keyframeList$$ = {}}, 
     DynamicBox[Manipulate`ManipulateBoxes[
      1, StandardForm, 
       "Variables" :> {$CellContext`\[Delta]x$$ = 
         0, $CellContext`\[Lambda]0$$ = 0, $CellContext`\[Lambda]1$$ = 
         0, $CellContext`\[Lambda]2$$ = 0, $CellContext`\[Lambda]3$$ = 0}, 
       "ControllerVariables" :> {}, 
       "OtherVariables" :> {
        Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
         Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
         Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
         Typeset`initDone$$, Typeset`skipInitDone$$, 
         Typeset`keyframeActionsQ$$, Typeset`keyframeList$$}, 
       "Body" :> ($CellContext`regularizedData$$ = If[
           OddQ[
            Length[$CellContext`data$$]], $CellContext`data$$, 
           
           Block[{$CellContext`e = 
             Downsample[$CellContext`data$$, 2, 0 + 1], $CellContext`o = 
             Downsample[$CellContext`data$$, 2, 1 + 
               1], $CellContext`e0, $CellContext`o0}, $CellContext`e0 = 
             Mean[$CellContext`e]; $CellContext`o0 = Mean[$CellContext`o]; 
            AddTo[$CellContext`e, ($CellContext`o0 - $CellContext`e0)/2]; 
            AddTo[$CellContext`o, ($CellContext`e0 - $CellContext`o0)/2]; 
            Upsample[$CellContext`e, 2, 0 + 1] + 
             Upsample[$CellContext`o, 2, 1 + 
               1]]]; $CellContext`c1$$ = \
$CellContext`P\[Beta]FromSamplesFourier[$CellContext`data$$, \
$CellContext`n$$, {$CellContext`Delay -> $CellContext`\[Delta]x$$, \
$CellContext`Regularized -> True}][
          "c"]; $CellContext`cc$$ = $CellContext`FromSamplesToSmoothedCoeffP\
\[Beta][$CellContext`regularizedData$$, {$CellContext`\[Lambda]0$$, \
$CellContext`\[Lambda]1$$, $CellContext`\[Lambda]2$$, \
$CellContext`\[Lambda]3$$}, {$CellContext`\[Delta]x$$, $CellContext`n$$}]; \
$CellContext`s1$$ = $CellContext`P\[Beta]FromCoeff\[Beta][$CellContext`c1$$, \
$CellContext`n$$, $CellContext`\[Delta]x$$]; $CellContext`ss$$ = \
$CellContext`P\[Beta]FromCoeff\[Beta][$CellContext`cc$$, $CellContext`n$$, \
$CellContext`\[Delta]x$$]; Show[{
           $CellContext`ShowP\[Beta][$CellContext`s1$$, {0, 13}], 
           $CellContext`ShowP\[Beta][$CellContext`ss$$, {0, 13}]}, 
          PlotRange -> {{0, 13}, {-5, 5}}, ImageSize -> Large]), 
       "Specifications" :> {{{$CellContext`\[Delta]x$$, 0}, -2.5, 
          2}, {{$CellContext`\[Lambda]0$$, 0}, -2, 
          10}, {{$CellContext`\[Lambda]1$$, 0}, -2, 
          10}, {{$CellContext`\[Lambda]2$$, 0}, -2, 
          10}, {{$CellContext`\[Lambda]3$$, 0}, -2, 10}}, "Options" :> {}, 
       "DefaultOptions" :> {}],
      ImageSizeCache->{
       625.0999999999999, {281.47077344067844`, 287.20270703442844`}},
      SingleEvaluation->True],
     Deinitialization:>None,
     DynamicModuleValues:>{},
     SynchronousInitialization->True,
     UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
     UnsavedVariables:>{Typeset`initDone$$},
     UntrackedVariables:>{Typeset`size$$}], "Manipulate",
    Deployed->True,
    StripOnInput->False],
   Manipulate`InterpretManipulate[1]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{
  3.9636497652355957`*^9, {3.963649923365201*^9, 3.963649973312714*^9}, {
   3.963650009300994*^9, 3.963650013097084*^9}, 3.963650139696721*^9, 
   3.963650522841879*^9, {3.9636505668349733`*^9, 3.963650603159584*^9}, 
   3.9636506859408293`*^9, 3.963651552319736*^9, {3.963651604172223*^9, 
   3.963651632147786*^9}, {3.963651960904293*^9, 3.963652005809782*^9}, 
   3.963652050888927*^9, 3.963652113707909*^9},
 CellLabel->
  "Out[221]=",ExpressionUUID->"0e3c9b43-7f99-4c5a-a8ae-58dd44e096b2"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{809, 912},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b155c665-3be7-4fef-a59e-87d91ab2e699"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 154, 3, 96, "Title",ExpressionUUID->"0d5e53ae-9eb9-4dae-8952-21f70f221fea"],
Cell[733, 27, 1033, 16, 213, "Input",ExpressionUUID->"3cd3675f-8605-46f5-a76e-9678158a2590"],
Cell[1769, 45, 1060, 16, 192, "Input",ExpressionUUID->"08d3f14d-8f63-4afa-bcec-6bc8dee7130a"],
Cell[2832, 63, 2913, 42, 662, "Input",ExpressionUUID->"e285cb89-51b4-4e78-b914-5e4bc189375b"],
Cell[5748, 107, 827, 13, 192, "Input",ExpressionUUID->"3a4f456f-2de4-49bb-a705-2259a58552ab"],
Cell[6578, 122, 708, 12, 151, "Input",ExpressionUUID->"3f861ab9-8de5-4e8c-a9df-acaa807d6b1f"],
Cell[7289, 136, 943, 15, 233, "Input",ExpressionUUID->"9e177869-eac2-4c40-808f-2240bb34649b"],
Cell[8235, 153, 336, 7, 70, "Input",ExpressionUUID->"c78419c5-fc6f-480c-b04d-c4d2727bc30f"],
Cell[8574, 162, 329, 7, 70, "Input",ExpressionUUID->"57aac272-798b-4135-87c7-96c6c50784e5"],
Cell[8906, 171, 340, 7, 70, "Input",ExpressionUUID->"d67e6d8d-99e5-4992-889b-48bcb54984d3"],
Cell[9249, 180, 540, 10, 90, "Input",ExpressionUUID->"dc729c5c-85bb-492a-ba75-9f8a4322c49c"],
Cell[9792, 192, 495, 9, 111, "Input",ExpressionUUID->"5c8f7939-2c15-4061-8733-36f386b35034"],
Cell[10290, 203, 491, 9, 111, "Input",ExpressionUUID->"46d23319-4e00-403d-b445-6c29348abf89"],
Cell[10784, 214, 683, 11, 172, "Input",ExpressionUUID->"b2f9398c-c3a6-4206-90e7-a0262fc0b2e3"],
Cell[11470, 227, 505, 9, 111, "Input",ExpressionUUID->"dd6f163b-4ee8-40d2-b490-806f92c88280"],
Cell[11978, 238, 1270, 20, 254, "Input",ExpressionUUID->"77b9ad1e-fd02-4fd5-a811-0bce7da074ce"],
Cell[13251, 260, 1779, 26, 356, "Input",ExpressionUUID->"3229c2d5-9322-4040-a46d-0be2ade46d66"],
Cell[15033, 288, 663, 11, 131, "Input",ExpressionUUID->"81dc43e9-2540-4cdd-97e3-8e64a267df72"],
Cell[15699, 301, 441, 8, 90, "Input",ExpressionUUID->"5b6d2905-8d1e-4d51-b5b0-0421542d1ab7"],
Cell[16143, 311, 441, 8, 90, "Input",ExpressionUUID->"7d689e10-2289-4f5b-b821-9b9cdf5ea62f"],
Cell[16587, 321, 549, 10, 111, "Input",ExpressionUUID->"fdedd518-21fc-4107-87f8-7da658cecb75"],
Cell[17139, 333, 484, 9, 90, "Input",ExpressionUUID->"f7a427cb-dcc8-48ff-92e7-381c3c9cbdec"],
Cell[17626, 344, 464, 8, 90, "Input",ExpressionUUID->"9a710d0d-d47e-4002-b3e3-704a9697bc47"],
Cell[18093, 354, 508, 9, 111, "Input",ExpressionUUID->"014ec614-9005-4850-81b1-4b34e24ea628"],
Cell[18604, 365, 432, 8, 90, "Input",ExpressionUUID->"0b2c88ad-a716-48e1-8876-99fc03e4233b"],
Cell[19039, 375, 538, 9, 111, "Input",ExpressionUUID->"5c698e86-f2e8-49ad-8d60-968b63577e2c"],
Cell[19580, 386, 519, 9, 111, "Input",ExpressionUUID->"4b82d0a8-2848-4b75-9b4a-49ce0c6e8b97"],
Cell[20102, 397, 474, 9, 90, "Input",ExpressionUUID->"88392b61-24ec-411a-9fa7-445a032866a7"],
Cell[20579, 408, 602, 10, 131, "Input",ExpressionUUID->"5ad8969d-cb8d-49ac-88c4-1afd4b9cb088"],
Cell[21184, 420, 782, 13, 172, "Input",ExpressionUUID->"7b6e9c6c-db7b-4968-a7a8-b72420fc80cc"],
Cell[21969, 435, 574, 10, 111, "Input",ExpressionUUID->"064d1096-161e-416b-bc56-099108627489"],
Cell[22546, 447, 815, 13, 172, "Input",ExpressionUUID->"c405e2aa-b4dc-4349-a5c1-dbb54ed91e3e"],
Cell[23364, 462, 849, 14, 172, "Input",ExpressionUUID->"b55f3d49-9483-4e7a-b341-d9e1c82257d8"],
Cell[24216, 478, 825, 13, 172, "Input",ExpressionUUID->"7952cc2c-d9cf-4ef3-b4ce-96822e123cbc"],
Cell[25044, 493, 773, 12, 151, "Input",ExpressionUUID->"f56b507e-1bc0-4afb-851d-ae88ac1332cd"],
Cell[25820, 507, 1013, 15, 213, "Input",ExpressionUUID->"905185b9-0f15-4909-b1c8-d506a597e691"],
Cell[26836, 524, 847, 13, 192, "Input",ExpressionUUID->"cd63cf11-4fca-4c13-bece-114ea95e747e"],
Cell[27686, 539, 1080, 16, 233, "Input",ExpressionUUID->"f66a45ea-f986-40fc-af9a-4d0739f5515e"],
Cell[CellGroupData[{
Cell[28791, 559, 951, 27, 49, "Input",ExpressionUUID->"6a11ef37-e31a-4d8e-98db-4733bd807429",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[29745, 588, 1209, 36, 49, "Input",ExpressionUUID->"12cedf5e-8375-4f09-850b-15828dd60eb2",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[30957, 626, 17884, 461, 1050, "Input",ExpressionUUID->"5ce0c78f-9c98-435e-b7db-83b0615fa099",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[48844, 1089, 5402, 145, 376, "Input",ExpressionUUID->"b857e7a3-528c-44e4-9f29-dc9103bd2066",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}]
}, Open  ]],
Cell[54261, 1237, 1264, 39, 111, "Input",ExpressionUUID->"17964c76-4ee4-42dc-bae4-6af92bb551e5"],
Cell[55528, 1278, 1684, 50, 90, "Input",ExpressionUUID->"271eafda-36b6-4c37-89a6-3db145d07a97"],
Cell[57215, 1330, 933, 24, 49, "Input",ExpressionUUID->"88da4a65-215d-4ef3-9eef-2b1c0b395e17"],
Cell[58151, 1356, 1009, 27, 49, "Input",ExpressionUUID->"fa79e1b0-87ab-4312-ae94-420a9f945c07"],
Cell[59163, 1385, 8844, 214, 458, "Input",ExpressionUUID->"609bff01-436d-4637-9863-fac3b700e790"],
Cell[68010, 1601, 4456, 116, 192, "Input",ExpressionUUID->"2557dd2b-4724-4aa3-86af-c9acd771cb70"],
Cell[72469, 1719, 3521, 95, 131, "Input",ExpressionUUID->"a186ef1b-24d4-4018-a85f-37bfa5bc1478"],
Cell[75993, 1816, 4371, 114, 172, "Input",ExpressionUUID->"169deea1-7a30-4a55-be4c-8e59fd404b04"],
Cell[80367, 1932, 6412, 160, 213, "Input",ExpressionUUID->"66e5211b-1a91-4b87-8203-e6de35bf4c8c"],
Cell[86782, 2094, 331, 9, 29, "Input",ExpressionUUID->"b0eb6fd1-034a-406e-b230-db836d6351b7"],
Cell[87116, 2105, 296, 8, 29, "Input",ExpressionUUID->"f9dd1f17-b304-4ce8-8372-648e1fb4328c"],
Cell[87415, 2115, 310, 8, 29, "Input",ExpressionUUID->"48ced9b1-0536-4ed6-ae4c-0f15775ada11"],
Cell[87728, 2125, 327, 9, 29, "Input",ExpressionUUID->"4f52b231-ec04-42be-8e38-c2807ce653d2"],
Cell[88058, 2136, 691, 21, 29, "Input",ExpressionUUID->"616777cd-ed73-45aa-b7ef-2d3630f7213e"],
Cell[88752, 2159, 1116, 33, 49, "Input",ExpressionUUID->"fcf6369a-82b2-49df-a6cd-4a99ead63535"],
Cell[89871, 2194, 1640, 48, 90, "Input",ExpressionUUID->"afdfdab3-f5b9-4253-9090-ef5824a2f414"],
Cell[91514, 2244, 1496, 44, 70, "Input",ExpressionUUID->"5bebfd03-591c-44dc-a17e-7ca31b0f498d"],
Cell[93013, 2290, 4712, 131, 172, "Input",ExpressionUUID->"96bfda75-53ff-442a-b482-753f18245efd"],
Cell[97728, 2423, 23185, 554, 948, "Input",ExpressionUUID->"df97c363-5611-400f-a367-bc5b86d7b1c0"],
Cell[120916, 2979, 519, 16, 29, "Input",ExpressionUUID->"5997d863-0cd5-40a7-97b6-77f29380bc66"],
Cell[121438, 2997, 9091, 237, 682, "Input",ExpressionUUID->"bac1387a-603a-49b8-b5a5-094d5671f6ee"],
Cell[130532, 3236, 24564, 575, 989, "Input",ExpressionUUID->"0b32e802-feed-40c6-9d13-da6b78458d23"],
Cell[155099, 3813, 1459, 42, 70, "Input",ExpressionUUID->"a6561293-2117-4809-9929-f4cb06ec7db2"],
Cell[156561, 3857, 306, 8, 29, "Input",ExpressionUUID->"00b36fc8-ce35-41c0-8d50-7d7b871ea584"],
Cell[156870, 3867, 7743, 187, 315, "Input",ExpressionUUID->"39063e5a-738a-469e-a601-02ebb4c079fa"],
Cell[164616, 4056, 7775, 188, 315, "Input",ExpressionUUID->"c2b316a9-bacc-4098-a92d-0c816e52268b"],
Cell[172394, 4246, 894, 23, 49, "Input",ExpressionUUID->"53c11faa-80bd-412d-bb08-248eff181744"],
Cell[173291, 4271, 549, 15, 29, "Input",ExpressionUUID->"a772a9cb-3f2e-4e5c-b682-cd20320f0ec0"],
Cell[173843, 4288, 1001, 29, 70, "Input",ExpressionUUID->"8ee0415c-4929-4b3b-b7ce-734566ebb56d"],
Cell[174847, 4319, 542, 15, 29, "Input",ExpressionUUID->"a881951a-3fb8-4766-afba-2b0b56c016de"],
Cell[175392, 4336, 504, 14, 29, "Input",ExpressionUUID->"74ed62ef-8f65-44c1-a94e-f26197dabe17"],
Cell[175899, 4352, 557, 15, 29, "Input",ExpressionUUID->"d3665081-9ef5-4402-ba2e-a9c0b8b04171"],
Cell[176459, 4369, 913, 26, 49, "Input",ExpressionUUID->"8a51c3d7-1f89-4551-ab6b-fc75772432a8"],
Cell[177375, 4397, 674, 18, 49, "Input",ExpressionUUID->"df691860-cb2b-4899-b3ce-79a63a665508"],
Cell[178052, 4417, 1383, 38, 90, "Input",ExpressionUUID->"814eedaf-93bc-42a8-96ba-30e832560a00"],
Cell[179438, 4457, 2086, 54, 111, "Input",ExpressionUUID->"67165af5-04e6-4dcb-b381-7598c0cf5a9e"],
Cell[181527, 4513, 2812, 75, 131, "Input",ExpressionUUID->"1bdb3cd6-2826-4e01-833e-5b320864312f"],
Cell[184342, 4590, 5280, 129, 233, "Input",ExpressionUUID->"2c625c3d-d662-4fee-8cc3-abd85749b4ea"],
Cell[189625, 4721, 4515, 112, 192, "Input",ExpressionUUID->"0ec9cd10-b6c5-4b6e-b02b-2b51a4171498"],
Cell[194143, 4835, 1661, 46, 90, "Input",ExpressionUUID->"17bd6c12-b24b-4cfe-943e-8c8ce96c344f"],
Cell[195807, 4883, 1355, 35, 70, "Input",ExpressionUUID->"9c9095e0-a413-4473-9e1d-2824a91c8e8f"],
Cell[197165, 4920, 1538, 42, 70, "Input",ExpressionUUID->"88c33ac2-c879-4346-8a55-b034dc0f1189"],
Cell[198706, 4964, 1337, 35, 90, "Input",ExpressionUUID->"b655e821-94e5-40b9-8f1f-bfc9e5b3a558"],
Cell[200046, 5001, 2115, 55, 151, "Input",ExpressionUUID->"08b7f9c4-d51d-48f8-b9f0-df98d5714a0f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202198, 5061, 196, 4, 96, "Title",ExpressionUUID->"954b0036-432b-4ba4-b5f9-6108df398f42"],
Cell[202397, 5067, 6526, 129, 361, "Input",ExpressionUUID->"2581f01d-f2c7-4273-8781-bb6f575d63a6"],
Cell[208926, 5198, 3227, 75, 274, "Input",ExpressionUUID->"069ca011-7061-45a4-84e6-b39b47819de2"],
Cell[212156, 5275, 5046, 112, 315, "Input",ExpressionUUID->"3ed3b5e1-377b-44b6-bedc-34c290afdb23"],
Cell[217205, 5389, 4754, 106, 315, "Input",ExpressionUUID->"5760652a-d17d-4920-b336-7469a4a4fd6d"],
Cell[221962, 5497, 4784, 107, 335, "Input",ExpressionUUID->"9b4ace9b-a8bd-4744-955e-baf8e1a5518a"],
Cell[226749, 5606, 231, 5, 29, "Input",ExpressionUUID->"a8212efb-152f-49c0-ad13-37ff7144bdc2"],
Cell[226983, 5613, 3912, 92, 274, "Input",ExpressionUUID->"a7d645bc-6711-4ac5-b49a-9604939da996"],
Cell[230898, 5707, 2218, 54, 192, "Input",ExpressionUUID->"28f4c7d0-ed4b-431b-9b88-23c97f55fdf6"],
Cell[233119, 5763, 409, 7, 29, "Input",ExpressionUUID->"3089e7ba-08a4-48bc-9d40-76b3c797bcdc"],
Cell[233531, 5772, 3003, 71, 279, "Input",ExpressionUUID->"84339a99-8d0c-49be-b01a-4a09ea2295dc"],
Cell[236537, 5845, 3971, 92, 386, "Input",ExpressionUUID->"8153b54b-aeed-42e9-ab2c-995155421705"],
Cell[240511, 5939, 6252, 140, 482, "Input",ExpressionUUID->"eb1e2129-c5ba-4d23-b234-9bcb3a8287be"],
Cell[246766, 6081, 8808, 188, 550, "Input",ExpressionUUID->"8fdf0d42-49b1-4c76-9cca-9bf7eb279763"],
Cell[255577, 6271, 8914, 191, 550, "Input",ExpressionUUID->"9073b9ac-0dfe-4203-8e93-c990c93c2968"],
Cell[264494, 6464, 9107, 194, 550, "Input",ExpressionUUID->"26a3bde6-9876-48ca-bc6f-3fd4b87af5ff"],
Cell[273604, 6660, 9121, 192, 550, "Input",ExpressionUUID->"20bf59f1-f8b3-4dd8-be60-d3cd0b60ebc3"],
Cell[282728, 6854, 13295, 273, 646, "Input",ExpressionUUID->"a099bbc7-712e-4b90-aa90-2abaed6a9325"],
Cell[296026, 7129, 13402, 275, 646, "Input",ExpressionUUID->"de993606-906e-45e0-82f8-8d76a9019a2c"],
Cell[309431, 7406, 13467, 276, 646, "Input",ExpressionUUID->"49c10cbc-b53d-4de7-9d80-b23287881914"],
Cell[322901, 7684, 13402, 275, 646, "Input",ExpressionUUID->"7b09d00e-bb67-483f-9728-c429b598faa4"],
Cell[336306, 7961, 3833, 90, 274, "Input",ExpressionUUID->"c33b2978-fefe-47e3-ae13-050ca66f36dc"],
Cell[340142, 8053, 5290, 120, 294, "Input",ExpressionUUID->"c4d49eb8-5662-44a3-a550-d19a3f9d3c56"],
Cell[345435, 8175, 2288, 56, 192, "Input",ExpressionUUID->"379c1b49-3e28-4728-a377-280bdfd992cf"],
Cell[347726, 8233, 2295, 56, 192, "Input",ExpressionUUID->"a53d32b6-305b-4485-a84e-f5329edf9ebc"],
Cell[350024, 8291, 4446, 103, 294, "Input",ExpressionUUID->"0466c9bf-ace6-4fb2-b219-2562d030fa22"],
Cell[354473, 8396, 28401, 584, 1209, "Input",ExpressionUUID->"5b1f4ef6-da02-4883-8258-bff983c19cf9"],
Cell[382877, 8982, 6019, 113, 233, "Input",ExpressionUUID->"466b0256-23aa-4e31-b1a6-ccf12c519d8f"],
Cell[388899, 9097, 3046, 72, 233, "Input",ExpressionUUID->"61886591-3e21-4e6e-8c55-7e8a8cf3ef42"],
Cell[391948, 9171, 302, 5, 29, "Input",ExpressionUUID->"2176b276-9a42-4a51-963e-1abeedce62f5"],
Cell[392253, 9178, 289, 5, 29, "Input",ExpressionUUID->"87eba284-fedb-4c65-a1e6-967ec0abf573"],
Cell[392545, 9185, 326, 6, 29, "Input",ExpressionUUID->"60fa75a0-2d8b-4a9e-bcc5-3ac3c55c39fb"],
Cell[392874, 9193, 318, 6, 29, "Input",ExpressionUUID->"baeee88d-1827-402e-a9c0-980738228f62"],
Cell[393195, 9201, 317, 6, 29, "Input",ExpressionUUID->"6da677a2-e548-4abc-aecf-25ff72ca99c6"],
Cell[393515, 9209, 323, 6, 29, "Input",ExpressionUUID->"9c1470e4-e1b4-435d-b077-44828bf14a64"],
Cell[393841, 9217, 330, 6, 29, "Input",ExpressionUUID->"c1a6670b-c422-4ef1-a819-4fcab7547a20"],
Cell[394174, 9225, 320, 6, 29, "Input",ExpressionUUID->"3b8d88cf-1af6-4a08-a773-677d28a5da07"],
Cell[394497, 9233, 344, 6, 29, "Input",ExpressionUUID->"771a3894-2023-4096-9129-46ec95f723de"],
Cell[394844, 9241, 362, 6, 29, "Input",ExpressionUUID->"519566d4-7e19-4192-8c42-7d5e16f0268b"],
Cell[395209, 9249, 365, 6, 29, "Input",ExpressionUUID->"c248f79d-5374-4a2e-8628-93184f2d9788"],
Cell[395577, 9257, 363, 6, 29, "Input",ExpressionUUID->"f213eeae-ba82-424b-8a56-2e55890bd7f4"],
Cell[395943, 9265, 366, 6, 29, "Input",ExpressionUUID->"0c91a2b1-4b82-46ae-9985-f36538f89088"],
Cell[396312, 9273, 367, 6, 29, "Input",ExpressionUUID->"55cc84fa-0c0d-4d28-a90d-ffab4bcdd06b"],
Cell[396682, 9281, 372, 6, 29, "Input",ExpressionUUID->"1f1e8f1e-0c7d-4c11-ad2e-3b62917a935f"],
Cell[397057, 9289, 367, 6, 29, "Input",ExpressionUUID->"d93f2d14-52aa-49e9-b70d-e93284c9e735"],
Cell[397427, 9297, 366, 6, 29, "Input",ExpressionUUID->"a6f42a38-2be6-4c1e-83c3-128e0fc598be"],
Cell[397796, 9305, 376, 6, 29, "Input",ExpressionUUID->"eea1db3c-e2ce-42d6-8d36-95a09bfd858f"],
Cell[398175, 9313, 380, 6, 29, "Input",ExpressionUUID->"148bae29-b26e-47ee-93c4-1affaec01c4d"],
Cell[398558, 9321, 376, 6, 29, "Input",ExpressionUUID->"7b9db954-d659-4da5-b48e-1fb2362b2bc3"],
Cell[398937, 9329, 8221, 204, 536, "Input",ExpressionUUID->"9eb8d069-decf-43c5-8d90-9df46c719d61"],
Cell[407161, 9535, 7489, 173, 444, "Input",ExpressionUUID->"faa9a866-4b90-43d1-8d6e-cf53e0fc4ba9"],
Cell[CellGroupData[{
Cell[414675, 9712, 8873, 183, 356, "Input",ExpressionUUID->"6e25c1d5-7477-4fee-bd70-25ab9a0fd9d2"],
Cell[423551, 9897, 6820, 122, 604, "Output",ExpressionUUID->"0e3c9b43-7f99-4c5a-a8ae-58dd44e096b2"]
}, Open  ]]
}, Open  ]]
}
]
*)

